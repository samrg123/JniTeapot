/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/(function(){var Z=["require","exports","vs/base/common/lifecycle","vs/base/common/path","vs/base/common/async","vs/nls","vs/nls!vs/code/node/cliProcessMain","vs/base/common/uri","vs/base/common/errors","vs/base/common/network","vs/base/common/platform","vs/base/node/pfs","vs/platform/instantiation/common/instantiation","vs/base/common/types","vs/base/common/event","vs/platform/log/common/log","vs/base/common/buffer","vs/platform/files/common/files","vs/base/common/strings","vs/base/common/objects","vs/base/common/resources","vs/platform/environment/common/environment","vs/platform/extensionManagement/common/extensionManagement","vs/platform/extensionManagement/common/extensionManagementUtil","vs/base/common/arrays","vs/platform/registry/common/platform","vs/base/common/cancellation","vs/platform/configuration/common/configuration","vs/base/common/errorMessage","vs/base/common/uuid","vs/platform/configuration/common/configurationRegistry","os","child_process","vs/base/common/process","vs/platform/product/common/product","vs/platform/telemetry/common/telemetry","vs/base/common/stream","vs/base/common/extpath","fs","vs/base/parts/ipc/common/ipc","vs/platform/extensions/common/extensions","vs/base/common/semver/semver","vs/platform/product/common/productService","vs/base/node/zip","vs/base/common/decorators","vs/base/common/map","vs/base/node/decoder","vs/base/node/processes","vs/base/parts/ipc/node/ipc.cp","vs/platform/extensions/common/extensionValidator","vs/platform/instantiation/common/descriptors","vs/platform/files/node/watcher/watcher","vs/platform/instantiation/common/serviceCollection","vs/platform/localizations/common/localizations","vs/platform/files/common/io","vs/platform/request/common/request","vs/platform/telemetry/common/telemetryUtils","vs/base/common/assert","vs/base/common/json","vs/base/common/console","vs/base/common/marshalling","vs/base/common/glob","vs/base/common/labels","vs/base/node/extpath","vs/base/node/powershell","vs/base/node/watcher","vs/base/parts/storage/common/storage","vs/nls!vs/base/common/date","vs/base/common/date","vs/nls!vs/base/common/errorMessage","vs/nls!vs/base/node/processes","vs/base/node/shell","vs/nls!vs/base/node/zip","vs/nls!vs/platform/configuration/common/configurationRegistry","vs/nls!vs/platform/extensionManagement/common/abstractExtensionManagementService","vs/nls!vs/platform/extensionManagement/common/extensionManagement","vs/nls!vs/platform/extensionManagement/common/extensionManagementCLIService","vs/nls!vs/platform/extensionManagement/node/extensionManagementService","vs/nls!vs/platform/extensionManagement/node/extensionManagementUtil","vs/nls!vs/platform/extensionManagement/node/extensionsScanner","vs/nls!vs/platform/extensions/common/extensionValidator","vs/nls!vs/platform/files/common/fileService","vs/nls!vs/platform/files/common/io","vs/nls!vs/platform/files/node/diskFileSystemProvider","vs/nls!vs/platform/request/common/request","vs/nls!vs/platform/telemetry/common/telemetryService","vs/platform/environment/common/environmentService","vs/platform/environment/node/userDataPath","path","vs/platform/environment/node/environmentService","vs/platform/extensionManagement/common/extensionNls","vs/platform/files/node/watcher/nsfw/watcherService","vs/platform/files/node/watcher/unix/watcherService","vs/platform/files/node/watcher/win32/csharpWatcherService","vs/platform/files/node/watcher/win32/watcherService","vs/platform/instantiation/common/graph","vs/platform/download/common/download","vs/platform/extensionManagement/common/extensionManagementCLIService","vs/platform/extensionManagement/node/extensionsManifestCache","vs/platform/environment/node/shellEnv","vs/platform/files/node/watcher/nodejs/watcherService","vs/platform/instantiation/common/instantiationService","vs/platform/extensionManagement/node/extensionDownloader","vs/platform/extensionManagement/node/extensionLifecycle","vs/platform/extensionManagement/node/extensionsWatcher","vs/platform/localizations/node/localizations","vs/platform/log/node/spdlogLog","vs/platform/files/common/fileService","vs/platform/files/node/diskFileSystemProvider","vs/platform/jsonschemas/common/jsonContributionRegistry","vs/platform/configuration/common/configurationModels","vs/platform/configuration/common/configurationService","vs/platform/request/node/proxy","url","vs/platform/serviceMachineId/common/serviceMachineId","vs/platform/storage/common/storage","vs/platform/telemetry/common/commonProperties","vs/platform/extensionManagement/common/abstractExtensionManagementService","vs/platform/extensionManagement/common/extensionGalleryService","vs/platform/telemetry/common/telemetryService","vs/platform/telemetry/node/appInsightsAppender","vs/platform/telemetry/node/telemetry","vs/platform/extensionManagement/node/extensionManagementUtil","vs/platform/extensionManagement/node/extensionsScanner","vs/platform/extensionManagement/node/extensionManagementService","vs/platform/request/node/requestService","string_decoder","vs/base/common/normalization","vs/platform/environment/node/argvHelper","crypto","vs/base/common/performance","vs/base/common/iterator","yauzl","yazl","zlib","vs/code/node/cliProcessMain","graceful-fs"],te=function(q){for(var t=[],g=0,O=q.length;g<O;g++)t[g]=Z[q[g]];return t};define(Z[57],te([0,1]),function(q,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ok=void 0;function g(O,E){if(!O)throw new Error(E?`Assertion failed (${E})`:"Assertion Failed")}t.ok=g}),define(Z[44],te([0,1]),function(q,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=t.debounce=t.memoize=t.createDecorator=void 0;function g(T){return(L,c,d)=>{let v=null,p=null;if(typeof d.value=="function"?(v="value",p=d.value):typeof d.get=="function"&&(v="get",p=d.get),!p)throw new Error("not supported");d[v]=T(p,c)}}t.createDecorator=g;function O(T,L,c){let d=null,v=null;if(typeof c.value=="function"?(d="value",v=c.value,v.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof c.get=="function"&&(d="get",v=c.get),!v)throw new Error("not supported");const p=`$memoize$${L}`;c[d]=function(...w){return this.hasOwnProperty(p)||Object.defineProperty(this,p,{configurable:!1,enumerable:!1,writable:!1,value:v.apply(this,w)}),this[p]}}t.memoize=O;function E(T,L,c){return g((d,v)=>{const p=`$debounce$${v}`,w=`$debounce$result$${v}`;return function(...F){this[w]||(this[w]=c?c():void 0),clearTimeout(this[p]),L&&(this[w]=L(this[w],...F),F=[this[w]]),this[p]=setTimeout(()=>{d.apply(this,F),this[w]=c?c():void 0},T)}})}t.debounce=E;function I(T,L,c){return g((d,v)=>{const p=`$throttle$timer$${v}`,w=`$throttle$result$${v}`,F=`$throttle$lastRun$${v}`,l=`$throttle$pending$${v}`;return function(...u){if(this[w]||(this[w]=c?c():void 0),(this[F]===null||this[F]===void 0)&&(this[F]=-Number.MAX_VALUE),L&&(this[w]=L(this[w],...u)),this[l])return;const R=this[F]+T;R<=Date.now()?(this[F]=Date.now(),d.apply(this,[this[w]]),this[w]=c?c():void 0):(this[l]=!0,this[p]=setTimeout(()=>{this[l]=!1,this[F]=Date.now(),d.apply(this,[this[w]]),this[w]=c?c():void 0},R-Date.now()))}})}t.throttle=I}),define(Z[24],te([0,1,8]),function(q,t,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayQueue=t.maxIndex=t.minIndex=t.splice=t.insertInto=t.mapFind=t.getRandomElement=t.asArray=t.mapArrayOrNot=t.pushToEnd=t.pushToStart=t.shuffle=t.arrayInsert=t.remove=t.insert=t.index=t.range=t.flatten=t.commonPrefixLength=t.firstOrDefault=t.lastIndex=t.uniqueFilter=t.distinctES6=t.distinct=t.isNonEmptyArray=t.isFalsyOrEmpty=t.move=t.coalesceInPlace=t.coalesce=t.topAsync=t.top=t.delta=t.sortedDiff=t.groupBy=t.quickSelect=t.findFirstInSorted=t.binarySearch=t.equals=t.tail2=t.tail=void 0;function O(y,A=0){return y[y.length-(1+A)]}t.tail=O;function E(y){if(y.length===0)throw new Error("Invalid tail call");return[y.slice(0,y.length-1),y[y.length-1]]}t.tail2=E;function I(y,A,C=(z,j)=>z===j){if(y===A)return!0;if(!y||!A||y.length!==A.length)return!1;for(let z=0,j=y.length;z<j;z++)if(!C(y[z],A[z]))return!1;return!0}t.equals=I;function T(y,A,C){let z=0,j=y.length-1;for(;z<=j;){const $=(z+j)/2|0,H=C(y[$],A);if(H<0)z=$+1;else if(H>0)j=$-1;else return $}return-(z+1)}t.binarySearch=T;function L(y,A){let C=0,z=y.length;if(z===0)return 0;for(;C<z;){const j=Math.floor((C+z)/2);A(y[j])?z=j:C=j+1}return C}t.findFirstInSorted=L;function c(y,A,C){if(y=y|0,y>=A.length)throw new TypeError("invalid index");let z=A[Math.floor(A.length*Math.random())],j=[],$=[],H=[];for(let ee of A){const ne=C(ee,z);ne<0?j.push(ee):ne>0?$.push(ee):H.push(ee)}return y<j.length?c(y,j,C):y<j.length+H.length?H[0]:c(y-(j.length+H.length),$,C)}t.quickSelect=c;function d(y,A){const C=[];let z;for(const j of y.slice(0).sort(A))!z||A(z[0],j)!==0?(z=[j],C.push(z)):z.push(j);return C}t.groupBy=d;function v(y,A,C){const z=[];function j(ee,ne,re){if(ne===0&&re.length===0)return;const ce=z[z.length-1];ce&&ce.start+ce.deleteCount===ee?(ce.deleteCount+=ne,ce.toInsert.push(...re)):z.push({start:ee,deleteCount:ne,toInsert:re})}let $=0,H=0;for(;;){if($===y.length){j($,0,A.slice(H));break}if(H===A.length){j($,y.length-$,[]);break}const ee=y[$],ne=A[H],re=C(ee,ne);re===0?($+=1,H+=1):re<0?(j($,1,[]),$+=1):re>0&&(j($,0,[ne]),H+=1)}return z}t.sortedDiff=v;function p(y,A,C){const z=v(y,A,C),j=[],$=[];for(const H of z)j.push(...y.slice(H.start,H.start+H.deleteCount)),$.push(...H.toInsert);return{removed:j,added:$}}t.delta=p;function w(y,A,C){if(C===0)return[];const z=y.slice(0,C).sort(A);return l(y,A,z,C,y.length),z}t.top=w;function F(y,A,C,z,j){return C===0?Promise.resolve([]):new Promise(($,H)=>{(async()=>{const ee=y.length,ne=y.slice(0,C).sort(A);for(let re=C,ce=Math.min(C+z,ee);re<ee;re=ce,ce=Math.min(ce+z,ee)){if(re>C&&await new Promise(me=>setTimeout(me)),j&&j.isCancellationRequested)throw(0,g.canceled)();l(y,A,ne,re,ce)}return ne})().then($,H)})}t.topAsync=F;function l(y,A,C,z,j){for(const $=C.length;z<j;z++){const H=y[z];if(A(H,C[$-1])<0){C.pop();const ee=L(C,ne=>A(H,ne)<0);C.splice(ee,0,H)}}}function u(y){return y.filter(A=>!!A)}t.coalesce=u;function R(y){let A=0;for(let C=0;C<y.length;C++)y[C]&&(y[A]=y[C],A+=1);y.length=A}t.coalesceInPlace=R;function b(y,A,C){y.splice(C,0,y.splice(A,1)[0])}t.move=b;function D(y){return!Array.isArray(y)||y.length===0}t.isFalsyOrEmpty=D;function f(y){return Array.isArray(y)&&y.length>0}t.isNonEmptyArray=f;function r(y,A){if(!A)return y.filter((z,j)=>y.indexOf(z)===j);const C=Object.create(null);return y.filter(z=>{const j=A(z);return C[j]?!1:(C[j]=!0,!0)})}t.distinct=r;function s(y){const A=new Set;return y.filter(C=>A.has(C)?!1:(A.add(C),!0))}t.distinctES6=s;function e(y){const A=Object.create(null);return C=>{const z=y(C);return A[z]?!1:(A[z]=!0,!0)}}t.uniqueFilter=e;function i(y,A){for(let C=y.length-1;C>=0;C--){const z=y[C];if(A(z))return C}return-1}t.lastIndex=i;function n(y,A){return y.length>0?y[0]:A}t.firstOrDefault=n;function o(y,A,C=(z,j)=>z===j){let z=0;for(let j=0,$=Math.min(y.length,A.length);j<$&&C(y[j],A[j]);j++)z++;return z}t.commonPrefixLength=o;function a(y){return[].concat(...y)}t.flatten=a;function h(y,A){let C=typeof A=="number"?y:0;typeof A=="number"?C=y:(C=0,A=y);const z=[];if(C<=A)for(let j=C;j<A;j++)z.push(j);else for(let j=C;j>A;j--)z.push(j);return z}t.range=h;function m(y,A,C){return y.reduce((z,j)=>(z[A(j)]=C?C(j):j,z),Object.create(null))}t.index=m;function k(y,A){return y.push(A),()=>P(y,A)}t.insert=k;function P(y,A){const C=y.indexOf(A);if(C>-1)return y.splice(C,1),A}t.remove=P;function N(y,A,C){const z=y.slice(0,A),j=y.slice(A);return z.concat(C,j)}t.arrayInsert=N;function x(y,A){let C;if(typeof A=="number"){let z=A;C=()=>{const j=Math.sin(z++)*179426549;return j-Math.floor(j)}}else C=Math.random;for(let z=y.length-1;z>0;z-=1){const j=Math.floor(C()*(z+1)),$=y[z];y[z]=y[j],y[j]=$}}t.shuffle=x;function _(y,A){const C=y.indexOf(A);C>-1&&(y.splice(C,1),y.unshift(A))}t.pushToStart=_;function J(y,A){const C=y.indexOf(A);C>-1&&(y.splice(C,1),y.push(A))}t.pushToEnd=J;function ie(y,A){return Array.isArray(y)?y.map(A):A(y)}t.mapArrayOrNot=ie;function se(y){return Array.isArray(y)?y:[y]}t.asArray=se;function Y(y){return y[Math.floor(Math.random()*y.length)]}t.getRandomElement=Y;function X(y,A){for(const C of y){const z=A(C);if(z!==void 0)return z}}t.mapFind=X;function Q(y,A,C){const z=W(y,A),j=y.length,$=C.length;y.length=j+$;for(let H=j-1;H>=z;H--)y[H+$]=y[H];for(let H=0;H<$;H++)y[H+z]=C[H]}t.insertInto=Q;function B(y,A,C,z){const j=W(y,A),$=y.splice(j,C);return Q(y,j,z),$}t.splice=B;function W(y,A){return A<0?Math.max(A+y.length,0):Math.min(A,y.length)}function U(y,A){let C=Number.MAX_SAFE_INTEGER,z=0;return y.forEach((j,$)=>{const H=A(j);H<C&&(C=H,z=$)}),z}t.minIndex=U;function S(y,A){let C=Number.MIN_SAFE_INTEGER,z=0;return y.forEach((j,$)=>{const H=A(j);H>C&&(C=H,z=$)}),z}t.maxIndex=S;class M{constructor(A){this.items=A,this.firstIdx=0,this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(A){let C=this.firstIdx;for(;C<this.items.length&&A(this.items[C]);)C++;const z=C===this.firstIdx?null:this.items.slice(this.firstIdx,C);return this.firstIdx=C,z}takeFromEndWhile(A){let C=this.lastIdx;for(;C>=0&&A(this.items[C]);)C--;const z=C===this.lastIdx?null:this.items.slice(C+1,this.lastIdx+1);return this.lastIdx=C,z}}t.ArrayQueue=M}),define(Z[58],te([0,1]),function(q,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNodeType=t.stripComments=t.visit=t.findNodeAtOffset=t.contains=t.getNodeValue=t.getNodePath=t.findNodeAtLocation=t.parseTree=t.parse=t.getLocation=t.createScanner=t.ParseOptions=t.ParseErrorCode=t.SyntaxKind=t.ScanError=void 0;var g;(function(e){e[e.None=0]="None",e[e.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=2]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",e[e.InvalidUnicode=4]="InvalidUnicode",e[e.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",e[e.InvalidCharacter=6]="InvalidCharacter"})(g=t.ScanError||(t.ScanError={}));var O;(function(e){e[e.OpenBraceToken=1]="OpenBraceToken",e[e.CloseBraceToken=2]="CloseBraceToken",e[e.OpenBracketToken=3]="OpenBracketToken",e[e.CloseBracketToken=4]="CloseBracketToken",e[e.CommaToken=5]="CommaToken",e[e.ColonToken=6]="ColonToken",e[e.NullKeyword=7]="NullKeyword",e[e.TrueKeyword=8]="TrueKeyword",e[e.FalseKeyword=9]="FalseKeyword",e[e.StringLiteral=10]="StringLiteral",e[e.NumericLiteral=11]="NumericLiteral",e[e.LineCommentTrivia=12]="LineCommentTrivia",e[e.BlockCommentTrivia=13]="BlockCommentTrivia",e[e.LineBreakTrivia=14]="LineBreakTrivia",e[e.Trivia=15]="Trivia",e[e.Unknown=16]="Unknown",e[e.EOF=17]="EOF"})(O=t.SyntaxKind||(t.SyntaxKind={}));var E;(function(e){e[e.InvalidSymbol=1]="InvalidSymbol",e[e.InvalidNumberFormat=2]="InvalidNumberFormat",e[e.PropertyNameExpected=3]="PropertyNameExpected",e[e.ValueExpected=4]="ValueExpected",e[e.ColonExpected=5]="ColonExpected",e[e.CommaExpected=6]="CommaExpected",e[e.CloseBraceExpected=7]="CloseBraceExpected",e[e.CloseBracketExpected=8]="CloseBracketExpected",e[e.EndOfFileExpected=9]="EndOfFileExpected",e[e.InvalidCommentToken=10]="InvalidCommentToken",e[e.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=12]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",e[e.InvalidUnicode=14]="InvalidUnicode",e[e.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",e[e.InvalidCharacter=16]="InvalidCharacter"})(E=t.ParseErrorCode||(t.ParseErrorCode={}));var I;(function(e){e.DEFAULT={allowTrailingComma:!0}})(I=t.ParseOptions||(t.ParseOptions={}));function T(e,i=!1){let n=0,o=e.length,a="",h=0,m=16,k=0;function P(Y){let X=0,Q=0;for(;X<Y;){const B=e.charCodeAt(n);if(B>=48&&B<=57)Q=Q*16+B-48;else if(B>=65&&B<=70)Q=Q*16+B-65+10;else if(B>=97&&B<=102)Q=Q*16+B-97+10;else break;n++,X++}return X<Y&&(Q=-1),Q}function N(Y){n=Y,a="",h=0,m=16,k=0}function x(){const Y=n;if(e.charCodeAt(n)===48)n++;else for(n++;n<e.length&&d(e.charCodeAt(n));)n++;if(n<e.length&&e.charCodeAt(n)===46)if(n++,n<e.length&&d(e.charCodeAt(n)))for(n++;n<e.length&&d(e.charCodeAt(n));)n++;else return k=3,e.substring(Y,n);let X=n;if(n<e.length&&(e.charCodeAt(n)===69||e.charCodeAt(n)===101))if(n++,(n<e.length&&e.charCodeAt(n)===43||e.charCodeAt(n)===45)&&n++,n<e.length&&d(e.charCodeAt(n))){for(n++;n<e.length&&d(e.charCodeAt(n));)n++;X=n}else k=3;return e.substring(Y,X)}function _(){let Y="",X=n;for(;;){if(n>=o){Y+=e.substring(X,n),k=2;break}const Q=e.charCodeAt(n);if(Q===34){Y+=e.substring(X,n),n++;break}if(Q===92){if(Y+=e.substring(X,n),n++,n>=o){k=2;break}switch(e.charCodeAt(n++)){case 34:Y+='"';break;case 92:Y+="\\";break;case 47:Y+="/";break;case 98:Y+="\b";break;case 102:Y+="\f";break;case 110:Y+=`
`;break;case 114:Y+="\r";break;case 116:Y+="	";break;case 117:const W=P(4);W>=0?Y+=String.fromCharCode(W):k=4;break;default:k=5}X=n;continue}if(Q>=0&&Q<=31)if(c(Q)){Y+=e.substring(X,n),k=2;break}else k=6;n++}return Y}function J(){if(a="",k=0,h=n,n>=o)return h=o,m=17;let Y=e.charCodeAt(n);if(L(Y)){do n++,a+=String.fromCharCode(Y),Y=e.charCodeAt(n);while(L(Y));return m=15}if(c(Y))return n++,a+=String.fromCharCode(Y),Y===13&&e.charCodeAt(n)===10&&(n++,a+=`
`),m=14;switch(Y){case 123:return n++,m=1;case 125:return n++,m=2;case 91:return n++,m=3;case 93:return n++,m=4;case 58:return n++,m=6;case 44:return n++,m=5;case 34:return n++,a=_(),m=10;case 47:const X=n-1;if(e.charCodeAt(n+1)===47){for(n+=2;n<o&&!c(e.charCodeAt(n));)n++;return a=e.substring(X,n),m=12}if(e.charCodeAt(n+1)===42){n+=2;const Q=o-1;let B=!1;for(;n<Q;){if(e.charCodeAt(n)===42&&e.charCodeAt(n+1)===47){n+=2,B=!0;break}n++}return B||(n++,k=1),a=e.substring(X,n),m=13}return a+=String.fromCharCode(Y),n++,m=16;case 45:if(a+=String.fromCharCode(Y),n++,n===o||!d(e.charCodeAt(n)))return m=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return a+=x(),m=11;default:for(;n<o&&ie(Y);)n++,Y=e.charCodeAt(n);if(h!==n){switch(a=e.substring(h,n),a){case"true":return m=8;case"false":return m=9;case"null":return m=7}return m=16}return a+=String.fromCharCode(Y),n++,m=16}}function ie(Y){if(L(Y)||c(Y))return!1;switch(Y){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function se(){let Y;do Y=J();while(Y>=12&&Y<=15);return Y}return{setPosition:N,getPosition:()=>n,scan:i?se:J,getToken:()=>m,getTokenValue:()=>a,getTokenOffset:()=>h,getTokenLength:()=>n-h,getTokenError:()=>k}}t.createScanner=T;function L(e){return e===32||e===9||e===11||e===12||e===160||e===5760||e>=8192&&e<=8203||e===8239||e===8287||e===12288||e===65279}function c(e){return e===10||e===13||e===8232||e===8233}function d(e){return e>=48&&e<=57}var v;(function(e){e[e.nullCharacter=0]="nullCharacter",e[e.maxAsciiCharacter=127]="maxAsciiCharacter",e[e.lineFeed=10]="lineFeed",e[e.carriageReturn=13]="carriageReturn",e[e.lineSeparator=8232]="lineSeparator",e[e.paragraphSeparator=8233]="paragraphSeparator",e[e.nextLine=133]="nextLine",e[e.space=32]="space",e[e.nonBreakingSpace=160]="nonBreakingSpace",e[e.enQuad=8192]="enQuad",e[e.emQuad=8193]="emQuad",e[e.enSpace=8194]="enSpace",e[e.emSpace=8195]="emSpace",e[e.threePerEmSpace=8196]="threePerEmSpace",e[e.fourPerEmSpace=8197]="fourPerEmSpace",e[e.sixPerEmSpace=8198]="sixPerEmSpace",e[e.figureSpace=8199]="figureSpace",e[e.punctuationSpace=8200]="punctuationSpace",e[e.thinSpace=8201]="thinSpace",e[e.hairSpace=8202]="hairSpace",e[e.zeroWidthSpace=8203]="zeroWidthSpace",e[e.narrowNoBreakSpace=8239]="narrowNoBreakSpace",e[e.ideographicSpace=12288]="ideographicSpace",e[e.mathematicalSpace=8287]="mathematicalSpace",e[e.ogham=5760]="ogham",e[e._=95]="_",e[e.$=36]="$",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.ampersand=38]="ampersand",e[e.asterisk=42]="asterisk",e[e.at=64]="at",e[e.backslash=92]="backslash",e[e.bar=124]="bar",e[e.caret=94]="caret",e[e.closeBrace=125]="closeBrace",e[e.closeBracket=93]="closeBracket",e[e.closeParen=41]="closeParen",e[e.colon=58]="colon",e[e.comma=44]="comma",e[e.dot=46]="dot",e[e.doubleQuote=34]="doubleQuote",e[e.equals=61]="equals",e[e.exclamation=33]="exclamation",e[e.greaterThan=62]="greaterThan",e[e.lessThan=60]="lessThan",e[e.minus=45]="minus",e[e.openBrace=123]="openBrace",e[e.openBracket=91]="openBracket",e[e.openParen=40]="openParen",e[e.percent=37]="percent",e[e.plus=43]="plus",e[e.question=63]="question",e[e.semicolon=59]="semicolon",e[e.singleQuote=39]="singleQuote",e[e.slash=47]="slash",e[e.tilde=126]="tilde",e[e.backspace=8]="backspace",e[e.formFeed=12]="formFeed",e[e.byteOrderMark=65279]="byteOrderMark",e[e.tab=9]="tab",e[e.verticalTab=11]="verticalTab"})(v||(v={}));function p(e,i){const n=[],o=new Object;let a;const h={value:{},offset:0,length:0,type:"object",parent:void 0};let m=!1;function k(P,N,x,_){h.value=P,h.offset=N,h.length=x,h.type=_,h.colonOffset=void 0,a=h}try{f(e,{onObjectBegin:(P,N)=>{if(i<=P)throw o;a=void 0,m=i>P,n.push("")},onObjectProperty:(P,N,x)=>{if(i<N||(k(P,N,x,"property"),n[n.length-1]=P,i<=N+x))throw o},onObjectEnd:(P,N)=>{if(i<=P)throw o;a=void 0,n.pop()},onArrayBegin:(P,N)=>{if(i<=P)throw o;a=void 0,n.push(0)},onArrayEnd:(P,N)=>{if(i<=P)throw o;a=void 0,n.pop()},onLiteralValue:(P,N,x)=>{if(i<N||(k(P,N,x,s(P)),i<=N+x))throw o},onSeparator:(P,N,x)=>{if(i<=N)throw o;if(P===":"&&a&&a.type==="property")a.colonOffset=N,m=!1,a=void 0;else if(P===","){const _=n[n.length-1];typeof _=="number"?n[n.length-1]=_+1:(m=!0,n[n.length-1]=""),a=void 0}}})}catch(P){if(P!==o)throw P}return{path:n,previousNode:a,isAtPropertyKey:m,matches:P=>{let N=0;for(let x=0;N<P.length&&x<n.length;x++)if(P[N]===n[x]||P[N]==="*")N++;else if(P[N]!=="**")return!1;return N===P.length}}}t.getLocation=p;function w(e,i=[],n=I.DEFAULT){let o=null,a=[];const h=[];function m(P){Array.isArray(a)?a.push(P):o!==null&&(a[o]=P)}return f(e,{onObjectBegin:()=>{const P={};m(P),h.push(a),a=P,o=null},onObjectProperty:P=>{o=P},onObjectEnd:()=>{a=h.pop()},onArrayBegin:()=>{const P=[];m(P),h.push(a),a=P,o=null},onArrayEnd:()=>{a=h.pop()},onLiteralValue:m,onError:(P,N,x)=>{i.push({error:P,offset:N,length:x})}},n),a[0]}t.parse=w;function F(e,i=[],n=I.DEFAULT){let o={type:"array",offset:-1,length:-1,children:[],parent:void 0};function a(P){o.type==="property"&&(o.length=P-o.offset,o=o.parent)}function h(P){return o.children.push(P),P}f(e,{onObjectBegin:P=>{o=h({type:"object",offset:P,length:-1,parent:o,children:[]})},onObjectProperty:(P,N,x)=>{o=h({type:"property",offset:N,length:-1,parent:o,children:[]}),o.children.push({type:"string",value:P,offset:N,length:x,parent:o})},onObjectEnd:(P,N)=>{o.length=P+N-o.offset,o=o.parent,a(P+N)},onArrayBegin:(P,N)=>{o=h({type:"array",offset:P,length:-1,parent:o,children:[]})},onArrayEnd:(P,N)=>{o.length=P+N-o.offset,o=o.parent,a(P+N)},onLiteralValue:(P,N,x)=>{h({type:s(P),offset:N,length:x,parent:o,value:P}),a(N+x)},onSeparator:(P,N,x)=>{o.type==="property"&&(P===":"?o.colonOffset=N:P===","&&a(N))},onError:(P,N,x)=>{i.push({error:P,offset:N,length:x})}},n);const k=o.children[0];return k&&delete k.parent,k}t.parseTree=F;function l(e,i){if(!e)return;let n=e;for(let o of i)if(typeof o=="string"){if(n.type!=="object"||!Array.isArray(n.children))return;let a=!1;for(const h of n.children)if(Array.isArray(h.children)&&h.children[0].value===o){n=h.children[1],a=!0;break}if(!a)return}else{const a=o;if(n.type!=="array"||a<0||!Array.isArray(n.children)||a>=n.children.length)return;n=n.children[a]}return n}t.findNodeAtLocation=l;function u(e){if(!e.parent||!e.parent.children)return[];const i=u(e.parent);if(e.parent.type==="property"){const n=e.parent.children[0].value;i.push(n)}else if(e.parent.type==="array"){const n=e.parent.children.indexOf(e);n!==-1&&i.push(n)}return i}t.getNodePath=u;function R(e){switch(e.type){case"array":return e.children.map(R);case"object":const i=Object.create(null);for(let n of e.children){const o=n.children[1];o&&(i[n.children[0].value]=R(o))}return i;case"null":case"string":case"number":case"boolean":return e.value;default:return}}t.getNodeValue=R;function b(e,i,n=!1){return i>=e.offset&&i<e.offset+e.length||n&&i===e.offset+e.length}t.contains=b;function D(e,i,n=!1){if(b(e,i,n)){const o=e.children;if(Array.isArray(o))for(let a=0;a<o.length&&o[a].offset<=i;a++){const h=D(o[a],i,n);if(h)return h}return e}}t.findNodeAtOffset=D;function f(e,i,n=I.DEFAULT){const o=T(e,!1);function a(C){return C?()=>C(o.getTokenOffset(),o.getTokenLength()):()=>!0}function h(C){return C?z=>C(z,o.getTokenOffset(),o.getTokenLength()):()=>!0}const m=a(i.onObjectBegin),k=h(i.onObjectProperty),P=a(i.onObjectEnd),N=a(i.onArrayBegin),x=a(i.onArrayEnd),_=h(i.onLiteralValue),J=h(i.onSeparator),ie=a(i.onComment),se=h(i.onError),Y=n&&n.disallowComments,X=n&&n.allowTrailingComma;function Q(){for(;;){const C=o.scan();switch(o.getTokenError()){case 4:B(14);break;case 5:B(15);break;case 3:B(13);break;case 1:Y||B(11);break;case 2:B(12);break;case 6:B(16);break}switch(C){case 12:case 13:Y?B(10):ie();break;case 16:B(1);break;case 15:case 14:break;default:return C}}}function B(C,z=[],j=[]){if(se(C),z.length+j.length>0){let $=o.getToken();for(;$!==17;){if(z.indexOf($)!==-1){Q();break}else if(j.indexOf($)!==-1)break;$=Q()}}}function W(C){const z=o.getTokenValue();return C?_(z):k(z),Q(),!0}function U(){switch(o.getToken()){case 11:let C=0;try{C=JSON.parse(o.getTokenValue()),typeof C!="number"&&(B(2),C=0)}catch(z){B(2)}_(C);break;case 7:_(null);break;case 8:_(!0);break;case 9:_(!1);break;default:return!1}return Q(),!0}function S(){return o.getToken()!==10?(B(3,[],[2,5]),!1):(W(!1),o.getToken()===6?(J(":"),Q(),A()||B(4,[],[2,5])):B(5,[],[2,5]),!0)}function M(){m(),Q();let C=!1;for(;o.getToken()!==2&&o.getToken()!==17;){if(o.getToken()===5){if(C||B(4,[],[]),J(","),Q(),o.getToken()===2&&X)break}else C&&B(6,[],[]);S()||B(4,[],[2,5]),C=!0}return P(),o.getToken()!==2?B(7,[2],[]):Q(),!0}function y(){N(),Q();let C=!1;for(;o.getToken()!==4&&o.getToken()!==17;){if(o.getToken()===5){if(C||B(4,[],[]),J(","),Q(),o.getToken()===4&&X)break}else C&&B(6,[],[]);A()||B(4,[],[4,5]),C=!0}return x(),o.getToken()!==4?B(8,[4],[]):Q(),!0}function A(){switch(o.getToken()){case 3:return y();case 1:return M();case 10:return W(!0);default:return U()}}return Q(),o.getToken()===17?n.allowEmptyContent?!0:(B(4,[],[]),!1):A()?(o.getToken()!==17&&B(9,[],[]),!0):(B(4,[],[]),!1)}t.visit=f;function r(e,i){let n=T(e),o=[],a,h=0,m;do switch(m=n.getPosition(),a=n.scan(),a){case 12:case 13:case 17:h!==m&&o.push(e.substring(h,m)),i!==void 0&&o.push(n.getTokenValue().replace(/[^\r\n]/g,i)),h=n.getPosition();break}while(a!==17);return o.join("")}t.stripComments=r;function s(e){switch(typeof e){case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"object":{if(e){if(Array.isArray(e))return"array"}else return"null";return"object"}default:return"null"}}t.getNodeType=s}),function(){function q(E){const I=[];typeof E=="number"&&I.push("code/timeOrigin",E);function T(c){I.push(c,Date.now())}function L(){const c=[];for(let d=0;d<I.length;d+=2)c.push({name:I[d],startTime:I[d+1]});return c}return{mark:T,getMarks:L}}function t(){if(typeof performance=="object"&&typeof performance.mark=="function")return typeof performance.timeOrigin!="number"&&!performance.timing?q():{mark(E){performance.mark(E)},getMarks(){let E=performance.timeOrigin;typeof E!="number"&&(E=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);const I=[{name:"code/timeOrigin",startTime:Math.round(E)}];for(const T of performance.getEntriesByType("mark"))I.push({name:T.name,startTime:Math.round(E+T.startTime)});return I}};if(typeof process=="object"){const E=Math.round((require.nodeRequire||require)("perf_hooks").performance.timeOrigin);return q(E)}else return console.trace("perf-util loaded in UNKNOWN environment"),q()}function g(E){return E.MonacoPerformanceMarks||(E.MonacoPerformanceMarks=t()),E.MonacoPerformanceMarks}var O;typeof global=="object"?O=global:typeof self=="object"?O=self:O={},typeof define=="function"?define("vs/base/common/performance",[],function(){return g(O)}):typeof module=="object"&&typeof module.exports=="object"?module.exports=g(O):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),O.perf=g(O))}(),function(q,t){if(typeof exports=="object"&&typeof module=="object")module.exports=t();else if(typeof define=="function"&&define.amd)define("vs/base/common/semver/semver",[],t);else{var g=t();for(var O in g)(typeof exports=="object"?exports:q)[O]=g[O]}}(typeof self!="undefined"?self:this,function(){return function(q){var t={};function g(O){if(t[O])return t[O].exports;var E=t[O]={i:O,l:!1,exports:{}};return q[O].call(E.exports,E,E.exports,g),E.l=!0,E.exports}return g.m=q,g.c=t,g.d=function(O,E,I){g.o(O,E)||Object.defineProperty(O,E,{enumerable:!0,get:I})},g.r=function(O){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(O,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(O,"__esModule",{value:!0})},g.t=function(O,E){if(1&E&&(O=g(O)),8&E||4&E&&typeof O=="object"&&O&&O.__esModule)return O;var I=Object.create(null);if(g.r(I),Object.defineProperty(I,"default",{enumerable:!0,value:O}),2&E&&typeof O!="string")for(var T in O)g.d(I,T,function(L){return O[L]}.bind(null,T));return I},g.n=function(O){var E=O&&O.__esModule?function(){return O.default}:function(){return O};return g.d(E,"a",E),E},g.o=function(O,E){return Object.prototype.hasOwnProperty.call(O,E)},g.p="",g(g.s=0)}([function(q,t,g){(function(O){var E;t=q.exports=j,E=typeof O=="object"&&O.env&&O.env.NODE_DEBUG&&/\bsemver\b/i.test(O.env.NODE_DEBUG)?function(){var V=Array.prototype.slice.call(arguments,0);V.unshift("SEMVER"),console.log.apply(console,V)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var I=256,T=Number.MAX_SAFE_INTEGER||9007199254740991,L=t.re=[],c=t.src=[],d=0,v=d++;c[v]="0|[1-9]\\d*";var p=d++;c[p]="[0-9]+";var w=d++;c[w]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var F=d++;c[F]="("+c[v]+")\\.("+c[v]+")\\.("+c[v]+")";var l=d++;c[l]="("+c[p]+")\\.("+c[p]+")\\.("+c[p]+")";var u=d++;c[u]="(?:"+c[v]+"|"+c[w]+")";var R=d++;c[R]="(?:"+c[p]+"|"+c[w]+")";var b=d++;c[b]="(?:-("+c[u]+"(?:\\."+c[u]+")*))";var D=d++;c[D]="(?:-?("+c[R]+"(?:\\."+c[R]+")*))";var f=d++;c[f]="[0-9A-Za-z-]+";var r=d++;c[r]="(?:\\+("+c[f]+"(?:\\."+c[f]+")*))";var s=d++,e="v?"+c[F]+c[b]+"?"+c[r]+"?";c[s]="^"+e+"$";var i="[v=\\s]*"+c[l]+c[D]+"?"+c[r]+"?",n=d++;c[n]="^"+i+"$";var o=d++;c[o]="((?:<|>)?=?)";var a=d++;c[a]=c[p]+"|x|X|\\*";var h=d++;c[h]=c[v]+"|x|X|\\*";var m=d++;c[m]="[v=\\s]*("+c[h]+")(?:\\.("+c[h]+")(?:\\.("+c[h]+")(?:"+c[b]+")?"+c[r]+"?)?)?";var k=d++;c[k]="[v=\\s]*("+c[a]+")(?:\\.("+c[a]+")(?:\\.("+c[a]+")(?:"+c[D]+")?"+c[r]+"?)?)?";var P=d++;c[P]="^"+c[o]+"\\s*"+c[m]+"$";var N=d++;c[N]="^"+c[o]+"\\s*"+c[k]+"$";var x=d++;c[x]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var _=d++;c[_]="(?:~>?)";var J=d++;c[J]="(\\s*)"+c[_]+"\\s+",L[J]=new RegExp(c[J],"g");var ie=d++;c[ie]="^"+c[_]+c[m]+"$";var se=d++;c[se]="^"+c[_]+c[k]+"$";var Y=d++;c[Y]="(?:\\^)";var X=d++;c[X]="(\\s*)"+c[Y]+"\\s+",L[X]=new RegExp(c[X],"g");var Q=d++;c[Q]="^"+c[Y]+c[m]+"$";var B=d++;c[B]="^"+c[Y]+c[k]+"$";var W=d++;c[W]="^"+c[o]+"\\s*("+i+")$|^$";var U=d++;c[U]="^"+c[o]+"\\s*("+e+")$|^$";var S=d++;c[S]="(\\s*)"+c[o]+"\\s*("+i+"|"+c[m]+")",L[S]=new RegExp(c[S],"g");var M=d++;c[M]="^\\s*("+c[m]+")\\s+-\\s+("+c[m]+")\\s*$";var y=d++;c[y]="^\\s*("+c[k]+")\\s+-\\s+("+c[k]+")\\s*$";var A=d++;c[A]="(<|>)?=?\\s*\\*";for(var C=0;C<35;C++)E(C,c[C]),L[C]||(L[C]=new RegExp(c[C]));function z(V,G){if(V instanceof j)return V;if(typeof V!="string"||V.length>I||!(G?L[n]:L[s]).test(V))return null;try{return new j(V,G)}catch(K){return null}}function j(V,G){if(V instanceof j){if(V.loose===G)return V;V=V.version}else if(typeof V!="string")throw new TypeError("Invalid Version: "+V);if(V.length>I)throw new TypeError("version is longer than "+I+" characters");if(!(this instanceof j))return new j(V,G);E("SemVer",V,G),this.loose=G;var K=V.trim().match(G?L[n]:L[s]);if(!K)throw new TypeError("Invalid Version: "+V);if(this.raw=V,this.major=+K[1],this.minor=+K[2],this.patch=+K[3],this.major>T||this.major<0)throw new TypeError("Invalid major version");if(this.minor>T||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>T||this.patch<0)throw new TypeError("Invalid patch version");K[4]?this.prerelease=K[4].split(".").map(function(oe){if(/^[0-9]+$/.test(oe)){var ae=+oe;if(ae>=0&&ae<T)return ae}return oe}):this.prerelease=[],this.build=K[5]?K[5].split("."):[],this.format()}t.parse=z,t.valid=function(V,G){var K=z(V,G);return K?K.version:null},t.clean=function(V,G){var K=z(V.trim().replace(/^[=v]+/,""),G);return K?K.version:null},t.SemVer=j,j.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},j.prototype.toString=function(){return this.version},j.prototype.compare=function(V){return E("SemVer.compare",this.version,this.loose,V),V instanceof j||(V=new j(V,this.loose)),this.compareMain(V)||this.comparePre(V)},j.prototype.compareMain=function(V){return V instanceof j||(V=new j(V,this.loose)),H(this.major,V.major)||H(this.minor,V.minor)||H(this.patch,V.patch)},j.prototype.comparePre=function(V){if(V instanceof j||(V=new j(V,this.loose)),this.prerelease.length&&!V.prerelease.length)return-1;if(!this.prerelease.length&&V.prerelease.length)return 1;if(!this.prerelease.length&&!V.prerelease.length)return 0;var G=0;do{var K=this.prerelease[G],oe=V.prerelease[G];if(E("prerelease compare",G,K,oe),K===void 0&&oe===void 0)return 0;if(oe===void 0)return 1;if(K===void 0)return-1;if(K!==oe)return H(K,oe)}while(++G)},j.prototype.inc=function(V,G){switch(V){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",G);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",G);break;case"prepatch":this.prerelease.length=0,this.inc("patch",G),this.inc("pre",G);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",G),this.inc("pre",G);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var K=this.prerelease.length;--K>=0;)typeof this.prerelease[K]=="number"&&(this.prerelease[K]++,K=-2);K===-1&&this.prerelease.push(0)}G&&(this.prerelease[0]===G?isNaN(this.prerelease[1])&&(this.prerelease=[G,0]):this.prerelease=[G,0]);break;default:throw new Error("invalid increment argument: "+V)}return this.format(),this.raw=this.version,this},t.inc=function(V,G,K,oe){typeof K=="string"&&(oe=K,K=void 0);try{return new j(V,K).inc(G,oe).version}catch(ae){return null}},t.diff=function(V,G){if(ce(V,G))return null;var K=z(V),oe=z(G);if(K.prerelease.length||oe.prerelease.length){for(var ae in K)if((ae==="major"||ae==="minor"||ae==="patch")&&K[ae]!==oe[ae])return"pre"+ae;return"prerelease"}for(var ae in K)if((ae==="major"||ae==="minor"||ae==="patch")&&K[ae]!==oe[ae])return ae},t.compareIdentifiers=H;var $=/^[0-9]+$/;function H(V,G){var K=$.test(V),oe=$.test(G);return K&&oe&&(V=+V,G=+G),K&&!oe?-1:oe&&!K?1:V<G?-1:V>G?1:0}function ee(V,G,K){return new j(V,K).compare(new j(G,K))}function ne(V,G,K){return ee(V,G,K)>0}function re(V,G,K){return ee(V,G,K)<0}function ce(V,G,K){return ee(V,G,K)===0}function me(V,G,K){return ee(V,G,K)!==0}function be(V,G,K){return ee(V,G,K)>=0}function ke(V,G,K){return ee(V,G,K)<=0}function Te(V,G,K,oe){var ae;switch(G){case"===":typeof V=="object"&&(V=V.version),typeof K=="object"&&(K=K.version),ae=V===K;break;case"!==":typeof V=="object"&&(V=V.version),typeof K=="object"&&(K=K.version),ae=V!==K;break;case"":case"=":case"==":ae=ce(V,K,oe);break;case"!=":ae=me(V,K,oe);break;case">":ae=ne(V,K,oe);break;case">=":ae=be(V,K,oe);break;case"<":ae=re(V,K,oe);break;case"<=":ae=ke(V,K,oe);break;default:throw new TypeError("Invalid operator: "+G)}return ae}function we(V,G){if(V instanceof we){if(V.loose===G)return V;V=V.value}if(!(this instanceof we))return new we(V,G);E("comparator",V,G),this.loose=G,this.parse(V),this.semver===Fe?this.value="":this.value=this.operator+this.semver.version,E("comp",this)}t.rcompareIdentifiers=function(V,G){return H(G,V)},t.major=function(V,G){return new j(V,G).major},t.minor=function(V,G){return new j(V,G).minor},t.patch=function(V,G){return new j(V,G).patch},t.compare=ee,t.compareLoose=function(V,G){return ee(V,G,!0)},t.rcompare=function(V,G,K){return ee(G,V,K)},t.sort=function(V,G){return V.sort(function(K,oe){return t.compare(K,oe,G)})},t.rsort=function(V,G){return V.sort(function(K,oe){return t.rcompare(K,oe,G)})},t.gt=ne,t.lt=re,t.eq=ce,t.neq=me,t.gte=be,t.lte=ke,t.cmp=Te,t.Comparator=we;var Fe={};function ve(V,G){if(V instanceof ve)return V.loose===G?V:new ve(V.raw,G);if(V instanceof we)return new ve(V.value,G);if(!(this instanceof ve))return new ve(V,G);if(this.loose=G,this.raw=V,this.set=V.split(/\s*\|\|\s*/).map(function(K){return this.parseRange(K.trim())},this).filter(function(K){return K.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+V);this.format()}function Re(V){return!V||V.toLowerCase()==="x"||V==="*"}function je(V,G,K,oe,ae,Se,de,Le,ye,De,Ae,Ee,Ie){return((G=Re(K)?"":Re(oe)?">="+K+".0.0":Re(ae)?">="+K+"."+oe+".0":">="+G)+" "+(Le=Re(ye)?"":Re(De)?"<"+(+ye+1)+".0.0":Re(Ae)?"<"+ye+"."+(+De+1)+".0":Ee?"<="+ye+"."+De+"."+Ae+"-"+Ee:"<="+Le)).trim()}function Be(V,G){for(var K=0;K<V.length;K++)if(!V[K].test(G))return!1;if(G.prerelease.length){for(K=0;K<V.length;K++)if(E(V[K].semver),V[K].semver!==Fe&&V[K].semver.prerelease.length>0){var oe=V[K].semver;if(oe.major===G.major&&oe.minor===G.minor&&oe.patch===G.patch)return!0}return!1}return!0}function xe(V,G,K){try{G=new ve(G,K)}catch(oe){return!1}return G.test(V)}function ze(V,G,K,oe){var ae,Se,de,Le,ye;switch(V=new j(V,oe),G=new ve(G,oe),K){case">":ae=ne,Se=ke,de=re,Le=">",ye=">=";break;case"<":ae=re,Se=be,de=ne,Le="<",ye="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(xe(V,G,oe))return!1;for(var De=0;De<G.set.length;++De){var Ae=G.set[De],Ee=null,Ie=null;if(Ae.forEach(function(Ce){Ce.semver===Fe&&(Ce=new we(">=0.0.0")),Ee=Ee||Ce,Ie=Ie||Ce,ae(Ce.semver,Ee.semver,oe)?Ee=Ce:de(Ce.semver,Ie.semver,oe)&&(Ie=Ce)}),Ee.operator===Le||Ee.operator===ye||(!Ie.operator||Ie.operator===Le)&&Se(V,Ie.semver)||Ie.operator===ye&&de(V,Ie.semver))return!1}return!0}we.prototype.parse=function(V){var G=this.loose?L[W]:L[U],K=V.match(G);if(!K)throw new TypeError("Invalid comparator: "+V);this.operator=K[1],this.operator==="="&&(this.operator=""),K[2]?this.semver=new j(K[2],this.loose):this.semver=Fe},we.prototype.toString=function(){return this.value},we.prototype.test=function(V){return E("Comparator.test",V,this.loose),this.semver===Fe||(typeof V=="string"&&(V=new j(V,this.loose)),Te(V,this.operator,this.semver,this.loose))},we.prototype.intersects=function(V,G){if(!(V instanceof we))throw new TypeError("a Comparator is required");var K;if(this.operator==="")return K=new ve(V.value,G),xe(this.value,K,G);if(V.operator==="")return K=new ve(this.value,G),xe(V.semver,K,G);var oe=!(this.operator!==">="&&this.operator!==">"||V.operator!==">="&&V.operator!==">"),ae=!(this.operator!=="<="&&this.operator!=="<"||V.operator!=="<="&&V.operator!=="<"),Se=this.semver.version===V.semver.version,de=!(this.operator!==">="&&this.operator!=="<="||V.operator!==">="&&V.operator!=="<="),Le=Te(this.semver,"<",V.semver,G)&&(this.operator===">="||this.operator===">")&&(V.operator==="<="||V.operator==="<"),ye=Te(this.semver,">",V.semver,G)&&(this.operator==="<="||this.operator==="<")&&(V.operator===">="||V.operator===">");return oe||ae||Se&&de||Le||ye},t.Range=ve,ve.prototype.format=function(){return this.range=this.set.map(function(V){return V.join(" ").trim()}).join("||").trim(),this.range},ve.prototype.toString=function(){return this.range},ve.prototype.parseRange=function(V){var G=this.loose;V=V.trim(),E("range",V,G);var K=G?L[y]:L[M];V=V.replace(K,je),E("hyphen replace",V),V=V.replace(L[S],"$1$2$3"),E("comparator trim",V,L[S]),V=(V=(V=V.replace(L[J],"$1~")).replace(L[X],"$1^")).split(/\s+/).join(" ");var oe=G?L[W]:L[U],ae=V.split(" ").map(function(Se){return function(de,Le){return E("comp",de),de=function(ye,De){return ye.trim().split(/\s+/).map(function(Ae){return function(Ee,Ie){E("caret",Ee,Ie);var Ce=Ie?L[B]:L[Q];return Ee.replace(Ce,function(Oe,le,he,ge,pe){var Pe;return E("caret",Ee,Oe,le,he,ge,pe),Re(le)?Pe="":Re(he)?Pe=">="+le+".0.0 <"+(+le+1)+".0.0":Re(ge)?Pe=le==="0"?">="+le+"."+he+".0 <"+le+"."+(+he+1)+".0":">="+le+"."+he+".0 <"+(+le+1)+".0.0":pe?(E("replaceCaret pr",pe),pe.charAt(0)!=="-"&&(pe="-"+pe),Pe=le==="0"?he==="0"?">="+le+"."+he+"."+ge+pe+" <"+le+"."+he+"."+(+ge+1):">="+le+"."+he+"."+ge+pe+" <"+le+"."+(+he+1)+".0":">="+le+"."+he+"."+ge+pe+" <"+(+le+1)+".0.0"):(E("no pr"),Pe=le==="0"?he==="0"?">="+le+"."+he+"."+ge+" <"+le+"."+he+"."+(+ge+1):">="+le+"."+he+"."+ge+" <"+le+"."+(+he+1)+".0":">="+le+"."+he+"."+ge+" <"+(+le+1)+".0.0"),E("caret return",Pe),Pe})}(Ae,De)}).join(" ")}(de,Le),E("caret",de),de=function(ye,De){return ye.trim().split(/\s+/).map(function(Ae){return function(Ee,Ie){var Ce=Ie?L[se]:L[ie];return Ee.replace(Ce,function(Oe,le,he,ge,pe){var Pe;return E("tilde",Ee,Oe,le,he,ge,pe),Re(le)?Pe="":Re(he)?Pe=">="+le+".0.0 <"+(+le+1)+".0.0":Re(ge)?Pe=">="+le+"."+he+".0 <"+le+"."+(+he+1)+".0":pe?(E("replaceTilde pr",pe),pe.charAt(0)!=="-"&&(pe="-"+pe),Pe=">="+le+"."+he+"."+ge+pe+" <"+le+"."+(+he+1)+".0"):Pe=">="+le+"."+he+"."+ge+" <"+le+"."+(+he+1)+".0",E("tilde return",Pe),Pe})}(Ae,De)}).join(" ")}(de,Le),E("tildes",de),de=function(ye,De){return E("replaceXRanges",ye,De),ye.split(/\s+/).map(function(Ae){return function(Ee,Ie){Ee=Ee.trim();var Ce=Ie?L[N]:L[P];return Ee.replace(Ce,function(Oe,le,he,ge,pe,Pe){E("xRange",Ee,Oe,le,he,ge,pe,Pe);var Ve=Re(he),Me=Ve||Re(ge),Ue=Me||Re(pe);return le==="="&&Ue&&(le=""),Ve?Oe=le===">"||le==="<"?"<0.0.0":"*":le&&Ue?(Me&&(ge=0),Ue&&(pe=0),le===">"?(le=">=",Me?(he=+he+1,ge=0,pe=0):Ue&&(ge=+ge+1,pe=0)):le==="<="&&(le="<",Me?he=+he+1:ge=+ge+1),Oe=le+he+"."+ge+"."+pe):Me?Oe=">="+he+".0.0 <"+(+he+1)+".0.0":Ue&&(Oe=">="+he+"."+ge+".0 <"+he+"."+(+ge+1)+".0"),E("xRange return",Oe),Oe})}(Ae,De)}).join(" ")}(de,Le),E("xrange",de),de=function(ye,De){return E("replaceStars",ye,De),ye.trim().replace(L[A],"")}(de,Le),E("stars",de),de}(Se,G)}).join(" ").split(/\s+/);return this.loose&&(ae=ae.filter(function(Se){return!!Se.match(oe)})),ae=ae.map(function(Se){return new we(Se,G)})},ve.prototype.intersects=function(V,G){if(!(V instanceof ve))throw new TypeError("a Range is required");return this.set.some(function(K){return K.every(function(oe){return V.set.some(function(ae){return ae.every(function(Se){return oe.intersects(Se,G)})})})})},t.toComparators=function(V,G){return new ve(V,G).set.map(function(K){return K.map(function(oe){return oe.value}).join(" ").trim().split(" ")})},ve.prototype.test=function(V){if(!V)return!1;typeof V=="string"&&(V=new j(V,this.loose));for(var G=0;G<this.set.length;G++)if(Be(this.set[G],V))return!0;return!1},t.satisfies=xe,t.maxSatisfying=function(V,G,K){var oe=null,ae=null;try{var Se=new ve(G,K)}catch(de){return null}return V.forEach(function(de){Se.test(de)&&(oe&&ae.compare(de)!==-1||(ae=new j(oe=de,K)))}),oe},t.minSatisfying=function(V,G,K){var oe=null,ae=null;try{var Se=new ve(G,K)}catch(de){return null}return V.forEach(function(de){Se.test(de)&&(oe&&ae.compare(de)!==1||(ae=new j(oe=de,K)))}),oe},t.validRange=function(V,G){try{return new ve(V,G).range||"*"}catch(K){return null}},t.ltr=function(V,G,K){return ze(V,G,"<",K)},t.gtr=function(V,G,K){return ze(V,G,">",K)},t.outside=ze,t.prerelease=function(V,G){var K=z(V,G);return K&&K.prerelease.length?K.prerelease:null},t.intersects=function(V,G,K){return V=new ve(V,K),G=new ve(G,K),V.intersects(G)},t.coerce=function(V){if(V instanceof j)return V;if(typeof V!="string")return null;var G=V.match(L[x]);return G==null?null:z((G[1]||"0")+"."+(G[2]||"0")+"."+(G[3]||"0"))}}).call(this,g(1))},function(q,t){var g,O,E=q.exports={};function I(){throw new Error("setTimeout has not been defined")}function T(){throw new Error("clearTimeout has not been defined")}function L(R){if(g===setTimeout)return setTimeout(R,0);if((g===I||!g)&&setTimeout)return g=setTimeout,setTimeout(R,0);try{return g(R,0)}catch(b){try{return g.call(null,R,0)}catch(D){return g.call(this,R,0)}}}(function(){try{g=typeof setTimeout=="function"?setTimeout:I}catch(R){g=I}try{O=typeof clearTimeout=="function"?clearTimeout:T}catch(R){O=T}})();var c,d=[],v=!1,p=-1;function w(){v&&c&&(v=!1,c.length?d=c.concat(d):p=-1,d.length&&F())}function F(){if(!v){var R=L(w);v=!0;for(var b=d.length;b;){for(c=d,d=[];++p<b;)c&&c[p].run();p=-1,b=d.length}c=null,v=!1,function(D){if(O===clearTimeout)return clearTimeout(D);if((O===T||!O)&&clearTimeout)return O=clearTimeout,clearTimeout(D);try{O(D)}catch(f){try{return O.call(null,D)}catch(r){return O.call(this,D)}}}(R)}}function l(R,b){this.fun=R,this.array=b}function u(){}E.nextTick=function(R){var b=new Array(arguments.length-1);if(arguments.length>1)for(var D=1;D<arguments.length;D++)b[D-1]=arguments[D];d.push(new l(R,b)),d.length!==1||v||L(F)},l.prototype.run=function(){this.fun.apply(null,this.array)},E.title="browser",E.browser=!0,E.env={},E.argv=[],E.version="",E.versions={},E.on=u,E.addListener=u,E.once=u,E.off=u,E.removeListener=u,E.removeAllListeners=u,E.emit=u,E.prependListener=u,E.prependOnceListener=u,E.listeners=function(R){return[]},E.binding=function(R){throw new Error("process.binding is not supported")},E.cwd=function(){return"/"},E.chdir=function(R){throw new Error("process.chdir is not supported")},E.umask=function(){return 0}}])}),define(Z[36],te([0,1,8,2]),function(q,t,g,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prefixedStream=t.prefixedReadable=t.transform=t.toReadable=t.emptyStream=t.toStream=t.peekStream=t.listenStream=t.consumeStream=t.peekReadable=t.consumeReadable=t.newWriteableStream=t.isReadableBufferedStream=t.isReadableStream=void 0;function E(f){const r=f;return r?[r.on,r.pause,r.resume,r.destroy].every(s=>typeof s=="function"):!1}t.isReadableStream=E;function I(f){const r=f;return r?E(r.stream)&&Array.isArray(r.buffer)&&typeof r.ended=="boolean":!1}t.isReadableBufferedStream=I;function T(f,r){return new L(f,r)}t.newWriteableStream=T;class L{constructor(r,s){this.reducer=r,this.options=s,this.state={flowing:!1,ended:!1,destroyed:!1},this.buffer={data:[],error:[]},this.listeners={data:[],error:[],end:[]},this.pendingWritePromises=[]}pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(r){if(!this.state.destroyed){if(this.state.flowing)this.emitData(r);else if(this.buffer.data.push(r),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(s=>this.pendingWritePromises.push(s))}}error(r){this.state.destroyed||(this.state.flowing?this.emitError(r):this.buffer.error.push(r))}end(r){this.state.destroyed||(typeof r!="undefined"&&this.write(r),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(r){this.listeners.data.slice(0).forEach(s=>s(r))}emitError(r){this.listeners.error.length===0?(0,g.onUnexpectedError)(r):this.listeners.error.slice(0).forEach(s=>s(r))}emitEnd(){this.listeners.end.slice(0).forEach(r=>r())}on(r,s){if(!this.state.destroyed)switch(r){case"data":this.listeners.data.push(s),this.resume();break;case"end":this.listeners.end.push(s),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(s),this.state.flowing&&this.flowErrors();break}}removeListener(r,s){if(this.state.destroyed)return;let e;switch(r){case"data":e=this.listeners.data;break;case"end":e=this.listeners.end;break;case"error":e=this.listeners.error;break}if(e){const i=e.indexOf(s);i>=0&&e.splice(i,1)}}flowData(){if(this.buffer.data.length>0){const r=this.reducer(this.buffer.data);this.emitData(r),this.buffer.data.length=0;const s=[...this.pendingWritePromises];this.pendingWritePromises.length=0,s.forEach(e=>e())}}flowErrors(){if(this.listeners.error.length>0){for(const r of this.buffer.error)this.emitError(r);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}}function c(f,r){const s=[];let e;for(;(e=f.read())!==null;)s.push(e);return r(s)}t.consumeReadable=c;function d(f,r,s){const e=[];let i;for(;(i=f.read())!==null&&e.length<s;)e.push(i);return i===null&&e.length>0?r(e):{read:()=>{if(e.length>0)return e.shift();if(typeof i!="undefined"){const n=i;return i=void 0,n}return f.read()}}}t.peekReadable=d;function v(f,r){return new Promise((s,e)=>{const i=[];p(f,{onData:n=>{r&&i.push(n)},onError:n=>{r?e(n):s(void 0)},onEnd:()=>{s(r?r(i):void 0)}})})}t.consumeStream=v;function p(f,r){f.on("error",s=>r.onError(s)),f.on("end",()=>r.onEnd()),f.on("data",s=>r.onData(s))}t.listenStream=p;function w(f,r){return new Promise((s,e)=>{const i=new O.DisposableStore,n=[],o=m=>{if(n.push(m),n.length>r)return i.dispose(),f.pause(),s({stream:f,buffer:n,ended:!1})},a=m=>e(m),h=()=>s({stream:f,buffer:n,ended:!0});i.add((0,O.toDisposable)(()=>f.removeListener("error",a))),f.on("error",a),i.add((0,O.toDisposable)(()=>f.removeListener("end",h))),f.on("end",h),i.add((0,O.toDisposable)(()=>f.removeListener("data",o))),f.on("data",o)})}t.peekStream=w;function F(f,r){const s=T(r);return s.end(f),s}t.toStream=F;function l(){const f=T(()=>{throw new Error("not supported")});return f.end(),f}t.emptyStream=l;function u(f){let r=!1;return{read:()=>r?null:(r=!0,f)}}t.toReadable=u;function R(f,r,s){const e=T(s);return p(f,{onData:i=>e.write(r.data(i)),onError:i=>e.error(r.error?r.error(i):i),onEnd:()=>e.end()}),e}t.transform=R;function b(f,r,s){let e=!1;return{read:()=>{const i=r.read();return e?i:(e=!0,i!==null?s([f,i]):f)}}}t.prefixedReadable=b;function D(f,r,s){let e=!1;const i=T(s);return p(r,{onData:n=>e?i.write(n):(e=!0,i.write(s([f,n]))),onError:n=>i.error(n),onEnd:()=>{e||(e=!0,i.write(f)),i.end()}}),i}t.prefixedStream=D}),define(Z[16],te([0,1,18,36]),function(q,t,g,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prefixedBufferStream=t.prefixedBufferReadable=t.newWriteableBufferStream=t.streamToBufferReadableStream=t.bufferToStream=t.bufferedStreamToBuffer=t.streamToBuffer=t.bufferToReadable=t.readableToBuffer=t.writeUInt8=t.readUInt8=t.writeUInt32LE=t.readUInt32LE=t.writeUInt32BE=t.readUInt32BE=t.writeUInt16LE=t.readUInt16LE=t.VSBuffer=void 0;const E=typeof Buffer!="undefined",I=typeof TextEncoder!="undefined",T=typeof TextDecoder!="undefined";let L,c;class d{constructor(m){this.buffer=m,this.byteLength=this.buffer.byteLength}static alloc(m){return E?new d(Buffer.allocUnsafe(m)):new d(new Uint8Array(m))}static wrap(m){return E&&!Buffer.isBuffer(m)&&(m=Buffer.from(m.buffer,m.byteOffset,m.byteLength)),new d(m)}static fromString(m,k){return!(k?.dontUseNodeBuffer||!1)&&E?new d(Buffer.from(m)):I?(L||(L=new TextEncoder),new d(L.encode(m))):new d(g.encodeUTF8(m))}static concat(m,k){if(typeof k=="undefined"){k=0;for(let x=0,_=m.length;x<_;x++)k+=m[x].byteLength}const P=d.alloc(k);let N=0;for(let x=0,_=m.length;x<_;x++){const J=m[x];P.set(J,N),N+=J.byteLength}return P}toString(){return E?this.buffer.toString():T?(c||(c=new TextDecoder),c.decode(this.buffer)):g.decodeUTF8(this.buffer)}slice(m,k){return new d(this.buffer.subarray(m,k))}set(m,k){m instanceof d?this.buffer.set(m.buffer,k):this.buffer.set(m,k)}readUInt32BE(m){return w(this.buffer,m)}writeUInt32BE(m,k){F(this.buffer,m,k)}readUInt32LE(m){return l(this.buffer,m)}writeUInt32LE(m,k){u(this.buffer,m,k)}readUInt8(m){return R(this.buffer,m)}writeUInt8(m,k){b(this.buffer,m,k)}}t.VSBuffer=d;function v(h,m){return h[m+0]<<0>>>0|h[m+1]<<8>>>0}t.readUInt16LE=v;function p(h,m,k){h[k+0]=m&255,m=m>>>8,h[k+1]=m&255}t.writeUInt16LE=p;function w(h,m){return h[m]*2**24+h[m+1]*2**16+h[m+2]*2**8+h[m+3]}t.readUInt32BE=w;function F(h,m,k){h[k+3]=m,m=m>>>8,h[k+2]=m,m=m>>>8,h[k+1]=m,m=m>>>8,h[k]=m}t.writeUInt32BE=F;function l(h,m){return h[m+0]<<0>>>0|h[m+1]<<8>>>0|h[m+2]<<16>>>0|h[m+3]<<24>>>0}t.readUInt32LE=l;function u(h,m,k){h[k+0]=m&255,m=m>>>8,h[k+1]=m&255,m=m>>>8,h[k+2]=m&255,m=m>>>8,h[k+3]=m&255}t.writeUInt32LE=u;function R(h,m){return h[m]}t.readUInt8=R;function b(h,m,k){h[k]=m}t.writeUInt8=b;function D(h){return O.consumeReadable(h,m=>d.concat(m))}t.readableToBuffer=D;function f(h){return O.toReadable(h)}t.bufferToReadable=f;function r(h){return O.consumeStream(h,m=>d.concat(m))}t.streamToBuffer=r;async function s(h){return h.ended?d.concat(h.buffer):d.concat([...h.buffer,await r(h.stream)])}t.bufferedStreamToBuffer=s;function e(h){return O.toStream(h,m=>d.concat(m))}t.bufferToStream=e;function i(h){return O.transform(h,{data:m=>typeof m=="string"?d.fromString(m):d.wrap(m)},m=>d.concat(m))}t.streamToBufferReadableStream=i;function n(h){return O.newWriteableStream(m=>d.concat(m),h)}t.newWriteableBufferStream=n;function o(h,m){return O.prefixedReadable(h,m,k=>d.concat(k))}t.prefixedBufferReadable=o;function a(h,m){return O.prefixedStream(h,m,k=>d.concat(k))}t.prefixedBufferStream=a}),define(Z[19],te([0,1,13]),function(q,t,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filter=t.getCaseInsensitive=t.distinct=t.getOrDefault=t.safeStringify=t.equals=t.mixin=t.cloneAndChange=t.deepFreeze=t.deepClone=void 0;function O(u){if(!u||typeof u!="object"||u instanceof RegExp)return u;const R=Array.isArray(u)?[]:{};return Object.keys(u).forEach(b=>{u[b]&&typeof u[b]=="object"?R[b]=O(u[b]):R[b]=u[b]}),R}t.deepClone=O;function E(u){if(!u||typeof u!="object")return u;const R=[u];for(;R.length>0;){const b=R.shift();Object.freeze(b);for(const D in b)if(I.call(b,D)){const f=b[D];typeof f=="object"&&!Object.isFrozen(f)&&R.push(f)}}return u}t.deepFreeze=E;const I=Object.prototype.hasOwnProperty;function T(u,R){return L(u,R,new Set)}t.cloneAndChange=T;function L(u,R,b){if((0,g.isUndefinedOrNull)(u))return u;const D=R(u);if(typeof D!="undefined")return D;if((0,g.isArray)(u)){const f=[];for(const r of u)f.push(L(r,R,b));return f}if((0,g.isObject)(u)){if(b.has(u))throw new Error("Cannot clone recursive data-structure");b.add(u);const f={};for(let r in u)I.call(u,r)&&(f[r]=L(u[r],R,b));return b.delete(u),f}return u}function c(u,R,b=!0){return(0,g.isObject)(u)?((0,g.isObject)(R)&&Object.keys(R).forEach(D=>{D in u?b&&((0,g.isObject)(u[D])&&(0,g.isObject)(R[D])?c(u[D],R[D],b):u[D]=R[D]):u[D]=R[D]}),u):R}t.mixin=c;function d(u,R){if(u===R)return!0;if(u==null||R===null||R===void 0||typeof u!=typeof R||typeof u!="object"||Array.isArray(u)!==Array.isArray(R))return!1;let b,D;if(Array.isArray(u)){if(u.length!==R.length)return!1;for(b=0;b<u.length;b++)if(!d(u[b],R[b]))return!1}else{const f=[];for(D in u)f.push(D);f.sort();const r=[];for(D in R)r.push(D);if(r.sort(),!d(f,r))return!1;for(b=0;b<f.length;b++)if(!d(u[f[b]],R[f[b]]))return!1}return!0}t.equals=d;function v(u){const R=new Set;return JSON.stringify(u,(b,D)=>{if((0,g.isObject)(D)||Array.isArray(D)){if(R.has(D))return"[Circular]";R.add(D)}return D})}t.safeStringify=v;function p(u,R,b){const D=R(u);return typeof D=="undefined"?b:D}t.getOrDefault=p;function w(u,R){const b=Object.create(null);return!u||!R||Object.keys(R).forEach(f=>{const r=u[f],s=R[f];d(r,s)||(b[f]=s)}),b}t.distinct=w;function F(u,R){const b=R.toLowerCase(),D=Object.keys(u).find(f=>f.toLowerCase()===b);return D?u[D]:u[R]}t.getCaseInsensitive=F;function l(u,R){const b=Object.create(null);for(const D of Object.keys(u))R(D,u[D])&&(b[D]=u[D]);return b}t.filter=l}),define(Z[59],te([0,1,7]),function(q,t,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=t.getFirstFrame=t.parse=t.isRemoteConsoleLog=void 0;function O(d){const v=d;return v&&typeof v.type=="string"&&typeof v.severity=="string"}t.isRemoteConsoleLog=O;function E(d){const v=[];let p;try{const w=JSON.parse(d.arguments),F=w[w.length-1];F&&F.__$stack&&(w.pop(),p=F.__$stack),v.push(...w)}catch(w){v.push("Unable to log remote console arguments",d.arguments)}return{args:v,stack:p}}t.parse=E;function I(d){if(typeof d!="string")return I(E(d).stack);const v=d;if(v){const p=T(v),w=/at [^\/]*((?:(?:[a-zA-Z]+:)|(?:[\/])|(?:\\\\))(?:.+)):(\d+):(\d+)/.exec(p||"");if(w&&w.length===4)return{uri:g.URI.file(w[1]),line:Number(w[2]),column:Number(w[3])}}}t.getFirstFrame=I;function T(d){if(!d)return d;const v=d.indexOf(`
`);return v===-1?d:d.substring(0,v)}function L(d,v){const{args:p,stack:w}=E(d),F=typeof p[0]=="string"&&p.length===1;let l=T(w);l&&(l=`(${l.trim()})`);let u=[];if(typeof p[0]=="string"?l&&F?u=[`%c[${v}] %c${p[0]} %c${l}`,c("blue"),c(""),c("grey")]:u=[`%c[${v}] %c${p[0]}`,c("blue"),c(""),...p.slice(1)]:u=[`%c[${v}]%`,c("blue"),...p],l&&!F&&u.push(l),typeof console[d.severity]!="function")throw new Error("Unknown console method");console[d.severity].apply(console,u)}t.log=L;function c(d){return`color: ${d}`}}),define(Z[60],te([0,1,16,18,7]),function(q,t,g,O,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.revive=t.MarshalledId=t.parse=t.stringify=void 0;function I(v){return JSON.stringify(v,c)}t.stringify=I;function T(v){let p=JSON.parse(v);return p=d(p),p}t.parse=T;var L;(function(v){v[v.Uri=1]="Uri",v[v.Regexp=2]="Regexp",v[v.ScmResource=3]="ScmResource",v[v.ScmResourceGroup=4]="ScmResourceGroup",v[v.ScmProvider=5]="ScmProvider",v[v.CommentController=6]="CommentController",v[v.CommentThread=7]="CommentThread",v[v.CommentThreadReply=8]="CommentThreadReply",v[v.CommentNode=9]="CommentNode",v[v.CommentThreadNode=10]="CommentThreadNode",v[v.TimelineActionContext=11]="TimelineActionContext",v[v.NotebookCellActionContext=12]="NotebookCellActionContext",v[v.TestItemContext=13]="TestItemContext"})(L=t.MarshalledId||(t.MarshalledId={}));function c(v,p){return p instanceof RegExp?{$mid:2,source:p.source,flags:(0,O.regExpFlags)(p)}:p}function d(v,p=0){if(!v||p>200)return v;if(typeof v=="object"){switch(v.$mid){case 1:return E.URI.revive(v);case 2:return new RegExp(v.source,v.flags)}if(v instanceof g.VSBuffer||v instanceof Uint8Array)return v;if(Array.isArray(v))for(let w=0;w<v.length;++w)v[w]=d(v[w],p+1);else for(const w in v)Object.hasOwnProperty.call(v,w)&&(v[w]=d(v[w],p+1))}return v}t.revive=d}),define(Z[61],te([0,1,18,37,3,45,4]),function(q,t,g,O,E,I,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPathTerms=t.getBasenameTerms=t.isRelativePattern=t.hasSiblingFn=t.hasSiblingPromiseFn=t.parse=t.match=t.splitGlobAware=t.getEmptyExpression=void 0;function L(){return Object.create(null)}t.getEmptyExpression=L;const c="**",d="/",v="[/\\\\]",p="[^/\\\\]",w=/\//g;function F(S){switch(S){case 0:return"";case 1:return`${p}*?`;default:return`(?:${v}|${p}+${v}|${v}${p}+)*?`}}function l(S,M){if(!S)return[];const y=[];let A=!1,C=!1,z="";for(const j of S){switch(j){case M:if(!A&&!C){y.push(z),z="";continue}break;case"{":A=!0;break;case"}":A=!1;break;case"[":C=!0;break;case"]":C=!1;break}z+=j}return z&&y.push(z),y}t.splitGlobAware=l;function u(S){if(!S)return"";let M="";const y=l(S,d);if(y.every(A=>A===c))M=".*";else{let A=!1;y.forEach((C,z)=>{if(C===c){A||(M+=F(2),A=!0);return}let j=!1,$="",H=!1,ee="";for(const ne of C){if(ne!=="}"&&j){$+=ne;continue}if(H&&(ne!=="]"||!ee)){let re;ne==="-"?re=ne:(ne==="^"||ne==="!")&&!ee?re="^":ne===d?re="":re=g.escapeRegExpCharacters(ne),ee+=re;continue}switch(ne){case"{":j=!0;continue;case"[":H=!0;continue;case"}":M+=`(?:${l($,",").map(me=>u(me)).join("|")})`,j=!1,$="";break;case"]":M+="["+ee+"]",H=!1,ee="";break;case"?":M+=p;continue;case"*":M+=F(1);continue;default:M+=g.escapeRegExpCharacters(ne)}}z<y.length-1&&(y[z+1]!==c||z+2<y.length)&&(M+=v),A=!1})}return M}const R=/^\*\*\/\*\.[\w\.-]+$/,b=/^\*\*\/([\w\.-]+)\/?$/,D=/^{\*\*\/[\*\.]?[\w\.-]+\/?(,\*\*\/[\*\.]?[\w\.-]+\/?)*}$/,f=/^{\*\*\/[\*\.]?[\w\.-]+(\/(\*\*)?)?(,\*\*\/[\*\.]?[\w\.-]+(\/(\*\*)?)?)*}$/,r=/^\*\*((\/[\w\.-]+)+)\/?$/,s=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,e=new I.LRUCache(1e4),i=function(){return!1},n=function(){return null};function o(S,M){if(!S)return n;let y;typeof S!="string"?y=S.pattern:y=S,y=y.trim();const A=`${y}_${!!M.trimForExclusions}`;let C=e.get(A);if(C)return a(C,S);let z;if(R.test(y)){const j=y.substr(4);C=function($,H){return typeof $=="string"&&$.endsWith(j)?y:null}}else(z=b.exec(h(y,M)))?C=m(z[1],y):(M.trimForExclusions?f:D).test(y)?C=k(y,M):(z=r.exec(h(y,M)))?C=P(z[1].substr(1),y,!0):(z=s.exec(h(y,M)))?C=P(z[1],y,!1):C=N(y);return e.set(A,C),a(C,S)}function a(S,M){return typeof M=="string"?S:function(y,A){return O.isEqualOrParent(y,M.base)?S(E.relative(M.base,y),A):null}}function h(S,M){return M.trimForExclusions&&S.endsWith("/**")?S.substr(0,S.length-2):S}function m(S,M){const y=`/${S}`,A=`\\${S}`,C=function(j,$){return typeof j!="string"?null:$?$===S?M:null:j===S||j.endsWith(y)||j.endsWith(A)?M:null},z=[S];return C.basenames=z,C.patterns=[M],C.allBasenames=z,C}function k(S,M){const y=U(S.slice(1,-1).split(",").map($=>o($,M)).filter($=>$!==n),S),A=y.length;if(!A)return n;if(A===1)return y[0];const C=function($,H){for(let ee=0,ne=y.length;ee<ne;ee++)if(y[ee]($,H))return S;return null},z=y.find($=>!!$.allBasenames);z&&(C.allBasenames=z.allBasenames);const j=y.reduce(($,H)=>H.allPaths?$.concat(H.allPaths):$,[]);return j.length&&(C.allPaths=j),C}function P(S,M,y){const A=E.sep===E.posix.sep,C=A?S:S.replace(w,E.sep),z=E.sep+C,j=E.posix.sep+S,$=y?function(H,ee){return typeof H=="string"&&(H===C||H.endsWith(z)||!A&&(H===S||H.endsWith(j)))?M:null}:function(H,ee){return typeof H=="string"&&(H===C||!A&&H===S)?M:null};return $.allPaths=[(y?"*/":"./")+S],$}function N(S){try{const M=new RegExp(`^${u(S)}$`);return function(y){return M.lastIndex=0,typeof y=="string"&&M.test(y)?S:null}}catch(M){return n}}function x(S,M,y){return!S||typeof M!="string"?!1:_(S)(M,void 0,y)}t.match=x;function _(S,M={}){if(!S)return i;if(typeof S=="string"||Y(S)){const y=o(S,M);if(y===n)return i;const A=function(C,z){return!!y(C,z)};return y.allBasenames&&(A.allBasenames=y.allBasenames),y.allPaths&&(A.allPaths=y.allPaths),A}return B(S,M)}t.parse=_;function J(S){if(!S)return;let M;return y=>(M||(M=(S()||Promise.resolve([])).then(A=>A?se(A):{})),M.then(A=>!!A[y]))}t.hasSiblingPromiseFn=J;function ie(S){if(!S)return;let M;return y=>{if(!M){const A=S();M=A?se(A):{}}return!!M[y]}}t.hasSiblingFn=ie;function se(S){const M={};for(const y of S)M[y]=!0;return M}function Y(S){const M=S;return M&&typeof M.base=="string"&&typeof M.pattern=="string"}t.isRelativePattern=Y;function X(S){return S.allBasenames||[]}t.getBasenameTerms=X;function Q(S){return S.allPaths||[]}t.getPathTerms=Q;function B(S,M){const y=U(Object.getOwnPropertyNames(S).map($=>W($,S[$],M)).filter($=>$!==n)),A=y.length;if(!A)return n;if(!y.some($=>!!$.requiresSiblings)){if(A===1)return y[0];const $=function(ne,re){for(let ce=0,me=y.length;ce<me;ce++){const be=y[ce](ne,re);if(be)return be}return null},H=y.find(ne=>!!ne.allBasenames);H&&($.allBasenames=H.allBasenames);const ee=y.reduce((ne,re)=>re.allPaths?ne.concat(re.allPaths):ne,[]);return ee.length&&($.allPaths=ee),$}const C=function($,H,ee){let ne;for(let re=0,ce=y.length;re<ce;re++){const me=y[re];me.requiresSiblings&&ee&&(H||(H=E.basename($)),ne||(ne=H.substr(0,H.length-E.extname($).length)));const be=me($,H,ne,ee);if(be)return be}return null},z=y.find($=>!!$.allBasenames);z&&(C.allBasenames=z.allBasenames);const j=y.reduce(($,H)=>H.allPaths?$.concat(H.allPaths):$,[]);return j.length&&(C.allPaths=j),C}function W(S,M,y){if(M===!1)return n;const A=o(S,y);if(A===n)return n;if(typeof M=="boolean")return A;if(M){const C=M.when;if(typeof C=="string"){const z=(j,$,H,ee)=>{if(!ee||!A(j,$))return null;const ne=C.replace("$(basename)",H),re=ee(ne);return(0,T.isThenable)(re)?re.then(ce=>ce?S:null):re?S:null};return z.requiresSiblings=!0,z}}return A}function U(S,M){const y=S.filter($=>!!$.basenames);if(y.length<2)return S;const A=y.reduce(($,H)=>{const ee=H.basenames;return ee?$.concat(ee):$},[]);let C;if(M){C=[];for(let $=0,H=A.length;$<H;$++)C.push(M)}else C=y.reduce(($,H)=>{const ee=H.patterns;return ee?$.concat(ee):$},[]);const z=function($,H){if(typeof $!="string")return null;if(!H){let ne;for(ne=$.length;ne>0;ne--){const re=$.charCodeAt(ne-1);if(re===47||re===92)break}H=$.substr(ne)}const ee=A.indexOf(H);return ee!==-1?C[ee]:null};z.basenames=A,z.patterns=C,z.allBasenames=A;const j=S.filter($=>!$.basenames);return j.push(z),j}}),define(Z[62],te([0,1,7,3,18,9,10,20,37]),function(q,t,g,O,E,I,T,L,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitName=t.unmnemonicLabel=t.mnemonicButtonLabel=t.mnemonicMenuLabel=t.template=t.shorten=t.untildify=t.tildify=t.normalizeDriveLetter=t.getBaseLabel=t.getPathLabel=void 0;function d(o,a,h){if(typeof o=="string"&&(o=g.URI.file(o)),h){const k=h.getWorkspaceFolder(o);if(k){const P=h.getWorkspace().folders.length>1;let N;if((0,L.isEqual)(k.uri,o)?N="":N=(0,L.relativePath)(k.uri,o),P){const x=k.name?k.name:(0,L.basename)(k.uri);N=N?x+" \u2022 "+N:x}return N}}if(o.scheme!==I.Schemas.file&&o.scheme!==I.Schemas.untitled)return o.with({query:null,fragment:null}).toString(!0);if((0,c.hasDriveLetter)(o.fsPath))return(0,O.normalize)(p(o.fsPath));let m=(0,O.normalize)(o.fsPath);return!T.isWindows&&a?.userHome&&(m=F(m,a.userHome.fsPath)),m}t.getPathLabel=d;function v(o){if(!o)return;typeof o=="string"&&(o=g.URI.file(o));const a=(0,L.basename)(o)||(o.scheme===I.Schemas.file?o.fsPath:o.path);return T.isWindows&&(0,c.isRootOrDriveLetter)(a)?p(a):a}t.getBaseLabel=v;function p(o){return(0,c.hasDriveLetter)(o)?o.charAt(0).toUpperCase()+o.slice(1):o}t.normalizeDriveLetter=p;let w=Object.create(null);function F(o,a){if(T.isWindows||!o||!a)return o;let h=w.original===a?w.normalized:void 0;return h||(h=`${(0,E.rtrim)(a,O.posix.sep)}${O.posix.sep}`,w={original:a,normalized:h}),(T.isLinux?o.startsWith(h):(0,E.startsWithIgnoreCase)(o,h))&&(o=`~/${o.substr(h.length)}`),o}t.tildify=F;function l(o,a){return o.replace(/^~($|\/|\\)/,`${a}$1`)}t.untildify=l;const u="\u2026",R="\\\\",b="~";function D(o,a=O.sep){const h=new Array(o.length);let m=!1;for(let k=0;k<o.length;k++){let P=o[k];if(P===""){h[k]=`.${a}`;continue}if(!P){h[k]=P;continue}m=!0;let N="";P.indexOf(R)===0?(N=P.substr(0,P.indexOf(R)+R.length),P=P.substr(P.indexOf(R)+R.length)):P.indexOf(a)===0?(N=P.substr(0,P.indexOf(a)+a.length),P=P.substr(P.indexOf(a)+a.length)):P.indexOf(b)===0&&(N=P.substr(0,P.indexOf(b)+b.length),P=P.substr(P.indexOf(b)+b.length));const x=P.split(a);for(let _=1;m&&_<=x.length;_++)for(let J=x.length-_;m&&J>=0;J--){m=!1;let ie=x.slice(J,J+_).join(a);for(let se=0;!m&&se<o.length;se++)if(se!==k&&o[se]&&o[se].indexOf(ie)>-1){const Y=J+_===x.length,X=J>0&&o[se].indexOf(a)>-1?a+ie:ie,Q=o[se].endsWith(X);m=!Y||Q}if(!m){let se="";(x[0].endsWith(":")||N!=="")&&(J===1&&(J=0,_++,ie=x[0]+a+ie),J>0&&(se=x[0]+a),se=N+se),J>0&&(se=se+u+a),se=se+ie,J+_<x.length&&(se=se+a+u),h[k]=se}}m&&(h[k]=P)}return h}t.shorten=D;var f;(function(o){o[o.TEXT=0]="TEXT",o[o.VARIABLE=1]="VARIABLE",o[o.SEPARATOR=2]="SEPARATOR"})(f||(f={}));function r(o,a=Object.create(null)){const h=[];let m=!1,k="";for(const P of o)if(P==="$"||m&&P==="{")k&&h.push({value:k,type:f.TEXT}),k="",m=!0;else if(P==="}"&&m){const N=a[k];if(typeof N=="string")N.length&&h.push({value:N,type:f.VARIABLE});else if(N){const x=h[h.length-1];(!x||x.type!==f.SEPARATOR)&&h.push({value:N.label,type:f.SEPARATOR})}k="",m=!1}else k+=P;return k&&!m&&h.push({value:k,type:f.TEXT}),h.filter((P,N)=>{if(P.type===f.SEPARATOR){const x=h[N-1],_=h[N+1];return[x,_].every(J=>J&&(J.type===f.VARIABLE||J.type===f.TEXT)&&J.value.length>0)}return!0}).map(P=>P.value).join("")}t.template=r;function s(o,a){return T.isMacintosh||a?o.replace(/\(&&\w\)|&&/g,"").replace(/&/g,T.isMacintosh?"&":"&&"):o.replace(/&&|&/g,h=>h==="&"?"&&":"&")}t.mnemonicMenuLabel=s;function e(o,a){return T.isMacintosh||a?o.replace(/\(&&\w\)|&&/g,""):T.isWindows?o.replace(/&&|&/g,h=>h==="&"?"&&":"&"):o.replace(/&&/g,"_")}t.mnemonicButtonLabel=e;function i(o){return o.replace(/&/g,"&&")}t.unmnemonicLabel=i;function n(o){const a=o.indexOf("/")!==-1?O.posix:O.win32,h=a.basename(o),m=a.dirname(o);return h.length?{name:h,parentPath:m}:{name:m,parentPath:""}}t.splitName=n}),define(Z[46],te([0,1,126]),function(q,t,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LineDecoder=void 0;class O{constructor(I="utf8"){this.stringDecoder=new g.StringDecoder(I),this.remaining=null}write(I){const T=[],L=this.remaining?this.remaining+this.stringDecoder.write(I):this.stringDecoder.write(I);if(L.length<1)return T;let c=0,d,v=c;for(;v<L.length;)if(d=L.charCodeAt(v),d===13||d===10){if(T.push(L.substring(c,v)),v++,v<L.length){const p=d;d=L.charCodeAt(v),(p===13&&d===10||p===10&&d===13)&&v++}c=v}else v++;return this.remaining=c<L.length?L.substr(c):null,T}end(){return this.remaining}}t.LineDecoder=O}),define(Z[63],te([0,1,38,18,3,11]),function(q,t,g,O,E,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.realpathSync=t.realpath=t.realcaseSync=void 0;function T(v){const p=(0,E.dirname)(v);if(v===p)return v;const w=((0,E.basename)(v)||v).toLowerCase();try{const l=(0,I.readdirSync)(p).filter(u=>u.toLowerCase()===w);if(l.length===1){const u=T(p);if(u)return(0,E.join)(u,l[0])}else if(l.length>1){const u=l.indexOf(w);if(u>=0){const R=T(p);if(R)return(0,E.join)(R,l[u])}}}catch(F){}return null}t.realcaseSync=T;async function L(v){try{return await I.Promises.realpath(v)}catch(p){const w=d(v);return await I.Promises.access(w,g.constants.R_OK),w}}t.realpath=L;function c(v){try{return g.realpathSync(v)}catch(p){const w=d(v);return g.accessSync(w,g.constants.R_OK),w}}t.realpathSync=c;function d(v){return(0,O.rtrim)((0,E.normalize)(v),E.sep)}}),define(Z[64],te([0,1,11,31,3]),function(q,t,g,O,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstAvailablePowerShellInstallation=t.enumeratePowerShellInstallations=void 0;const I=/^\d+$/,T=/^Microsoft.PowerShell_.*/,L=/^Microsoft.PowerShellPreview_.*/;var c;(function(r){r[r.x64=0]="x64",r[r.x86=1]="x86",r[r.ARM=2]="ARM"})(c||(c={}));let d;switch(process.arch){case"ia32":case"x32":d=1;break;case"arm":case"arm64":d=2;break;default:d=0;break}let v;process.env.PROCESSOR_ARCHITEW6432?v=process.env.PROCESSOR_ARCHITEW6432==="ARM64"?2:0:process.env.PROCESSOR_ARCHITECTURE==="ARM64"?v=2:process.env.PROCESSOR_ARCHITECTURE==="X86"?v=1:v=0;class p{constructor(s,e,i){this.exePath=s,this.displayName=e,this.knownToExist=i}async exists(){return this.knownToExist===void 0&&(this.knownToExist=await g.SymlinkSupport.existsFile(this.exePath)),this.knownToExist}}function w({useAlternateBitness:r=!1}={}){return r?d===0?process.env["ProgramFiles(x86)"]||null:v===0&&process.env.ProgramW6432||null:process.env.ProgramFiles||null}async function F({useAlternateBitness:r=!1,findPreview:s=!1}={}){const e=w({useAlternateBitness:r});if(!e)return null;const i=E.join(e,"PowerShell");if(!await g.SymlinkSupport.existsDirectory(i))return null;let n=-1,o=null;for(const m of await g.Promises.readdir(i)){let k=-1;if(s){const N=m.indexOf("-");if(N<0)continue;const x=m.substring(0,N);if(!I.test(x)||m.substring(N+1)!=="preview")continue;k=parseInt(x,10)}else{if(!I.test(m))continue;k=parseInt(m,10)}if(k<=n)continue;const P=E.join(i,m,"pwsh.exe");!await g.SymlinkSupport.existsFile(P)||(o=P,n=k)}if(!o)return null;const a=e.includes("x86")?" (x86)":"",h=s?" Preview":"";return new p(o,`PowerShell${h}${a}`,!0)}async function l({findPreview:r}={}){if(!process.env.LOCALAPPDATA)return null;const s=E.join(process.env.LOCALAPPDATA,"Microsoft","WindowsApps");if(!await g.SymlinkSupport.existsDirectory(s))return null;const{pwshMsixDirRegex:e,pwshMsixName:i}=r?{pwshMsixDirRegex:L,pwshMsixName:"PowerShell Preview (Store)"}:{pwshMsixDirRegex:T,pwshMsixName:"PowerShell (Store)"};for(const n of await g.Promises.readdir(s))if(e.test(n)){const o=E.join(s,n,"pwsh.exe");return new p(o,i)}return null}function u(){const r=E.join(O.homedir(),".dotnet","tools","pwsh.exe");return new p(r,".NET Core PowerShell Global Tool")}function R(){const r=E.join(process.env.windir,d===1&&v!==1?"SysNative":"System32","WindowsPowerShell","v1.0","powershell.exe");return new p(r,"Windows PowerShell",!0)}async function*b(){let r=await F();r&&(yield r),r=await F({useAlternateBitness:!0}),r&&(yield r),r=await l(),r&&(yield r),r=u(),r&&(yield r),r=await F({findPreview:!0}),r&&(yield r),r=await l({findPreview:!0}),r&&(yield r),r=await F({useAlternateBitness:!0,findPreview:!0}),r&&(yield r),r=R(),r&&(yield r)}async function*D(){for await(const r of b())await r.exists()&&(yield r)}t.enumeratePowerShellInstallations=D;async function f(){for await(const r of D())return r;return null}t.getFirstAvailablePowerShellInstallation=f}),define(Z[65],te([0,1,3,38,10,127,2,11]),function(q,t,g,O,E,I,T,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CHANGE_BUFFER_DELAY=t.watchFolder=t.watchFile=void 0;function c(p,w,F){return v({path:p,isDirectory:!1},w,F)}t.watchFile=c;function d(p,w,F){return v({path:p,isDirectory:!0},w,F)}t.watchFolder=d,t.CHANGE_BUFFER_DELAY=100;function v(p,w,F){const l=(0,g.basename)(p.path),u=new Map;let R=!1,b=[(0,T.toDisposable)(()=>{u.forEach(D=>(0,T.dispose)(D)),u.clear()})];try{const D=(0,O.watch)(p.path);b.push((0,T.toDisposable)(()=>{D.removeAllListeners(),D.close()}));const f=new Set;p.isDirectory&&L.Promises.readdir(p.path).then(r=>r.forEach(s=>f.add(s))),D.on("error",(r,s)=>{R||F(`Failed to watch ${p.path} for changes using fs.watch() (${r}, ${s})`)}),D.on("change",(r,s)=>{if(R)return;let e="";if(s&&(e=s.toString(),E.isMacintosh&&(e=(0,I.normalizeNFC)(e))),!e||r!=="change"&&r!=="rename")return;const i=p.isDirectory?(0,g.join)(p.path,e):p.path;if(p.isDirectory)if(r==="rename"){const n=u.get(i);n&&(0,T.dispose)(n);const o=setTimeout(async()=>{u.delete(i);const a=await L.Promises.exists(i);if(R)return;let h;a?f.has(e)?h="changed":(h="added",f.add(e)):(f.delete(e),h="deleted"),w(h,i)},t.CHANGE_BUFFER_DELAY);u.set(i,(0,T.toDisposable)(()=>clearTimeout(o)))}else{let n;f.has(e)?n="changed":(n="added",f.add(e)),w(n,i)}else if(r==="rename"||e!==l){const n=setTimeout(async()=>{const o=await L.Promises.exists(i);R||(o?(w("changed",i),b=[v(p,w,F)]):w("deleted",i))},t.CHANGE_BUFFER_DELAY);(0,T.dispose)(b),b=[(0,T.toDisposable)(()=>clearTimeout(n))]}else w("changed",i)})}catch(D){L.Promises.exists(p.path).then(f=>{f&&!R&&F(`Failed to watch ${p.path} for changes using fs.watch() (${D.toString()})`)})}return(0,T.toDisposable)(()=>{R=!0,b=(0,T.dispose)(b)})}});var ue=this&&this.__decorate||function(q,t,g,O){var E=arguments.length,I=E<3?t:O===null?O=Object.getOwnPropertyDescriptor(t,g):O,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(q,t,g,O);else for(var L=q.length-1;L>=0;L--)(T=q[L])&&(I=(E<3?T(I):E>3?T(t,g,I):T(t,g))||I);return E>3&&I&&Object.defineProperty(t,g,I),I};define(Z[39],te([0,1,14,2,4,26,8,16,24,13,60,18,44]),function(q,t,g,O,E,I,T,L,c,d,v,p,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IPCLogger=t.logWithColors=t.ProxyChannel=t.StaticRouter=t.getNextTickChannel=t.getDelayedChannel=t.IPCClient=t.IPCServer=t.ChannelClient=t.RequestInitiator=t.ChannelServer=t.ResponseType=t.RequestType=void 0;var F;(function(U){U[U.Promise=100]="Promise",U[U.PromiseCancel=101]="PromiseCancel",U[U.EventListen=102]="EventListen",U[U.EventDispose=103]="EventDispose"})(F=t.RequestType||(t.RequestType={}));function l(U){switch(U){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}var u;(function(U){U[U.Initialize=200]="Initialize",U[U.PromiseSuccess=201]="PromiseSuccess",U[U.PromiseError=202]="PromiseError",U[U.PromiseErrorObj=203]="PromiseErrorObj",U[U.EventFire=204]="EventFire"})(u=t.ResponseType||(t.ResponseType={}));function R(U){switch(U){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}var b;(function(U){U[U.Uninitialized=0]="Uninitialized",U[U.Idle=1]="Idle"})(b||(b={}));class D{constructor(S){this.buffer=S,this.pos=0}read(S){const M=this.buffer.slice(this.pos,this.pos+S);return this.pos+=M.byteLength,M}}class f{constructor(){this.buffers=[]}get buffer(){return L.VSBuffer.concat(this.buffers)}write(S){this.buffers.push(S)}}var r;(function(U){U[U.Undefined=0]="Undefined",U[U.String=1]="String",U[U.Buffer=2]="Buffer",U[U.VSBuffer=3]="VSBuffer",U[U.Array=4]="Array",U[U.Object=5]="Object"})(r||(r={}));function s(U){const S=L.VSBuffer.alloc(4);return S.writeUInt32BE(U,0),S}function e(U){return U.read(4).readUInt32BE(0)}function i(U){const S=L.VSBuffer.alloc(1);return S.writeUInt8(U,0),S}const n={Undefined:i(r.Undefined),String:i(r.String),Buffer:i(r.Buffer),VSBuffer:i(r.VSBuffer),Array:i(r.Array),Object:i(r.Object)},o=typeof Buffer!="undefined";function a(U,S){if(typeof S=="undefined")U.write(n.Undefined);else if(typeof S=="string"){const M=L.VSBuffer.fromString(S);U.write(n.String),U.write(s(M.byteLength)),U.write(M)}else if(o&&Buffer.isBuffer(S)){const M=L.VSBuffer.wrap(S);U.write(n.Buffer),U.write(s(M.byteLength)),U.write(M)}else if(S instanceof L.VSBuffer)U.write(n.VSBuffer),U.write(s(S.byteLength)),U.write(S);else if(Array.isArray(S)){U.write(n.Array),U.write(s(S.length));for(const M of S)a(U,M)}else{const M=L.VSBuffer.fromString(JSON.stringify(S));U.write(n.Object),U.write(s(M.byteLength)),U.write(M)}}function h(U){switch(U.read(1).readUInt8(0)){case r.Undefined:return;case r.String:return U.read(e(U)).toString();case r.Buffer:return U.read(e(U)).buffer;case r.VSBuffer:return U.read(e(U));case r.Array:{const M=e(U),y=[];for(let A=0;A<M;A++)y.push(h(U));return y}case r.Object:return JSON.parse(U.read(e(U)).toString())}}class m{constructor(S,M,y=null,A=1e3){this.protocol=S,this.ctx=M,this.logger=y,this.timeoutDelay=A,this.channels=new Map,this.activeRequests=new Map,this.pendingRequests=new Map,this.protocolListener=this.protocol.onMessage(C=>this.onRawMessage(C)),this.sendResponse({type:200})}registerChannel(S,M){this.channels.set(S,M),setTimeout(()=>this.flushPendingRequests(S),0)}sendResponse(S){switch(S.type){case 200:{const M=this.send([S.type]);this.logger&&this.logger.logOutgoing(M,0,1,R(S.type));return}case 201:case 202:case 204:case 203:{const M=this.send([S.type,S.id],S.data);this.logger&&this.logger.logOutgoing(M,S.id,1,R(S.type),S.data);return}}}send(S,M=void 0){const y=new f;return a(y,S),a(y,M),this.sendBuffer(y.buffer)}sendBuffer(S){try{return this.protocol.send(S),S.byteLength}catch(M){return 0}}onRawMessage(S){const M=new D(S),y=h(M),A=h(M),C=y[0];switch(C){case 100:return this.logger&&this.logger.logIncoming(S.byteLength,y[1],1,`${l(C)}: ${y[2]}.${y[3]}`,A),this.onPromise({type:C,id:y[1],channelName:y[2],name:y[3],arg:A});case 102:return this.logger&&this.logger.logIncoming(S.byteLength,y[1],1,`${l(C)}: ${y[2]}.${y[3]}`,A),this.onEventListen({type:C,id:y[1],channelName:y[2],name:y[3],arg:A});case 101:return this.logger&&this.logger.logIncoming(S.byteLength,y[1],1,`${l(C)}`),this.disposeActiveRequest({type:C,id:y[1]});case 103:return this.logger&&this.logger.logIncoming(S.byteLength,y[1],1,`${l(C)}`),this.disposeActiveRequest({type:C,id:y[1]})}}onPromise(S){const M=this.channels.get(S.channelName);if(!M){this.collectPendingRequest(S);return}const y=new I.CancellationTokenSource;let A;try{A=M.call(this.ctx,S.name,S.arg,y.token)}catch(j){A=Promise.reject(j)}const C=S.id;A.then(j=>{this.sendResponse({id:C,data:j,type:201}),this.activeRequests.delete(S.id)},j=>{j instanceof Error?this.sendResponse({id:C,data:{message:j.message,name:j.name,stack:j.stack?j.stack.split?j.stack.split(`
`):j.stack:void 0},type:202}):this.sendResponse({id:C,data:j,type:203}),this.activeRequests.delete(S.id)});const z=(0,O.toDisposable)(()=>y.cancel());this.activeRequests.set(S.id,z)}onEventListen(S){const M=this.channels.get(S.channelName);if(!M){this.collectPendingRequest(S);return}const y=S.id,C=M.listen(this.ctx,S.name,S.arg)(z=>this.sendResponse({id:y,data:z,type:204}));this.activeRequests.set(S.id,C)}disposeActiveRequest(S){const M=this.activeRequests.get(S.id);M&&(M.dispose(),this.activeRequests.delete(S.id))}collectPendingRequest(S){let M=this.pendingRequests.get(S.channelName);M||(M=[],this.pendingRequests.set(S.channelName,M));const y=setTimeout(()=>{console.error(`Unknown channel: ${S.channelName}`),S.type===100&&this.sendResponse({id:S.id,data:{name:"Unknown channel",message:`Channel name '${S.channelName}' timed out after ${this.timeoutDelay}ms`,stack:void 0},type:202})},this.timeoutDelay);M.push({request:S,timeoutTimer:y})}flushPendingRequests(S){const M=this.pendingRequests.get(S);if(M){for(const y of M)switch(clearTimeout(y.timeoutTimer),y.request.type){case 100:this.onPromise(y.request);break;case 102:this.onEventListen(y.request);break}this.pendingRequests.delete(S)}}dispose(){this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),this.activeRequests.forEach(S=>S.dispose()),this.activeRequests.clear()}}t.ChannelServer=m;var k;(function(U){U[U.LocalSide=0]="LocalSide",U[U.OtherSide=1]="OtherSide"})(k=t.RequestInitiator||(t.RequestInitiator={}));class P{constructor(S,M=null){this.protocol=S,this.isDisposed=!1,this.state=b.Uninitialized,this.activeRequests=new Set,this.handlers=new Map,this.lastRequestId=0,this._onDidInitialize=new g.Emitter,this.onDidInitialize=this._onDidInitialize.event,this.protocolListener=this.protocol.onMessage(y=>this.onBuffer(y)),this.logger=M}getChannel(S){const M=this;return{call(y,A,C){return M.isDisposed?Promise.reject(T.canceled()):M.requestPromise(S,y,A,C)},listen(y,A){return M.isDisposed?Promise.reject(T.canceled()):M.requestEvent(S,y,A)}}}requestPromise(S,M,y,A=I.CancellationToken.None){const C=this.lastRequestId++,j={id:C,type:100,channelName:S,name:M,arg:y};if(A.isCancellationRequested)return Promise.reject(T.canceled());let $;return new Promise((ee,ne)=>{if(A.isCancellationRequested)return ne(T.canceled());const re=()=>{const ke=Te=>{switch(Te.type){case 201:this.handlers.delete(C),ee(Te.data);break;case 202:this.handlers.delete(C);const we=new Error(Te.data.message);we.stack=Te.data.stack,we.name=Te.data.name,ne(we);break;case 203:this.handlers.delete(C),ne(Te.data);break}};this.handlers.set(C,ke),this.sendRequest(j)};let ce=null;this.state===b.Idle?re():(ce=(0,E.createCancelablePromise)(ke=>this.whenInitialized()),ce.then(()=>{ce=null,re()}));const me=()=>{ce?(ce.cancel(),ce=null):this.sendRequest({id:C,type:101}),ne(T.canceled())},be=A.onCancellationRequested(me);$=(0,O.combinedDisposable)((0,O.toDisposable)(me),be),this.activeRequests.add($)}).finally(()=>{this.activeRequests.delete($)})}requestEvent(S,M,y){const A=this.lastRequestId++,z={id:A,type:102,channelName:S,name:M,arg:y};let j=null;const $=new g.Emitter({onFirstListenerAdd:()=>{j=(0,E.createCancelablePromise)(ee=>this.whenInitialized()),j.then(()=>{j=null,this.activeRequests.add($),this.sendRequest(z)})},onLastListenerRemove:()=>{j?(j.cancel(),j=null):(this.activeRequests.delete($),this.sendRequest({id:A,type:103}))}}),H=ee=>$.fire(ee.data);return this.handlers.set(A,H),$.event}sendRequest(S){switch(S.type){case 100:case 102:{const M=this.send([S.type,S.id,S.channelName,S.name],S.arg);this.logger&&this.logger.logOutgoing(M,S.id,0,`${l(S.type)}: ${S.channelName}.${S.name}`,S.arg);return}case 101:case 103:{const M=this.send([S.type,S.id]);this.logger&&this.logger.logOutgoing(M,S.id,0,l(S.type));return}}}send(S,M=void 0){const y=new f;return a(y,S),a(y,M),this.sendBuffer(y.buffer)}sendBuffer(S){try{return this.protocol.send(S),S.byteLength}catch(M){return 0}}onBuffer(S){const M=new D(S),y=h(M),A=h(M),C=y[0];switch(C){case 200:return this.logger&&this.logger.logIncoming(S.byteLength,0,0,R(C)),this.onResponse({type:y[0]});case 201:case 202:case 204:case 203:return this.logger&&this.logger.logIncoming(S.byteLength,y[1],0,R(C),A),this.onResponse({type:y[0],id:y[1],data:A})}}onResponse(S){if(S.type===200){this.state=b.Idle,this._onDidInitialize.fire();return}const M=this.handlers.get(S.id);M&&M(S)}get onDidInitializePromise(){return g.Event.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===b.Idle?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),this.activeRequests.forEach(S=>S.dispose()),this.activeRequests.clear()}}ue([w.memoize],P.prototype,"onDidInitializePromise",null),t.ChannelClient=P;class N{constructor(S){this.channels=new Map,this._connections=new Set,this._onDidAddConnection=new g.Emitter,this.onDidAddConnection=this._onDidAddConnection.event,this._onDidRemoveConnection=new g.Emitter,this.onDidRemoveConnection=this._onDidRemoveConnection.event,S(({protocol:M,onDidClientDisconnect:y})=>{g.Event.once(M.onMessage)(C=>{const z=new D(C),j=h(z),$=new m(M,j),H=new P(M);this.channels.forEach((ne,re)=>$.registerChannel(re,ne));const ee={channelServer:$,channelClient:H,ctx:j};this._connections.add(ee),this._onDidAddConnection.fire(ee),y(()=>{$.dispose(),H.dispose(),this._connections.delete(ee),this._onDidRemoveConnection.fire(ee)})})})}get connections(){const S=[];return this._connections.forEach(M=>S.push(M)),S}getChannel(S,M){const y=this;return{call(A,C,z){let j;if((0,d.isFunction)(M)){let H=(0,c.getRandomElement)(y.connections.filter(M));j=H?Promise.resolve(H):g.Event.toPromise(g.Event.filter(y.onDidAddConnection,M))}else j=M.routeCall(y,A,C);const $=j.then(H=>H.channelClient.getChannel(S));return _($).call(A,C,z)},listen(A,C){if((0,d.isFunction)(M))return y.getMulticastEvent(S,M,A,C);const z=M.routeEvent(y,A,C).then(j=>j.channelClient.getChannel(S));return _(z).listen(A,C)}}}getMulticastEvent(S,M,y,A){const C=this;let z=new O.DisposableStore;const j=new g.Emitter({onFirstListenerAdd:()=>{z=new O.DisposableStore;const $=new g.EventMultiplexer,H=new Map,ee=re=>{const me=re.channelClient.getChannel(S).listen(y,A),be=$.add(me);H.set(re,be)},ne=re=>{const ce=H.get(re);!ce||(ce.dispose(),H.delete(re))};C.connections.filter(M).forEach(ee),g.Event.filter(C.onDidAddConnection,M)(ee,void 0,z),C.onDidRemoveConnection(ne,void 0,z),$.event(j.fire,j,z),z.add($)},onLastListenerRemove:()=>{z.dispose()}});return j.event}registerChannel(S,M){this.channels.set(S,M),this._connections.forEach(y=>{y.channelServer.registerChannel(S,M)})}dispose(){this.channels.clear(),this._connections.clear(),this._onDidAddConnection.dispose(),this._onDidRemoveConnection.dispose()}}t.IPCServer=N;class x{constructor(S,M,y=null){const A=new f;a(A,M),S.send(A.buffer),this.channelClient=new P(S,y),this.channelServer=new m(S,M,y)}getChannel(S){return this.channelClient.getChannel(S)}registerChannel(S,M){this.channelServer.registerChannel(S,M)}dispose(){this.channelClient.dispose(),this.channelServer.dispose()}}t.IPCClient=x;function _(U){return{call(S,M,y){return U.then(A=>A.call(S,M,y))},listen(S,M){const y=new g.Relay;return U.then(A=>y.input=A.listen(S,M)),y.event}}}t.getDelayedChannel=_;function J(U){let S=!1;return{call(M,y,A){return S?U.call(M,y,A):(0,E.timeout)(0).then(()=>S=!0).then(()=>U.call(M,y,A))},listen(M,y){if(S)return U.listen(M,y);const A=new g.Relay;return(0,E.timeout)(0).then(()=>S=!0).then(()=>A.input=U.listen(M,y)),A.event}}}t.getNextTickChannel=J;class ie{constructor(S){this.fn=S}routeCall(S){return this.route(S)}routeEvent(S){return this.route(S)}async route(S){for(const M of S.connections)if(await Promise.resolve(this.fn(M.ctx)))return Promise.resolve(M);return await g.Event.toPromise(S.onDidAddConnection),await this.route(S)}}t.StaticRouter=ie;var se;(function(U){function S(A,C){const z=A,j=C&&C.disableMarshalling,$=new Map;for(const H in z)y(H)&&$.set(H,g.Event.buffer(z[H],!0));return new class{listen(H,ee){const ne=$.get(ee);if(ne)return ne;throw new Error(`Event not found: ${ee}`)}call(H,ee,ne){const re=z[ee];if(typeof re=="function"){if(!j&&Array.isArray(ne))for(let ce=0;ce<ne.length;ce++)ne[ce]=(0,v.revive)(ne[ce]);return re.apply(z,ne)}throw new Error(`Method not found: ${ee}`)}}}U.fromService=S;function M(A,C){const z=C&&C.disableMarshalling;return new Proxy({},{get(j,$){if(typeof $=="string")return C?.properties?.has($)?C.properties.get($):y($)?A.listen($):async function(...H){let ee;C&&!(0,d.isUndefinedOrNull)(C.context)?ee=[C.context,...H]:ee=H;const ne=await A.call($,ee);return z?ne:(0,v.revive)(ne)};throw new Error(`Property not found: ${String($)}`)}})}U.toService=M;function y(A){return A[0]==="o"&&A[1]==="n"&&p.isUpperAsciiLetter(A.charCodeAt(2))}})(se=t.ProxyChannel||(t.ProxyChannel={}));const Y=[["#2977B1","#FC802D","#34A13A","#D3282F","#9366BA"],["#8B564C","#E177C0","#7F7F7F","#BBBE3D","#2EBECD"]];function X(U){if(Array.isArray(U))return U;if(U&&typeof U=="object"&&typeof U.toString=="function"){let S=U.toString();if(S!=="[object Object]")return S}return U}function Q(U){return Array.isArray(U)?U.map(X):X(U)}function B(U,S,M,y,A,C,z){z=Q(z);const j=Y[A],$=j[y%j.length];let H=[`%c[${U}]%c[${String(S).padStart(7," ")}]%c[len: ${String(M).padStart(5," ")}]%c${String(y).padStart(5," ")} - ${C}`,"color: darkgreen","color: grey","color: grey",`color: ${$}`];/\($/.test(C)?(H=H.concat(z),H.push(")")):H.push(z),console.log.apply(console,H)}t.logWithColors=B;class W{constructor(S,M){this._outgoingPrefix=S,this._incomingPrefix=M,this._totalIncoming=0,this._totalOutgoing=0}logOutgoing(S,M,y,A,C){this._totalOutgoing+=S,B(this._outgoingPrefix,this._totalOutgoing,S,M,y,A,C)}logIncoming(S,M,y,A,C){this._totalIncoming+=S,B(this._incomingPrefix,this._totalIncoming,S,M,y,A,C)}}t.IPCLogger=W}),define(Z[66],te([0,1,2,14,4,13]),function(q,t,g,O,E,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryStorageDatabase=t.Storage=t.StorageHint=void 0;var T;(function(v){v[v.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST"})(T=t.StorageHint||(t.StorageHint={}));var L;(function(v){v[v.None=0]="None",v[v.Initialized=1]="Initialized",v[v.Closed=2]="Closed"})(L||(L={}));class c extends g.Disposable{constructor(p,w=Object.create(null)){super();this.database=p,this.options=w,this._onDidChangeStorage=this._register(new O.Emitter),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=L.None,this.cache=new Map,this.flushDelayer=new E.ThrottledDelayer(c.DEFAULT_FLUSH_DELAY),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.pendingClose=void 0,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(p=>this.onDidChangeItemsExternal(p)))}onDidChangeItemsExternal(p){p.changed?.forEach((w,F)=>this.accept(F,w)),p.deleted?.forEach(w=>this.accept(w,void 0))}accept(p,w){if(this.state===L.Closed)return;let F=!1;(0,I.isUndefinedOrNull)(w)?F=this.cache.delete(p):this.cache.get(p)!==w&&(this.cache.set(p,w),F=!0),F&&this._onDidChangeStorage.fire(p)}get items(){return this.cache}get size(){return this.cache.size}async init(){this.state===L.None&&(this.state=L.Initialized,this.options.hint!==T.STORAGE_DOES_NOT_EXIST&&(this.cache=await this.database.getItems()))}get(p,w){const F=this.cache.get(p);return(0,I.isUndefinedOrNull)(F)?w:F}getBoolean(p,w){const F=this.get(p);return(0,I.isUndefinedOrNull)(F)?w:F==="true"}getNumber(p,w){const F=this.get(p);return(0,I.isUndefinedOrNull)(F)?w:parseInt(F,10)}async set(p,w){if(this.state===L.Closed)return;if((0,I.isUndefinedOrNull)(w))return this.delete(p);const F=String(w);if(this.cache.get(p)!==F)return this.cache.set(p,F),this.pendingInserts.set(p,F),this.pendingDeletes.delete(p),this._onDidChangeStorage.fire(p),this.flushDelayer.trigger(()=>this.flushPending())}async delete(p){if(!(this.state===L.Closed||!this.cache.delete(p)))return this.pendingDeletes.has(p)||this.pendingDeletes.add(p),this.pendingInserts.delete(p),this._onDidChangeStorage.fire(p),this.flushDelayer.trigger(()=>this.flushPending())}async close(){return this.pendingClose||(this.pendingClose=this.doClose()),this.pendingClose}async doClose(){this.state=L.Closed;try{await this.flushDelayer.trigger(()=>this.flushPending(),0)}catch(p){}await this.database.close(()=>this.cache)}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const p={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(p).finally(()=>{if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)this.whenFlushedCallbacks.pop()?.()})}async whenFlushed(){if(!!this.hasPending)return new Promise(p=>this.whenFlushedCallbacks.push(p))}dispose(){this.flushDelayer.dispose(),super.dispose()}}t.Storage=c,c.DEFAULT_FLUSH_DELAY=100;class d{constructor(){this.onDidChangeItemsExternal=O.Event.None,this.items=new Map}async getItems(){return this.items}async updateItems(p){p.insert&&p.insert.forEach((w,F)=>this.items.set(F,w)),p.delete&&p.delete.forEach(w=>this.items.delete(w))}async close(){}}t.InMemoryStorageDatabase=d}),define(Z[67],te([5,6]),function(q,t){return q.create("vs/base/common/date",t)}),define(Z[68],te([0,1,67]),function(q,t,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toLocalISOString=t.fromNow=void 0;const O=60,E=O*60,I=E*24,T=I*7,L=I*30,c=I*365;function d(p,w){typeof p!="number"&&(p=p.getTime());const F=Math.round((new Date().getTime()-p)/1e3);if(F<-30)return(0,g.localize)(0,null,d(new Date().getTime()+F*1e3,!1));if(F<30)return(0,g.localize)(1,null);let l;return F<O?(l=F,w?l===1?(0,g.localize)(2,null,l):(0,g.localize)(3,null,l):l===1?(0,g.localize)(4,null,l):(0,g.localize)(5,null,l)):F<E?(l=Math.floor(F/O),w?l===1?(0,g.localize)(6,null,l):(0,g.localize)(7,null,l):l===1?(0,g.localize)(8,null,l):(0,g.localize)(9,null,l)):F<I?(l=Math.floor(F/E),w?l===1?(0,g.localize)(10,null,l):(0,g.localize)(11,null,l):l===1?(0,g.localize)(12,null,l):(0,g.localize)(13,null,l)):F<T?(l=Math.floor(F/I),w?l===1?(0,g.localize)(14,null,l):(0,g.localize)(15,null,l):l===1?(0,g.localize)(16,null,l):(0,g.localize)(17,null,l)):F<L?(l=Math.floor(F/T),w?l===1?(0,g.localize)(18,null,l):(0,g.localize)(19,null,l):l===1?(0,g.localize)(20,null,l):(0,g.localize)(21,null,l)):F<c?(l=Math.floor(F/L),w?l===1?(0,g.localize)(22,null,l):(0,g.localize)(23,null,l):l===1?(0,g.localize)(24,null,l):(0,g.localize)(25,null,l)):(l=Math.floor(F/c),w?l===1?(0,g.localize)(26,null,l):(0,g.localize)(27,null,l):l===1?(0,g.localize)(28,null,l):(0,g.localize)(29,null,l))}t.fromNow=d;function v(p){return p.getFullYear()+"-"+String(p.getMonth()+1).padStart(2,"0")+"-"+String(p.getDate()).padStart(2,"0")+"T"+String(p.getHours()).padStart(2,"0")+":"+String(p.getMinutes()).padStart(2,"0")+":"+String(p.getSeconds()).padStart(2,"0")+"."+(p.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}t.toLocalISOString=v}),define(Z[69],te([5,6]),function(q,t){return q.create("vs/base/common/errorMessage",t)}),define(Z[28],te([0,1,69,13,24]),function(q,t,g,O,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toErrorMessage=void 0;function I(d,v){return v&&(d.stack||d.stacktrace)?g.localize(0,null,L(d),T(d.stack)||T(d.stacktrace)):L(d)}function T(d){return Array.isArray(d)?d.join(`
`):d}function L(d){return typeof d.code=="string"&&typeof d.errno=="number"&&typeof d.syscall=="string"?g.localize(1,null,d.message):d.message||g.localize(2,null)}function c(d=null,v=!1){if(!d)return g.localize(3,null);if(Array.isArray(d)){const p=E.coalesce(d),w=c(p[0],v);return p.length>1?g.localize(4,null,w,p.length):w}if(O.isString(d))return d;if(d.detail){const p=d.detail;if(p.error)return I(p.error,v);if(p.exception)return I(p.exception,v)}return d.stack?I(d,v):d.message?d.message:g.localize(5,null)}t.toErrorMessage=c}),define(Z[70],te([5,6]),function(q,t){return q.create("vs/base/node/processes",t)}),define(Z[47],te([0,1,3,11,32,70,33,13,19,37,10,46,9]),function(q,t,g,O,E,I,T,L,c,d,v,p,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.win32=t.createQueuedSender=t.LineProcess=t.AbstractProcess=t.getWindowsShell=t.TerminateResponseCode=t.Source=void 0;function F(r){switch(r){case 0:return 0;case 1:return 2;case 128:return 3;default:return 1}}function l(r,s){if(v.isWindows)try{const e={stdio:["pipe","pipe","ignore"]};s&&(e.cwd=s);const i=E.execFile("taskkill",["/T","/F","/PID",r.pid.toString()],e);return new Promise(n=>{i.once("error",o=>{n({success:!1,error:o})}),i.once("exit",(o,a)=>{n(o===0?{success:!0}:{success:!1,code:o!==null?o:1})})})}catch(e){return Promise.resolve({success:!1,error:e,code:e.status?F(e.status):1})}else if(v.isLinux||v.isMacintosh)try{const e=w.FileAccess.asFileUri("vs/base/node/terminateProcess.sh",q).fsPath;return new Promise(i=>{E.execFile(e,[r.pid.toString()],{encoding:"utf8",shell:!0},(n,o,a)=>{i(n?{success:!1,error:n}:{success:!0})})})}catch(e){return Promise.resolve({success:!1,error:e})}else r.kill("SIGKILL");return Promise.resolve({success:!0})}function u(r=T.env){return r.comspec||"cmd.exe"}t.getWindowsShell=u;class R{constructor(s,e,i,n){if(e!==void 0&&i!==void 0&&n!==void 0)this.cmd=s,this.args=e,this.shell=i,this.options=n;else{const o=s;this.cmd=o.command,this.shell=o.isShellCommand,this.args=o.args.slice(0),this.options=o.options||{}}if(this.childProcess=null,this.childProcessPromise=null,this.terminateRequested=!1,this.options.env){const o=Object.create(null);Object.keys(T.env).forEach(a=>{o[a]=T.env[a]}),Object.keys(this.options.env).forEach(a=>{o[a]=this.options.env[a]}),this.options.env=o}}getSanitizedCommand(){let s=this.cmd.toLowerCase();const e=s.lastIndexOf(g.sep);return e!==-1&&(s=s.substring(e+1)),R.WellKnowCommands[s]?s:"other"}start(s){return v.isWindows&&(this.options&&this.options.cwd&&d.isUNC(this.options.cwd)||!this.options&&d.isUNC(T.cwd()))?Promise.reject(new Error(I.localize(0,null))):this.useExec().then(e=>{let i,n;const o=new Promise((a,h)=>{i=a,n=h});if(e){let a=this.cmd;this.args&&(a=a+" "+this.args.join(" ")),this.childProcess=E.exec(a,this.options,(h,m,k)=>{this.childProcess=null;const P=h;P&&P.killed?n({killed:this.terminateRequested,stdout:m.toString(),stderr:k.toString()}):this.handleExec(i,s,h,m,k)})}else{let a=null;const h=m=>{this.childProcess=null,this.childProcessPromise=null,this.handleClose(m,i,s,n);const k={terminated:this.terminateRequested};L.isNumber(m)&&(k.cmdCode=m),i(k)};if(this.shell&&v.isWindows){const m=c.deepClone(this.options);m.windowsVerbatimArguments=!0,m.detached=!1;let k=!1,P=!1;const N=[];let x=this.ensureQuotes(this.cmd);N.push(x.value),k=x.quoted,this.args&&this.args.forEach(J=>{x=this.ensureQuotes(J),N.push(x.value),P=P&&x.quoted});const _=["/s","/c"];k?P?_.push('"'+N.join(" ")+'"'):N.length>1?_.push('"'+N[0]+'" '+N.slice(1).join(" ")):_.push('"'+N[0]+'"'):_.push(N.join(" ")),a=E.spawn(u(),_,m)}else this.cmd&&(a=E.spawn(this.cmd,this.args,this.options));a&&(this.childProcess=a,this.childProcessPromise=Promise.resolve(a),this.pidResolve&&(this.pidResolve(L.isNumber(a.pid)?a.pid:-1),this.pidResolve=void 0),a.on("error",m=>{this.childProcess=null,n({terminated:this.terminateRequested,error:m})}),a.pid&&(this.childProcess.on("close",h),this.handleSpawn(a,i,s,n,!0)))}return o})}handleClose(s,e,i,n){}ensureQuotes(s){return R.regexp.test(s)?{value:'"'+s+'"',quoted:!0}:{value:s,quoted:s.length>0&&s[0]==='"'&&s[s.length-1]==='"'}}get pid(){return this.childProcessPromise?this.childProcessPromise.then(s=>s.pid,s=>-1):new Promise(s=>{this.pidResolve=s})}terminate(){return this.childProcessPromise?this.childProcessPromise.then(s=>(this.terminateRequested=!0,l(s,this.options.cwd).then(e=>(e.success&&(this.childProcess=null),e))),s=>({success:!0})):Promise.resolve({success:!0})}useExec(){return new Promise(s=>{if(!this.shell||!v.isWindows)return s(!1);const e=E.spawn(u(),["/s","/c"]);e.on("error",i=>s(!0)),e.on("exit",i=>s(!1))})}}t.AbstractProcess=R,R.WellKnowCommands={ant:!0,cmake:!0,eslint:!0,gradle:!0,grunt:!0,gulp:!0,jake:!0,jenkins:!0,jshint:!0,make:!0,maven:!0,msbuild:!0,msc:!0,nmake:!0,npm:!0,rake:!0,tsc:!0,xbuild:!0},R.regexp=/^[^"].* .*[^"]/;class b extends R{constructor(s,e,i,n){super(s,e,i,n);this.stdoutLineDecoder=null,this.stderrLineDecoder=null}handleExec(s,e,i,n,o){[n,o].forEach((a,h)=>{const m=new p.LineDecoder;m.write(a).forEach(N=>{e({line:N,source:h===0?0:1})});const P=m.end();P&&e({line:P,source:h===0?0:1})}),s({terminated:this.terminateRequested,error:i})}handleSpawn(s,e,i,n,o){const a=new p.LineDecoder,h=new p.LineDecoder;s.stdout.on("data",m=>{a.write(m).forEach(P=>i({line:P,source:0}))}),s.stderr.on("data",m=>{h.write(m).forEach(P=>i({line:P,source:1}))}),this.stdoutLineDecoder=a,this.stderrLineDecoder=h}handleClose(s,e,i,n){const o=this.stdoutLineDecoder?this.stdoutLineDecoder.end():null;o&&i({line:o,source:0});const a=this.stderrLineDecoder?this.stderrLineDecoder.end():null;a&&i({line:a,source:1})}}t.LineProcess=b;function D(r){let s=[],e=!1;const i=function(n){if(e){s.push(n);return}(!r.send(n,a=>{if(a&&console.error(a),e=!1,s.length>0){const h=s.slice(0);s=[],h.forEach(m=>i(m))}})||v.isWindows)&&(e=!0)};return{send:i}}t.createQueuedSender=D;var f;(function(r){async function s(e,i,n){if(g.isAbsolute(e))return e;if(i===void 0&&(i=T.cwd()),g.dirname(e)!=="."||(n===void 0&&L.isString(T.env.PATH)&&(n=T.env.PATH.split(g.delimiter)),n===void 0||n.length===0))return g.join(i,e);async function a(h){return await O.Promises.exists(h)?!(await O.Promises.stat(h)).isDirectory():!1}for(let h of n){let m;if(g.isAbsolute(h)?m=g.join(h,e):m=g.join(i,h,e),await a(m))return m;let k=m+".com";if(await a(k)||(k=m+".exe",await a(k)))return k}return g.join(i,e)}r.findExecutable=s})(f=t.win32||(t.win32={}))}),define(Z[71],te([0,1,31,10,64,47]),function(q,t,g,O,E,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSystemShellSync=t.getSystemShell=void 0;async function T(F,l){return F===1?O.isWindows?p():I.getWindowsShell(l):d(F,l)}t.getSystemShell=T;function L(F,l){return F===1?O.isWindows?w(l):I.getWindowsShell(l):d(F,l)}t.getSystemShellSync=L;let c=null;function d(F,l){if(O.isLinux&&F===2||O.isMacintosh&&F===3)return"/bin/bash";if(!c){let u;if(O.isWindows)u="/bin/bash";else{if(u=l.SHELL,!u)try{u=(0,g.userInfo)().shell}catch(R){}u||(u="sh"),u==="/bin/false"&&(u="/bin/bash")}c=u}return c}let v=null;async function p(){return v||(v=(await(0,E.getFirstAvailablePowerShellInstallation)()).exePath),v}function w(F){if(v)return v;const l=O.isWindows&&parseFloat((0,g.release)())>=10,u=F.hasOwnProperty("PROCESSOR_ARCHITEW6432"),R=`${F.windir}\\${u?"Sysnative":"System32"}\\WindowsPowerShell\\v1.0\\powershell.exe`;return l?R:I.getWindowsShell(F)}}),define(Z[48],te([0,1,32,2,4,19,14,47,39,59,26,8,16,10]),function(q,t,g,O,E,I,T,L,c,d,v,p,w,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Client=t.Server=void 0;class l extends c.ChannelServer{constructor(b){super({send:D=>{try{process.send&&process.send(D.buffer.toString("base64"))}catch(f){}},onMessage:T.Event.fromNodeEventEmitter(process,"message",D=>w.VSBuffer.wrap(Buffer.from(D,"base64")))},b);process.once("disconnect",()=>this.dispose())}}t.Server=l;class u{constructor(b,D){this.modulePath=b,this.options=D,this.activeRequests=new Set,this.channels=new Map,this._onDidProcessExit=new T.Emitter,this.onDidProcessExit=this._onDidProcessExit.event;const f=D&&D.timeout?D.timeout:6e4;this.disposeDelayer=new E.Delayer(f),this.child=null,this._client=null}getChannel(b){const D=this;return{call(f,r,s){return D.requestPromise(b,f,r,s)},listen(f,r){return D.requestEvent(b,f,r)}}}requestPromise(b,D,f,r=v.CancellationToken.None){if(!this.disposeDelayer)return Promise.reject(new Error("disposed"));if(r.isCancellationRequested)return Promise.reject(p.canceled());this.disposeDelayer.cancel();const s=this.getCachedChannel(b),e=(0,E.createCancelablePromise)(o=>s.call(D,f,o)),i=r.onCancellationRequested(()=>e.cancel()),n=(0,O.toDisposable)(()=>e.cancel());return this.activeRequests.add(n),e.finally(()=>{i.dispose(),this.activeRequests.delete(n),this.activeRequests.size===0&&this.disposeDelayer&&this.disposeDelayer.trigger(()=>this.disposeClient())}),e}requestEvent(b,D,f){if(!this.disposeDelayer)return T.Event.None;this.disposeDelayer.cancel();let r;const s=new T.Emitter({onFirstListenerAdd:()=>{r=this.getCachedChannel(b).listen(D,f)(s.fire,s),this.activeRequests.add(r)},onLastListenerRemove:()=>{this.activeRequests.delete(r),r.dispose(),this.activeRequests.size===0&&this.disposeDelayer&&this.disposeDelayer.trigger(()=>this.disposeClient())}});return s.event}get client(){if(!this._client){const b=this.options&&this.options.args?this.options.args:[],D=Object.create(null);D.env={...(0,I.deepClone)(process.env),VSCODE_PARENT_PID:String(process.pid)},this.options&&this.options.env&&(D.env={...D.env,...this.options.env}),this.options&&this.options.freshExecArgv&&(D.execArgv=[]),this.options&&typeof this.options.debug=="number"&&(D.execArgv=["--nolazy","--inspect="+this.options.debug]),this.options&&typeof this.options.debugBrk=="number"&&(D.execArgv=["--nolazy","--inspect-brk="+this.options.debugBrk]),D.execArgv===void 0&&(D.execArgv=process.execArgv.filter(a=>!/^--inspect(-brk)?=/.test(a))),F.isMacintosh&&D.env&&delete D.env.DYLD_LIBRARY_PATH,this.child=(0,g.fork)(this.modulePath,b,D);const f=new T.Emitter;T.Event.fromNodeEventEmitter(this.child,"message",a=>a)(a=>{if((0,d.isRemoteConsoleLog)(a)){(0,d.log)(a,`IPC Library: ${this.options.serverName}`);return}f.fire(w.VSBuffer.wrap(Buffer.from(a,"base64")))});const s=this.options.useQueue?(0,L.createQueuedSender)(this.child):this.child,e=a=>this.child&&this.child.connected&&s.send(a.buffer.toString("base64")),i=f.event,n={send:e,onMessage:i};this._client=new c.ChannelClient(n);const o=()=>this.disposeClient();process.once("exit",o),this.child.on("error",a=>console.warn('IPC "'+this.options.serverName+'" errored with '+a)),this.child.on("exit",(a,h)=>{process.removeListener("exit",o),this.activeRequests.forEach(m=>(0,O.dispose)(m)),this.activeRequests.clear(),a!==0&&h!=="SIGTERM"&&console.warn('IPC "'+this.options.serverName+'" crashed with exit code '+a+" and signal "+h),this.disposeDelayer&&this.disposeDelayer.cancel(),this.disposeClient(),this._onDidProcessExit.fire({code:a,signal:h})})}return this._client}getCachedChannel(b){let D=this.channels.get(b);return D||(D=this.client.getChannel(b),this.channels.set(b,D)),D}disposeClient(){this._client&&(this.child&&(this.child.kill(),this.child=null),this._client=null,this.channels.clear())}dispose(){this._onDidProcessExit.dispose(),this.disposeDelayer&&(this.disposeDelayer.cancel(),this.disposeDelayer=void 0),this.disposeClient(),this.activeRequests.clear()}}t.Client=u}),define(Z[72],te([5,6]),function(q,t){return q.create("vs/base/node/zip",t)}),define(Z[73],te([5,6]),function(q,t){return q.create("vs/platform/configuration/common/configurationRegistry",t)}),define(Z[74],te([5,6]),function(q,t){return q.create("vs/platform/extensionManagement/common/abstractExtensionManagementService",t)}),define(Z[75],te([5,6]),function(q,t){return q.create("vs/platform/extensionManagement/common/extensionManagement",t)}),define(Z[76],te([5,6]),function(q,t){return q.create("vs/platform/extensionManagement/common/extensionManagementCLIService",t)}),define(Z[77],te([5,6]),function(q,t){return q.create("vs/platform/extensionManagement/node/extensionManagementService",t)}),define(Z[78],te([5,6]),function(q,t){return q.create("vs/platform/extensionManagement/node/extensionManagementUtil",t)}),define(Z[79],te([5,6]),function(q,t){return q.create("vs/platform/extensionManagement/node/extensionsScanner",t)}),define(Z[80],te([5,6]),function(q,t){return q.create("vs/platform/extensions/common/extensionValidator",t)}),define(Z[81],te([5,6]),function(q,t){return q.create("vs/platform/files/common/fileService",t)}),define(Z[82],te([5,6]),function(q,t){return q.create("vs/platform/files/common/io",t)}),define(Z[83],te([5,6]),function(q,t){return q.create("vs/platform/files/node/diskFileSystemProvider",t)}),define(Z[84],te([5,6]),function(q,t){return q.create("vs/platform/request/common/request",t)}),define(Z[85],te([5,6]),function(q,t){return q.create("vs/platform/telemetry/common/telemetryService",t)}),define(Z[86],te([0,1,3,20,44,68,9,7,33]),function(q,t,g,O,E,I,T,L,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSearchPort=t.parseExtensionHostPort=t.AbstractNativeEnvironmentService=void 0;class d{constructor(l,u,R){this._args=l,this.paths=u,this.productService=R}get appRoot(){return(0,g.dirname)(T.FileAccess.asFileUri("",q).fsPath)}get userHome(){return L.URI.file(this.paths.homeDir)}get userDataPath(){return this.paths.userDataDir}get appSettingsHome(){return L.URI.file((0,g.join)(this.userDataPath,"User"))}get tmpDir(){return L.URI.file(this.paths.tmpDir)}get userRoamingDataHome(){return this.appSettingsHome}get settingsResource(){return(0,O.joinPath)(this.userRoamingDataHome,"settings.json")}get userDataSyncHome(){return(0,O.joinPath)(this.userRoamingDataHome,"sync")}get logsPath(){if(!this.args.logsPath){const l=(0,I.toLocalISOString)(new Date).replace(/-|:|\.\d+Z$/g,"");this.args.logsPath=(0,g.join)(this.userDataPath,"logs",l)}return this.args.logsPath}get userDataSyncLogResource(){return L.URI.file((0,g.join)(this.logsPath,"userDataSync.log"))}get sync(){return this.args.sync}get machineSettingsResource(){return(0,O.joinPath)(L.URI.file((0,g.join)(this.userDataPath,"Machine")),"settings.json")}get globalStorageHome(){return L.URI.joinPath(this.appSettingsHome,"globalStorage")}get workspaceStorageHome(){return L.URI.joinPath(this.appSettingsHome,"workspaceStorage")}get keybindingsResource(){return(0,O.joinPath)(this.userRoamingDataHome,"keybindings.json")}get keyboardLayoutResource(){return(0,O.joinPath)(this.userRoamingDataHome,"keyboardLayout.json")}get argvResource(){const l=c.env.VSCODE_PORTABLE;return l?L.URI.file((0,g.join)(l,"argv.json")):(0,O.joinPath)(this.userHome,this.productService.dataFolderName,"argv.json")}get snippetsHome(){return(0,O.joinPath)(this.userRoamingDataHome,"snippets")}get isExtensionDevelopment(){return!!this.args.extensionDevelopmentPath}get untitledWorkspacesHome(){return L.URI.file((0,g.join)(this.userDataPath,"Workspaces"))}get installSourcePath(){return(0,g.join)(this.userDataPath,"installSource")}get builtinExtensionsPath(){const l=this.args["builtin-extensions-dir"];return l?(0,g.resolve)(l):(0,g.normalize)((0,g.join)(T.FileAccess.asFileUri("",q).fsPath,"..","extensions"))}get extensionsDownloadPath(){const l=this.args["extensions-download-dir"];return l?(0,g.resolve)(l):(0,g.join)(this.userDataPath,"CachedExtensionVSIXs")}get extensionsPath(){const l=this.args["extensions-dir"];if(l)return(0,g.resolve)(l);const u=c.env.VSCODE_EXTENSIONS;if(u)return u;const R=c.env.VSCODE_PORTABLE;return R?(0,g.join)(R,"extensions"):(0,O.joinPath)(this.userHome,this.productService.dataFolderName,"extensions").fsPath}get extensionDevelopmentLocationURI(){const l=this.args.extensionDevelopmentPath;if(Array.isArray(l))return l.map(u=>/^[^:/?#]+?:\/\//.test(u)?L.URI.parse(u):L.URI.file((0,g.normalize)(u)))}get extensionDevelopmentKind(){return this.args.extensionDevelopmentKind?.map(l=>l==="ui"||l==="workspace"||l==="web"?l:"workspace")}get extensionTestsLocationURI(){const l=this.args.extensionTestsPath;if(l)return/^[^:/?#]+?:\/\//.test(l)?L.URI.parse(l):L.URI.file((0,g.normalize)(l))}get disableExtensions(){if(this.args["disable-extensions"])return!0;const l=this.args["disable-extension"];if(l){if(typeof l=="string")return[l];if(Array.isArray(l)&&l.length>0)return l}return!1}get debugExtensionHost(){return v(this.args,this.isBuilt)}get debugRenderer(){return!!this.args.debugRenderer}get isBuilt(){return!c.env.VSCODE_DEV}get verbose(){return!!this.args.verbose}get logLevel(){return this.args.log}get serviceMachineIdResource(){return(0,O.joinPath)(L.URI.file(this.userDataPath),"machineid")}get crashReporterId(){return this.args["crash-reporter-id"]}get crashReporterDirectory(){return this.args["crash-reporter-directory"]}get driverHandle(){return this.args.driver}get telemetryLogResource(){return L.URI.file((0,g.join)(this.logsPath,"telemetry.log"))}get disableTelemetry(){return!!this.args["disable-telemetry"]}get disableWorkspaceTrust(){return!!this.args["disable-workspace-trust"]}get args(){return this._args}}ue([E.memoize],d.prototype,"appRoot",null),ue([E.memoize],d.prototype,"userHome",null),ue([E.memoize],d.prototype,"userDataPath",null),ue([E.memoize],d.prototype,"appSettingsHome",null),ue([E.memoize],d.prototype,"tmpDir",null),ue([E.memoize],d.prototype,"userRoamingDataHome",null),ue([E.memoize],d.prototype,"settingsResource",null),ue([E.memoize],d.prototype,"userDataSyncHome",null),ue([E.memoize],d.prototype,"userDataSyncLogResource",null),ue([E.memoize],d.prototype,"sync",null),ue([E.memoize],d.prototype,"machineSettingsResource",null),ue([E.memoize],d.prototype,"globalStorageHome",null),ue([E.memoize],d.prototype,"workspaceStorageHome",null),ue([E.memoize],d.prototype,"keybindingsResource",null),ue([E.memoize],d.prototype,"keyboardLayoutResource",null),ue([E.memoize],d.prototype,"argvResource",null),ue([E.memoize],d.prototype,"snippetsHome",null),ue([E.memoize],d.prototype,"isExtensionDevelopment",null),ue([E.memoize],d.prototype,"untitledWorkspacesHome",null),ue([E.memoize],d.prototype,"installSourcePath",null),ue([E.memoize],d.prototype,"builtinExtensionsPath",null),ue([E.memoize],d.prototype,"extensionsPath",null),ue([E.memoize],d.prototype,"extensionDevelopmentLocationURI",null),ue([E.memoize],d.prototype,"extensionDevelopmentKind",null),ue([E.memoize],d.prototype,"extensionTestsLocationURI",null),ue([E.memoize],d.prototype,"debugExtensionHost",null),ue([E.memoize],d.prototype,"serviceMachineIdResource",null),ue([E.memoize],d.prototype,"telemetryLogResource",null),ue([E.memoize],d.prototype,"disableWorkspaceTrust",null),t.AbstractNativeEnvironmentService=d;function v(F,l){return w(F["inspect-extensions"],F["inspect-brk-extensions"],5870,l,F.debugId)}t.parseExtensionHostPort=v;function p(F,l){return w(F["inspect-search"],F["inspect-brk-search"],5876,l)}t.parseSearchPort=p;function w(F,l,u,R,b){const f=Number(l||F)||(R?null:u),r=f?Boolean(!!l):!1;return{port:f,break:r,debugId:b}}}),function(){"use strict";function q(t,g,O,E){function I(L){const c=T(L),d=[c];return t.isAbsolute(c)||d.unshift(E),t.resolve(...d)}function T(L){const c=process.env.VSCODE_PORTABLE;if(c)return t.join(c,"user-data");let d=process.env.VSCODE_APPDATA;if(d)return t.join(d,O);const v=L["user-data-dir"];if(v)return v;switch(process.platform){case"win32":if(d=process.env.APPDATA,!d){const p=process.env.USERPROFILE;if(typeof p!="string")throw new Error("Windows: Unexpected undefined %USERPROFILE% environment variable");d=t.join(p,"AppData","Roaming")}break;case"darwin":d=t.join(g.homedir(),"Library","Application Support");break;case"linux":d=process.env.XDG_CONFIG_HOME||t.join(g.homedir(),".config");break;default:throw new Error("Platform not supported")}return t.join(d,O)}return{getUserDataPath:I}}if(typeof define=="function")define(Z[87],te([0,88,31,9,20,33]),function(t,g,O,E,I,T){const L=I.dirname(E.FileAccess.asFileUri("",t)),c=t.__$__nodeRequire(I.joinPath(L,"package.json").fsPath);return q(g,O,c.name,T.cwd())});else if(typeof module=="object"&&typeof module.exports=="object"){const t=require("../../../../../package.json"),g=require("path"),O=require("os");module.exports=q(g,O,t.name,process.env.VSCODE_CWD||process.cwd())}else throw new Error("Unknown context")}(),define(Z[89],te([0,1,31,87,86]),function(q,t,g,O,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NativeEnvironmentService=void 0;class I extends E.AbstractNativeEnvironmentService{constructor(L,c){super(L,{homeDir:(0,g.homedir)(),tmpDir:(0,g.tmpdir)(),userDataDir:(0,O.getUserDataPath)(L)},c)}}t.NativeEnvironmentService=I}),define(Z[90],te([0,1,19]),function(q,t,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.localizeManifest=void 0;const O=/^%([\w\d.-]+)%$/i;function E(I,T){const L=c=>{if(typeof c!="string")return;const d=O.exec(c);if(!d)return;const v=T[d[1]]??c;return typeof v=="string"?v:typeof v.message=="string"?v.message:c};return(0,g.cloneAndChange)(I,L)}t.localizeManifest=E}),define(Z[49],te([0,1,80]),function(q,t,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEngineValid=t.isValidExtensionVersion=t.isValidVersion=t.normalizeVersion=t.parseVersion=t.isValidVersionStr=void 0;const O=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/,E=/^-(\d{4})(\d{2})(\d{2})$/;function I(w){return w=w.trim(),w==="*"||O.test(w)}t.isValidVersionStr=I;function T(w){if(!I(w))return null;if(w=w.trim(),w==="*")return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};let F=w.match(O);return F?{hasCaret:F[1]==="^",hasGreaterEquals:F[1]===">=",majorBase:F[2]==="x"?0:parseInt(F[2],10),majorMustEqual:F[2]!=="x",minorBase:F[4]==="x"?0:parseInt(F[4],10),minorMustEqual:F[4]!=="x",patchBase:F[6]==="x"?0:parseInt(F[6],10),patchMustEqual:F[6]!=="x",preRelease:F[8]||null}:null}t.parseVersion=T;function L(w){if(!w)return null;let F=w.majorBase,l=w.majorMustEqual,u=w.minorBase,R=w.minorMustEqual,b=w.patchBase,D=w.patchMustEqual;w.hasCaret&&(F===0||(R=!1),D=!1);let f=0;if(w.preRelease){const r=E.exec(w.preRelease);if(r){const[,s,e,i]=r;f=Date.UTC(Number(s),Number(e)-1,Number(i))}}return{majorBase:F,majorMustEqual:l,minorBase:u,minorMustEqual:R,patchBase:b,patchMustEqual:D,isMinimum:w.hasGreaterEquals,notBefore:f}}t.normalizeVersion=L;function c(w,F,l){let u;typeof w=="string"?u=L(T(w)):u=w;let R;F instanceof Date?R=F.getTime():typeof F=="string"&&(R=new Date(F).getTime());let b;if(typeof l=="string"?b=L(T(l)):b=l,!u||!b)return!1;let D=u.majorBase,f=u.minorBase,r=u.patchBase,s=b.majorBase,e=b.minorBase,i=b.patchBase,n=b.notBefore,o=b.majorMustEqual,a=b.minorMustEqual,h=b.patchMustEqual;return b.isMinimum?D>s?!0:D<s?!1:f>e?!0:f<e||R&&R<n?!1:r>=i:(D===1&&s===0&&(!o||!a||!h)&&(s=1,e=0,i=0,o=!0,a=!1,h=!1),D<s?!1:D>s?!o:f<e?!1:f>e?!a:r<i?!1:r>i?!h:!(R&&R<n))}t.isValidVersion=c;function d(w,F,l,u){return l.isBuiltin||typeof l.main=="undefined"?!0:p(w,F,l.engines.vscode,u)}t.isValidExtensionVersion=d;function v(w,F,l){return w==="*"||p(F,l,w)}t.isEngineValid=v;function p(w,F,l,u=[]){let R=L(T(l));if(!R)return u.push(g.localize(0,null,l)),!1;if(R.majorBase===0){if(!R.majorMustEqual||!R.minorMustEqual)return u.push(g.localize(1,null,l)),!1}else if(!R.majorMustEqual)return u.push(g.localize(2,null,l)),!1;return c(w,F,R)?!0:(u.push(g.localize(3,null,w,l)),!1)}}),define(Z[91],te([0,1,39,48,2,9]),function(q,t,g,O,E,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileWatcher=void 0;class T extends E.Disposable{constructor(c,d,v,p){super();this.folders=c,this.onDidFilesChange=d,this.onLogMessage=v,this.verboseLogging=p,this.isDisposed=!1,this.restartCounter=0,this.startWatching()}startWatching(){const c=this._register(new O.Client(I.FileAccess.asFileUri("bootstrap-fork",q).fsPath,{serverName:"File Watcher (nsfw)",args:["--type=watcherService"],env:{VSCODE_AMD_ENTRYPOINT:"vs/platform/files/node/watcher/nsfw/watcherApp",VSCODE_PIPE_LOGGING:"true",VSCODE_VERBOSE_LOGGING:"true"}}));this._register(c.onDidProcessExit(()=>{this.isDisposed||(this.restartCounter<=T.MAX_RESTARTS?(this.error("terminated unexpectedly and is restarted again..."),this.restartCounter++,this.startWatching()):this.error("failed to start after retrying for some time, giving up. Please report this as a bug report!"))})),this.service=g.ProxyChannel.toService((0,g.getNextTickChannel)(c.getChannel("watcher"))),this.service.setVerboseLogging(this.verboseLogging),this._register(this.service.onDidChangeFile(d=>!this.isDisposed&&this.onDidFilesChange(d))),this._register(this.service.onDidLogMessage(d=>this.onLogMessage(d))),this.setFolders(this.folders)}setVerboseLogging(c){this.verboseLogging=c,!this.isDisposed&&this.service&&this.service.setVerboseLogging(c)}error(c){this.onLogMessage({type:"error",message:`[File Watcher (nsfw)] ${c}`})}setFolders(c){this.folders=c,this.service&&this.service.setRoots(c)}dispose(){this.isDisposed=!0,super.dispose()}}t.FileWatcher=T,T.MAX_RESTARTS=5}),define(Z[92],te([0,1,39,48,2,9]),function(q,t,g,O,E,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileWatcher=void 0;class T extends E.Disposable{constructor(c,d,v,p,w={}){super();this.folders=c,this.onDidFilesChange=d,this.onLogMessage=v,this.verboseLogging=p,this.watcherOptions=w,this.isDisposed=!1,this.restartCounter=0,this.startWatching()}startWatching(){const c=this._register(new O.Client(I.FileAccess.asFileUri("bootstrap-fork",q).fsPath,{serverName:"File Watcher (chokidar)",args:["--type=watcherService"],env:{VSCODE_AMD_ENTRYPOINT:"vs/platform/files/node/watcher/unix/watcherApp",VSCODE_PIPE_LOGGING:"true",VSCODE_VERBOSE_LOGGING:"true"}}));this._register(c.onDidProcessExit(()=>{this.isDisposed||(this.restartCounter<=T.MAX_RESTARTS?(this.error("terminated unexpectedly and is restarted again..."),this.restartCounter++,this.startWatching()):this.error("failed to start after retrying for some time, giving up. Please report this as a bug report!"))})),this.service=g.ProxyChannel.toService((0,g.getNextTickChannel)(c.getChannel("watcher"))),this.service.init({...this.watcherOptions,verboseLogging:this.verboseLogging}),this._register(this.service.onDidChangeFile(d=>!this.isDisposed&&this.onDidFilesChange(d))),this._register(this.service.onDidLogMessage(d=>this.onLogMessage(d))),this.service.setRoots(this.folders)}error(c){this.onLogMessage({type:"error",message:`[File Watcher (chokidar)] ${c}`})}setVerboseLogging(c){this.verboseLogging=c,this.service&&this.service.setVerboseLogging(c)}setFolders(c){this.folders=c,this.service&&this.service.setRoots(c)}dispose(){this.isDisposed=!0,super.dispose()}}t.FileWatcher=T,T.MAX_RESTARTS=5}),define(Z[93],te([0,1,32,46,61,9]),function(q,t,g,O,E,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutOfProcessWin32FolderWatcher=void 0;class T{constructor(c,d,v,p,w){this.watchedFolder=c,this.eventCallback=v,this.logCallback=p,this.verboseLogging=w,this.restartCounter=0,Array.isArray(d)?this.ignored=d.map(F=>(0,E.parse)(F)):this.ignored=[],this.verboseLogging&&this.log(`Start watching: ${c}, excludes: ${d.join(",")}`),this.startWatcher()}startWatcher(){const c=[this.watchedFolder];this.verboseLogging&&c.push("-verbose"),this.handle=(0,g.spawn)(I.FileAccess.asFileUri("vs/platform/files/node/watcher/win32/CodeHelper.exe",q).fsPath,c);const d=new O.LineDecoder;this.handle.stdout.on("data",v=>{const p=[];for(const w of d.write(v)){const F=w.split("|");if(F.length===2){const l=Number(F[0]),u=F[1];if(l>=0&&l<3){if(this.ignored&&this.ignored.some(R=>R(u))){this.verboseLogging&&this.log(u);continue}p.push({type:T.changeTypeMap[l],path:u})}else this.log(F[1])}}p.length>0&&this.eventCallback(p)}),this.handle.on("error",v=>this.onError(v)),this.handle.stderr.on("data",v=>this.onError(v)),this.handle.on("exit",(v,p)=>this.onExit(v,p))}onError(c){this.error("process error: "+c.toString())}onExit(c,d){this.handle&&(this.error(`terminated unexpectedly (code: ${c}, signal: ${d})`),this.restartCounter<=T.MAX_RESTARTS?(this.error("is restarted again..."),this.restartCounter++,this.startWatcher()):this.error("Watcher failed to start after retrying for some time, giving up. Please report this as a bug report!"))}error(c){this.logCallback({type:"error",message:`[File Watcher (C#)] ${c}`})}log(c){this.logCallback({type:"trace",message:`[File Watcher (C#)] ${c}`})}dispose(){this.handle&&(this.handle.kill(),this.handle=void 0)}}t.OutOfProcessWin32FolderWatcher=T,T.MAX_RESTARTS=5,T.changeTypeMap=[0,1,2]}),define(Z[94],te([0,1,93,3,18]),function(q,t,g,O,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileWatcher=void 0;class I{constructor(L,c,d,v){this.onDidFilesChange=c,this.onLogMessage=d,this.verboseLogging=v,this.service=void 0,this.folder=L[0],this.folder.path.indexOf("\\\\")===0&&this.folder.path.endsWith(O.posix.sep)&&(this.folder.path=(0,E.rtrim)(this.folder.path,O.posix.sep)),this.service=this.startWatching()}get isDisposed(){return!this.service}startWatching(){return new g.OutOfProcessWin32FolderWatcher(this.folder.path,this.folder.excludes,L=>this.onFileEvents(L),L=>this.onLogMessage(L),this.verboseLogging)}setVerboseLogging(L){this.verboseLogging=L,this.service&&(this.service.dispose(),this.service=this.startWatching())}onFileEvents(L){this.isDisposed||L.length>0&&this.onDidFilesChange(L)}dispose(){this.service&&(this.service.dispose(),this.service=void 0)}}t.FileWatcher=I}),define(Z[50],te([0,1]),function(q,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncDescriptor=void 0;class g{constructor(E,I=[],T=!1){this.ctor=E,this.staticArguments=I,this.supportsDelayedInstantiation=T}}t.SyncDescriptor=g}),define(Z[95],te([0,1]),function(q,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Graph=t.Node=void 0;class g{constructor(I){this.incoming=new Map,this.outgoing=new Map,this.data=I}}t.Node=g;class O{constructor(I){this._hashFn=I,this._nodes=new Map}roots(){const I=[];for(let T of this._nodes.values())T.outgoing.size===0&&I.push(T);return I}insertEdge(I,T){const L=this.lookupOrInsertNode(I),c=this.lookupOrInsertNode(T);L.outgoing.set(this._hashFn(T),c),c.incoming.set(this._hashFn(I),L)}removeNode(I){const T=this._hashFn(I);this._nodes.delete(T);for(let L of this._nodes.values())L.outgoing.delete(T),L.incoming.delete(T)}lookupOrInsertNode(I){const T=this._hashFn(I);let L=this._nodes.get(T);return L||(L=new g(I),this._nodes.set(T,L)),L}lookup(I){return this._nodes.get(this._hashFn(I))}isEmpty(){return this._nodes.size===0}toString(){let I=[];for(let[T,L]of this._nodes)I.push(`${T}, (incoming)[${[...L.incoming.keys()].join(", ")}], (outgoing)[${[...L.outgoing.keys()].join(",")}]`);return I.join(`
`)}findCycleSlow(){for(let[I,T]of this._nodes){const L=new Set([I]),c=this._findCycle(T,L);if(c)return c}}_findCycle(I,T){for(let[L,c]of I.outgoing){if(T.has(L))return[...T,L].join(" -> ");T.add(L);const d=this._findCycle(c,T);if(d)return d;T.delete(L)}}}t.Graph=O}),define(Z[96],te([0,1,12]),function(q,t,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IDownloadService=void 0,t.IDownloadService=(0,g.createDecorator)("downloadService")}),define(Z[21],te([0,1,12]),function(q,t,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INativeEnvironmentService=t.IEnvironmentService=void 0,t.IEnvironmentService=(0,g.createDecorator)("environmentService"),t.INativeEnvironmentService=(0,g.refineServiceDecorator)(t.IEnvironmentService)}),define(Z[22],te([0,1,75,12,9]),function(q,t,g,O,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IExtensionManagementCLIService=t.PreferencesLocalizedLabel=t.PreferencesLabel=t.ExtensionsChannelId=t.ExtensionsLocalizedLabel=t.ExtensionsLabel=t.DefaultIconPath=t.IExtensionTipsService=t.IGlobalExtensionEnablementService=t.ENABLED_EXTENSIONS_STORAGE_PATH=t.DISABLED_EXTENSIONS_STORAGE_PATH=t.IExtensionManagementService=t.ExtensionManagementError=t.INSTALL_ERROR_INCOMPATIBLE=t.INSTALL_ERROR_MALICIOUS=t.INSTALL_ERROR_NOT_SUPPORTED=t.IExtensionGalleryService=t.InstallOperation=t.StatisticType=t.SortOrder=t.SortBy=t.isIExtensionIdentifier=t.WEB_EXTENSION_TAG=t.EXTENSION_IDENTIFIER_REGEX=t.EXTENSION_IDENTIFIER_PATTERN=void 0,t.EXTENSION_IDENTIFIER_PATTERN="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$",t.EXTENSION_IDENTIFIER_REGEX=new RegExp(t.EXTENSION_IDENTIFIER_PATTERN),t.WEB_EXTENSION_TAG="__web_extension";function I(p){return p&&typeof p=="object"&&typeof p.id=="string"&&(!p.uuid||typeof p.uuid=="string")}t.isIExtensionIdentifier=I;var T;(function(p){p[p.NoneOrRelevance=0]="NoneOrRelevance",p[p.LastUpdatedDate=1]="LastUpdatedDate",p[p.Title=2]="Title",p[p.PublisherName=3]="PublisherName",p[p.InstallCount=4]="InstallCount",p[p.PublishedDate=5]="PublishedDate",p[p.AverageRating=6]="AverageRating",p[p.WeightedRating=12]="WeightedRating"})(T=t.SortBy||(t.SortBy={}));var L;(function(p){p[p.Default=0]="Default",p[p.Ascending=1]="Ascending",p[p.Descending=2]="Descending"})(L=t.SortOrder||(t.SortOrder={}));var c;(function(p){p.Install="install",p.Uninstall="uninstall"})(c=t.StatisticType||(t.StatisticType={}));var d;(function(p){p[p.None=0]="None",p[p.Install=1]="Install",p[p.Update=2]="Update"})(d=t.InstallOperation||(t.InstallOperation={})),t.IExtensionGalleryService=(0,O.createDecorator)("extensionGalleryService"),t.INSTALL_ERROR_NOT_SUPPORTED="notsupported",t.INSTALL_ERROR_MALICIOUS="malicious",t.INSTALL_ERROR_INCOMPATIBLE="incompatible";class v extends Error{constructor(w,F){super(w);this.code=F,this.name=F}}t.ExtensionManagementError=v,t.IExtensionManagementService=(0,O.createDecorator)("extensionManagementService"),t.DISABLED_EXTENSIONS_STORAGE_PATH="extensionsIdentifiers/disabled",t.ENABLED_EXTENSIONS_STORAGE_PATH="extensionsIdentifiers/enabled",t.IGlobalExtensionEnablementService=(0,O.createDecorator)("IGlobalExtensionEnablementService"),t.IExtensionTipsService=(0,O.createDecorator)("IExtensionTipsService"),t.DefaultIconPath=E.FileAccess.asBrowserUri("./media/defaultIcon.png",q).toString(!0),t.ExtensionsLabel=(0,g.localize)(0,null),t.ExtensionsLocalizedLabel={value:t.ExtensionsLabel,original:"Extensions"},t.ExtensionsChannelId="extensions",t.PreferencesLabel=(0,g.localize)(1,null),t.PreferencesLocalizedLabel={value:t.PreferencesLabel,original:"Preferences"},t.IExtensionManagementCLIService=(0,O.createDecorator)("IExtensionManagementCLIService")}),define(Z[40],te([0,1,18,12]),function(q,t,g,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IBuiltinExtensionsScannerService=t.isAuthenticaionProviderExtension=t.isLanguagePackExtension=t.ExtensionIdentifier=t.ExtensionType=t.EXTENSION_CATEGORIES=t.isIExtensionIdentifier=t.getWorkspaceSupportTypeMessage=t.ALL_EXTENSION_KINDS=t.BUILTIN_MANIFEST_CACHE_FILE=t.USER_MANIFEST_CACHE_FILE=t.MANIFEST_CACHE_FOLDER=void 0,t.MANIFEST_CACHE_FOLDER="CachedExtensions",t.USER_MANIFEST_CACHE_FILE="user",t.BUILTIN_MANIFEST_CACHE_FILE="builtin",t.ALL_EXTENSION_KINDS=["ui","workspace","web"];function E(v){if(typeof v=="object"&&v!==null&&v.supported!==!0)return v.description}t.getWorkspaceSupportTypeMessage=E;function I(v){return v&&typeof v=="object"&&typeof v.id=="string"&&(!v.uuid||typeof v.uuid=="string")}t.isIExtensionIdentifier=I,t.EXTENSION_CATEGORIES=["Azure","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"];var T;(function(v){v[v.System=0]="System",v[v.User=1]="User"})(T=t.ExtensionType||(t.ExtensionType={}));class L{constructor(p){this.value=p,this._lower=p.toLowerCase()}static equals(p,w){if(typeof p=="undefined"||p===null)return typeof w=="undefined"||w===null;if(typeof w=="undefined"||w===null)return!1;if(typeof p=="string"||typeof w=="string"){let F=typeof p=="string"?p:p.value,l=typeof w=="string"?w:w.value;return g.equalsIgnoreCase(F,l)}return p._lower===w._lower}static toKey(p){return typeof p=="string"?p.toLowerCase():p._lower}}t.ExtensionIdentifier=L;function c(v){return v.contributes&&v.contributes.localizations?v.contributes.localizations.length>0:!1}t.isLanguagePackExtension=c;function d(v){return v.contributes&&v.contributes.authentication?v.contributes.authentication.length>0:!1}t.isAuthenticaionProviderExtension=d,t.IBuiltinExtensionsScannerService=(0,O.createDecorator)("IBuiltinExtensionsScannerService")}),define(Z[23],te([0,1,18,40]),function(q,t,g,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExtensionDependencies=t.getMaliciousExtensionsSet=t.BetterMergeId=t.getGalleryExtensionTelemetryData=t.getLocalExtensionTelemetryData=t.groupByExtension=t.getGalleryExtensionId=t.adoptToGalleryExtensionId=t.getExtensionId=t.ExtensionIdentifierWithVersion=t.areSameExtensions=void 0;function E(l,u){return l.uuid&&u.uuid?l.uuid===u.uuid:l.id===u.id?!0:(0,g.compareIgnoreCase)(l.id,u.id)===0}t.areSameExtensions=E;class I{constructor(u,R){this.version=R,this.id=u.id,this.uuid=u.uuid}key(){return`${this.id}-${this.version}`}equals(u){return u instanceof I?E(this,u)&&this.version===u.version:!1}}t.ExtensionIdentifierWithVersion=I;function T(l,u){return`${l}.${u}`}t.getExtensionId=T;function L(l){return l.toLocaleLowerCase()}t.adoptToGalleryExtensionId=L;function c(l,u){return L(T(l,u))}t.getGalleryExtensionId=c;function d(l,u){const R=[],b=D=>{for(const f of R)if(f.some(r=>E(u(r),u(D))))return f;return null};for(const D of l){const f=b(D);f?f.push(D):R.push([D])}return R}t.groupByExtension=d;function v(l){return{id:l.identifier.id,name:l.manifest.name,galleryId:null,publisherId:l.publisherId,publisherName:l.manifest.publisher,publisherDisplayName:l.publisherDisplayName,dependencies:l.manifest.extensionDependencies&&l.manifest.extensionDependencies.length>0}}t.getLocalExtensionTelemetryData=v;function p(l){return{id:l.identifier.id,name:l.name,galleryId:l.identifier.uuid,publisherId:l.publisherId,publisherName:l.publisher,publisherDisplayName:l.publisherDisplayName,dependencies:!!(l.properties.dependencies&&l.properties.dependencies.length>0),...l.telemetryData}}t.getGalleryExtensionTelemetryData=p,t.BetterMergeId=new O.ExtensionIdentifier("pprice.better-merge");function w(l){const u=new Set;for(const R of l)R.malicious&&u.add(R.id.id);return u}t.getMaliciousExtensionsSet=w;function F(l,u){const R=[],b=u.manifest.extensionDependencies?.slice(0)??[];for(;b.length;){const D=b.shift();if(D&&R.every(f=>!E(f.identifier,{id:D}))){const f=l.filter(r=>E(r.identifier,{id:D}));f.length===1&&(R.push(f[0]),b.push(...f[0].manifest.extensionDependencies?.slice(0)??[]))}}return R}t.getExtensionDependencies=F});var fe=this&&this.__param||function(q,t){return function(g,O){t(g,O,q)}};define(Z[97],te([0,1,76,8,7,41,22,23,40,62,26,9]),function(q,t,g,O,E,I,T,L,c,d,v,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionManagementCLIService=t.getIdAndVersion=void 0;const w=D=>(0,g.localize)(0,null,D),F=(0,g.localize)(1,null,"ms-dotnettools.csharp");function l(D,f){return f?`${D.publisher}.${D.name}@${D.version}`:`${D.publisher}.${D.name}`}const u=/^([^.]+\..+)@(\d+\.\d+\.\d+(-.*)?)$/;function R(D){const f=u.exec(D);return f&&f[1]?[(0,L.adoptToGalleryExtensionId)(f[1]),f[2]]:[(0,L.adoptToGalleryExtensionId)(D),void 0]}t.getIdAndVersion=R;let b=class{constructor(f,r){this.extensionManagementService=f,this.extensionGalleryService=r}get location(){}async listExtensions(f,r,s=console){let e=await this.extensionManagementService.getInstalled(1);const i=c.EXTENSION_CATEGORIES.map(o=>o.toLowerCase());if(r&&r!==""){if(i.indexOf(r.toLowerCase())<0){s.log("Invalid category please enter a valid category. To list valid categories run --category without a category specified");return}e=e.filter(o=>o.manifest.categories?o.manifest.categories.map(h=>h.toLowerCase()).indexOf(r.toLowerCase())>-1:!1)}else if(r===""){s.log("Possible Categories: "),i.forEach(o=>{s.log(o)});return}this.location&&s.log((0,g.localize)(2,null,this.location)),e=e.sort((o,a)=>o.identifier.id.localeCompare(a.identifier.id));let n;for(let o of e)n!==o.identifier.id&&(n=o.identifier.id,s.log(l(o.manifest,f)))}async installExtensions(f,r,s,e,i=console){const n=[],o=[];f.length&&i.log(this.location?(0,g.localize)(3,null,this.location):(0,g.localize)(4,null));const a=await this.extensionManagementService.getInstalled(1),h=(P,N)=>{const x=a.find(_=>(0,L.areSameExtensions)(_.identifier,{id:P}));if(x){if(!N&&!e)return i.log((0,g.localize)(5,null,P,x.manifest.version,P)),!1;if(N&&x.manifest.version===N)return i.log((0,g.localize)(6,null,`${P}@${N}`)),!1}return!0},m=[],k=[];for(const P of f)if(P instanceof E.URI)m.push(P);else{const[N,x]=R(P);h(N,x)&&k.push({id:N,version:x,installOptions:{isBuiltin:!1,isMachineScoped:s}})}for(const P of r){const[N,x]=R(P);h(N,x)&&k.push({id:N,version:x,installOptions:{isBuiltin:!0,isMachineScoped:!1}})}if(m.length&&await Promise.all(m.map(async P=>{try{const N=await this.installVSIX(P,{isBuiltin:!1,isMachineScoped:s},e,i);N&&o.push(N)}catch(N){i.error(N.message||N.stack||N),n.push(P.toString())}})),k.length){const P=await this.getGalleryExtensions(k);await Promise.all(k.map(async N=>{const x=P.get(N.id.toLowerCase());if(x)try{const _=await this.installFromGallery(N,x,a,e,i);_&&o.push(_)}catch(_){i.error(_.message||_.stack||_),n.push(N.id)}else i.error(`${w(N.version?`${N.id}@${N.version}`:N.id)}
${F}`),n.push(N.id)}))}if(n.length)throw new Error((0,g.localize)(7,null,n.join(", ")))}async installVSIX(f,r,s,e){const i=await this.extensionManagementService.getManifest(f);if(!i)throw new Error("Invalid vsix");if(await this.validateVSIX(i,s,e))try{return await this.extensionManagementService.install(f,r),e.log((0,g.localize)(8,null,(0,d.getBaseLabel)(f))),i}catch(o){if((0,O.isPromiseCanceledError)(o))return e.log((0,g.localize)(9,null,(0,d.getBaseLabel)(f))),null;throw o}return null}async getGalleryExtensions(f){const r=f.filter(({version:i})=>i===void 0).map(({id:i})=>i),s=f.filter(({version:i})=>i!==void 0),e=new Map;return await Promise.all([(async()=>{(await this.extensionGalleryService.getExtensions(r,v.CancellationToken.None)).forEach(n=>e.set(n.identifier.id.toLowerCase(),n))})(),Promise.all(s.map(async({id:i,version:n})=>{const o=await this.extensionGalleryService.getCompatibleExtension({id:i},n);o&&e.set(o.identifier.id.toLowerCase(),o)}))]),e}async installFromGallery({id:f,version:r,installOptions:s},e,i,n,o){const a=await this.extensionGalleryService.getManifest(e,v.CancellationToken.None);if(a&&!this.validateExtensionKind(a,o))return null;const h=i.find(m=>(0,L.areSameExtensions)(m.identifier,e.identifier));if(h){if(e.version===h.manifest.version)return o.log((0,g.localize)(10,null,r?`${f}@${r}`:f)),null;o.log((0,g.localize)(11,null,f,e.version))}try{return s.isBuiltin?o.log(r?(0,g.localize)(12,null,f,r):(0,g.localize)(13,null,f)):o.log(r?(0,g.localize)(14,null,f,r):(0,g.localize)(15,null,f)),await this.extensionManagementService.installFromGallery(e,s),o.log((0,g.localize)(16,null,f,e.version)),a}catch(m){if((0,O.isPromiseCanceledError)(m))return o.log((0,g.localize)(17,null,f)),null;throw m}}validateExtensionKind(f,r){return!0}async validateVSIX(f,r,s){const e={id:(0,L.getGalleryExtensionId)(f.publisher,f.name)},n=(await this.extensionManagementService.getInstalled(1)).find(o=>(0,L.areSameExtensions)(e,o.identifier)&&(0,I.gt)(o.manifest.version,f.version));return n&&!r?(s.log((0,g.localize)(18,null,n.identifier.id,n.manifest.version,f.version)),!1):this.validateExtensionKind(f,s)}async uninstallExtensions(f,r,s=console){const e=async n=>{if(n instanceof E.URI){const o=await this.extensionManagementService.getManifest(n);return l(o)}return n},i=[];for(const n of f){const o=await e(n),h=(await this.extensionManagementService.getInstalled()).filter(m=>(0,L.areSameExtensions)(m.identifier,{id:o}));if(!h.length)throw new Error(`${this.notInstalled(o)}
${F}`);if(h.some(m=>m.type===0)){s.log((0,g.localize)(19,null,o));return}if(!r&&h.some(m=>m.isBuiltin)){s.log((0,g.localize)(20,null,o));return}s.log((0,g.localize)(21,null,o));for(const m of h)await this.extensionManagementService.uninstall(m),i.push(m);this.location?s.log((0,g.localize)(22,null,o,this.location)):s.log((0,g.localize)(23,null,o))}}async locateExtension(f,r=console){const s=await this.extensionManagementService.getInstalled();f.forEach(e=>{s.forEach(i=>{if(i.identifier.id===e&&i.location.scheme===p.Schemas.file){r.log(i.location.fsPath);return}})})}notInstalled(f){return this.location?(0,g.localize)(24,null,f,this.location):(0,g.localize)(25,null,f)}};b=ue([fe(0,T.IExtensionManagementService),fe(1,T.IExtensionGalleryService)],b),t.ExtensionManagementCLIService=b}),define(Z[98],te([0,1,2,3,40,11]),function(q,t,g,O,E,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsManifestCache=void 0;class T extends g.Disposable{constructor(c,d){super();this.environmentService=c,this.extensionsManifestCache=(0,O.join)(this.environmentService.userDataPath,E.MANIFEST_CACHE_FOLDER,E.USER_MANIFEST_CACHE_FILE),this._register(d.onDidInstallExtensions(v=>this.onDidInstallExtensions(v))),this._register(d.onDidUninstallExtension(v=>this.onDidUnInstallExtension(v)))}onDidInstallExtensions(c){c.some(d=>!!d.local)&&this.invalidate()}onDidUnInstallExtension(c){c.error||this.invalidate()}invalidate(){I.Promises.rm(this.extensionsManifestCache,I.RimRafMode.MOVE).then(()=>{},()=>{})}}t.ExtensionsManifestCache=T}),define(Z[99],te([0,1,88,32,29,10,128,28,71,26,8]),function(q,t,g,O,E,I,T,L,c,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveShellEnv=void 0;async function p(l,u,R){return u["force-disable-user-env"]?(l.trace("resolveShellEnv(): skipped (--force-disable-user-env)"),{}):I.isWindows?(l.trace("resolveShellEnv(): skipped (Windows)"),{}):(0,T.isLaunchedFromCli)(R)&&!u["force-user-env"]?(l.trace("resolveShellEnv(): skipped (VSCODE_CLI is set)"),{}):((0,T.isLaunchedFromCli)(R)?l.trace("resolveShellEnv(): running (--force-user-env)"):l.trace("resolveShellEnv(): running (macOS/Linux)"),w||(w=new Promise(async b=>{const D=new d.CancellationTokenSource,f=setTimeout(()=>{l.error("[resolve shell env] Could not resolve shell environment within 10 seconds. Proceeding without shell environment..."),D.dispose(!0),b({})},1e4);try{const r=await F(l,D.token);b(r)}catch(r){(0,v.isPromiseCanceledError)(r)||l.error(`[resolve shell env] Unable to resolve shell environment (${r}). Proceeding without shell environment...`),b({})}finally{clearTimeout(f),D.dispose()}})),w)}t.resolveShellEnv=p;let w;async function F(l,u){const R=new Promise(async(b,D)=>{const f=process.env.ELECTRON_RUN_AS_NODE;l.trace("getUnixShellEnvironment#runAsNode",f);const r=process.env.ELECTRON_NO_ATTACH_CONSOLE;l.trace("getUnixShellEnvironment#noAttach",r);const s=(0,E.generateUuid)().replace(/-/g,"").substr(0,12),e=new RegExp(s+"(.*)"+s),i={...process.env,ELECTRON_RUN_AS_NODE:"1",ELECTRON_NO_ATTACH_CONSOLE:"1"};l.trace("getUnixShellEnvironment#env",i);const n=await(0,c.getSystemShell)(I.OS,i);if(l.trace("getUnixShellEnvironment#shell",n),u.isCancellationRequested)return D(v.canceled);const o=g.basename(n);let a,h;/^pwsh(-preview)?$/.test(o)?(a=`& '${process.execPath}' -p '''${s}'' + JSON.stringify(process.env) + ''${s}'''`,h=["-Login","-Command"]):(a=`'${process.execPath}' -p '"${s}" + JSON.stringify(process.env) + "${s}"'`,h=["-ilc"]),l.trace("getUnixShellEnvironment#spawn",JSON.stringify(h),a);const m=(0,O.spawn)(n,[...h,a],{detached:!0,stdio:["ignore","pipe","pipe"],env:i});u.onCancellationRequested(()=>(m.kill(),D(v.canceled))),m.on("error",N=>{l.error("getUnixShellEnvironment#errorChildProcess",(0,L.toErrorMessage)(N)),b({})});const k=[];m.stdout.on("data",N=>k.push(N));const P=[];m.stderr.on("data",N=>P.push(N)),m.on("close",(N,x)=>{const _=Buffer.concat(k).toString("utf8");l.trace("getUnixShellEnvironment#raw",_);const J=Buffer.concat(P).toString("utf8");if(J.trim()&&l.trace("getUnixShellEnvironment#stderr",J),N||x)return D(new Error(`Failed to get environment (code ${N}, signal ${x})`));const ie=e.exec(_),se=ie?ie[1]:"{}";try{const Y=JSON.parse(se);f?Y.ELECTRON_RUN_AS_NODE=f:delete Y.ELECTRON_RUN_AS_NODE,r?Y.ELECTRON_NO_ATTACH_CONSOLE=r:delete Y.ELECTRON_NO_ATTACH_CONSOLE,delete Y.XDG_RUNTIME_DIR,l.trace("getUnixShellEnvironment#result",Y),b(Y)}catch(Y){l.error("getUnixShellEnvironment#errorCaught",(0,L.toErrorMessage)(Y)),D(Y)}})});try{return await R}catch(b){return l.error("getUnixShellEnvironment#error",(0,L.toErrorMessage)(b)),{}}}}),define(Z[51],te([0,1,7,17,10]),function(q,t,g,O,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeFileChanges=t.toFileChanges=void 0;function I(c){return c.map(d=>({type:d.type,resource:g.URI.file(d.path)}))}t.toFileChanges=I;function T(c){const d=new L;for(const v of c)d.processEvent(v);return d.normalize()}t.normalizeFileChanges=T;class L{constructor(){this.normalized=[],this.mapPathToChange=new Map}processEvent(d){const v=this.mapPathToChange.get(d.path);if(v){const p=v.type,w=d.type;p===1&&w===2?(this.mapPathToChange.delete(d.path),this.normalized.splice(this.normalized.indexOf(v),1)):p===2&&w===1?v.type=0:p===1&&w===0||(v.type=w)}else this.normalized.push(d),this.mapPathToChange.set(d.path,d)}normalize(){const d=[],v=[];return this.normalized.filter(p=>p.type!==2?(d.push(p),!1):!0).sort((p,w)=>p.path.length-w.path.length).filter(p=>v.some(w=>(0,O.isParent)(p.path,w,!E.isLinux))?!1:(v.push(p.path),!0)).concat(d)}}}),define(Z[100],te([0,1,51,2,11,63,65,4,3]),function(q,t,g,O,E,I,T,L,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileWatcher=void 0;class d extends O.Disposable{constructor(p,w,F,l){super();this.path=p,this.onDidFilesChange=w,this.onLogMessage=F,this.verboseLogging=l,this.fileChangesDelayer=this._register(new L.ThrottledDelayer(T.CHANGE_BUFFER_DELAY*2)),this.fileChangesBuffer=[],this.startWatching()}setVerboseLogging(p){this.verboseLogging=p}async startWatching(){try{const{stat:p,symbolicLink:w}=await E.SymlinkSupport.stat(this.path);if(this.isDisposed)return;let F=this.path;if(w)try{F=await(0,I.realpath)(F)}catch(l){if(this.onError(l),w.dangling)return}p.isDirectory()?this._register((0,T.watchFolder)(F,(l,u)=>{this.onFileChange({type:l==="changed"?0:l==="added"?1:2,path:(0,c.join)(this.path,(0,c.basename)(u))})},l=>this.onError(l))):this._register((0,T.watchFile)(F,l=>{this.onFileChange({type:l==="changed"?0:2,path:this.path})},l=>this.onError(l)))}catch(p){p.code!=="ENOENT"&&this.onError(p)}}onFileChange(p){this.fileChangesBuffer.push(p),this.verboseLogging&&this.onVerbose(`${p.type===1?"[ADDED]":p.type===2?"[DELETED]":"[CHANGED]"} ${p.path}`),this.fileChangesDelayer.trigger(async()=>{const w=this.fileChangesBuffer;this.fileChangesBuffer=[];const F=(0,g.normalizeFileChanges)(w);if(this.verboseLogging)for(const l of F)this.onVerbose(`>> normalized ${l.type===1?"[ADDED]":l.type===2?"[DELETED]":"[CHANGED]"} ${l.path}`);F.length>0&&this.onDidFilesChange(F)})}onError(p){this.isDisposed||this.onLogMessage({type:"error",message:`[File Watcher (node.js)] ${p}`})}onVerbose(p){this.isDisposed||this.onLogMessage({type:"trace",message:`[File Watcher (node.js)] ${p}`})}dispose(){this.isDisposed=!0,super.dispose()}}t.FileWatcher=d}),define(Z[52],te([0,1]),function(q,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceCollection=void 0;class g{constructor(...E){this._entries=new Map;for(let[I,T]of E)this.set(I,T)}set(E,I){const T=this._entries.get(E);return this._entries.set(E,I),T}has(E){return this._entries.has(E)}get(E){return this._entries.get(E)}}t.ServiceCollection=g}),define(Z[101],te([0,1,8,95,50,12,52,4]),function(q,t,g,O,E,I,T,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=void 0;const c=!1;class d extends Error{constructor(l){super("cyclic dependency between services");this.message=l.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${l.toString()}`}}class v{constructor(l=new T.ServiceCollection,u=!1,R){this._activeInstantiations=new Set,this._services=l,this._strict=u,this._parent=R,this._services.set(I.IInstantiationService,this)}createChild(l){return new v(l,this._strict,this)}invokeFunction(l,...u){let R=w.traceInvocation(l),b=!1;try{return l({get:(f,r)=>{if(b)throw(0,g.illegalState)("service accessor is only valid during the invocation of its target method");const s=this._getOrCreateServiceInstance(f,R);if(!s&&r!==I.optional)throw new Error(`[invokeFunction] unknown service '${f}'`);return s}},...u)}finally{b=!0,R.stop()}}createInstance(l,...u){let R,b;return l instanceof E.SyncDescriptor?(R=w.traceCreation(l.ctor),b=this._createInstance(l.ctor,l.staticArguments.concat(u),R)):(R=w.traceCreation(l),b=this._createInstance(l,u,R)),R.stop(),b}_createInstance(l,u=[],R){let b=I._util.getServiceDependencies(l).sort((r,s)=>r.index-s.index),D=[];for(const r of b){let s=this._getOrCreateServiceInstance(r.id,R);if(!s&&this._strict&&!r.optional)throw new Error(`[createInstance] ${l.name} depends on UNKNOWN service ${r.id}.`);D.push(s)}let f=b.length>0?b[0].index:u.length;if(u.length!==f){console.warn(`[createInstance] First service dependency of ${l.name} at position ${f+1} conflicts with ${u.length} static arguments`);let r=f-u.length;r>0?u=u.concat(new Array(r)):u=u.slice(0,f)}return new l(...[...u,...D])}_setServiceInstance(l,u){if(this._services.get(l)instanceof E.SyncDescriptor)this._services.set(l,u);else if(this._parent)this._parent._setServiceInstance(l,u);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(l){let u=this._services.get(l);return!u&&this._parent?this._parent._getServiceInstanceOrDescriptor(l):u}_getOrCreateServiceInstance(l,u){let R=this._getServiceInstanceOrDescriptor(l);return R instanceof E.SyncDescriptor?this._safeCreateAndCacheServiceInstance(l,R,u.branch(l,!0)):(u.branch(l,!1),R)}_safeCreateAndCacheServiceInstance(l,u,R){if(this._activeInstantiations.has(l))throw new Error(`illegal state - RECURSIVELY instantiating service '${l}'`);this._activeInstantiations.add(l);try{return this._createAndCacheServiceInstance(l,u,R)}finally{this._activeInstantiations.delete(l)}}_createAndCacheServiceInstance(l,u,R){const b=new O.Graph(r=>r.id.toString());let D=0;const f=[{id:l,desc:u,_trace:R}];for(;f.length;){const r=f.pop();if(b.lookupOrInsertNode(r),D++>1e3)throw new d(b);for(let s of I._util.getServiceDependencies(r.desc.ctor)){let e=this._getServiceInstanceOrDescriptor(s.id);if(!e&&!s.optional&&console.warn(`[createInstance] ${l} depends on ${s.id} which is NOT registered.`),e instanceof E.SyncDescriptor){const i={id:s.id,desc:e,_trace:r._trace.branch(s.id,!0)};b.insertEdge(r,i),f.push(i)}}}for(;;){const r=b.roots();if(r.length===0){if(!b.isEmpty())throw new d(b);break}for(const{data:s}of r){if(this._getServiceInstanceOrDescriptor(s.id)instanceof E.SyncDescriptor){const i=this._createServiceInstanceWithOwner(s.id,s.desc.ctor,s.desc.staticArguments,s.desc.supportsDelayedInstantiation,s._trace);this._setServiceInstance(s.id,i)}b.removeNode(s)}}return this._getServiceInstanceOrDescriptor(l)}_createServiceInstanceWithOwner(l,u,R=[],b,D){if(this._services.get(l)instanceof E.SyncDescriptor)return this._createServiceInstance(u,R,b,D);if(this._parent)return this._parent._createServiceInstanceWithOwner(l,u,R,b,D);throw new Error(`illegalState - creating UNKNOWN service instance ${u.name}`)}_createServiceInstance(l,u=[],R,b){if(R){const D=new L.IdleValue(()=>this._createInstance(l,u,b));return new Proxy(Object.create(null),{get(f,r){if(r in f)return f[r];let s=D.value,e=s[r];return typeof e!="function"||(e=e.bind(s),f[r]=e),e},set(f,r,s){return D.value[r]=s,!0}})}else return this._createInstance(l,u,b)}}t.InstantiationService=v;var p;(function(F){F[F.Creation=0]="Creation",F[F.Invocation=1]="Invocation",F[F.Branch=2]="Branch"})(p||(p={}));class w{constructor(l,u){this.type=l,this.name=u,this._start=Date.now(),this._dep=[]}static traceInvocation(l){return c?new w(1,l.name||l.toString().substring(0,42).replace(/\n/g,"")):w._None}static traceCreation(l){return c?new w(0,l.name):w._None}branch(l,u){let R=new w(2,l.toString());return this._dep.push([l,u,R]),R}stop(){let l=Date.now()-this._start;w._totals+=l;let u=!1;function R(D,f){let r=[],s=new Array(D+1).join("	");for(const[e,i,n]of f._dep)if(i&&n){u=!0,r.push(`${s}CREATES -> ${e}`);let o=R(D+1,n);o&&r.push(o)}else r.push(`${s}uses -> ${e}`);return r.join(`
`)}let b=[`${this.type===0?"CREATE":"CALL"} ${this.name}`,`${R(1,this)}`,`DONE, took ${l.toFixed(2)}ms (grand total ${w._totals.toFixed(2)}ms)`];(l>2||u)&&console.log(b.join(`
`))}}w._None=new class extends w{constructor(){super(-1,null)}stop(){}branch(){return this}},w._totals=0}),define(Z[53],te([0,1,12]),function(q,t,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidLocalization=t.ILocalizationsService=void 0,t.ILocalizationsService=(0,g.createDecorator)("localizationsService");function O(E){if(typeof E.languageId!="string"||!Array.isArray(E.translations)||E.translations.length===0)return!1;for(const I of E.translations)if(typeof I.id!="string"||typeof I.path!="string")return!1;return!(E.languageName&&typeof E.languageName!="string"||E.localizedLanguageName&&typeof E.localizedLanguageName!="string")}t.isValidLocalization=O}),define(Z[15],te([0,1,12,2,10,14,28]),function(q,t,g,O,E,I,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevelToString=t.parseLogLevel=t.getLogLevel=t.NullLogService=t.AbstractLoggerService=t.LogService=t.MultiplexLogService=t.AdapterLogger=t.ConsoleLogger=t.ConsoleMainLogger=t.AbstractMessageLogger=t.AbstractLogger=t.DEFAULT_LOG_LEVEL=t.LogLevel=t.ILoggerService=t.ILogService=void 0,t.ILogService=(0,g.createDecorator)("logService"),t.ILoggerService=(0,g.createDecorator)("loggerService");function L(){return new Date().toISOString()}var c;(function(s){s[s.Trace=0]="Trace",s[s.Debug=1]="Debug",s[s.Info=2]="Info",s[s.Warning=3]="Warning",s[s.Error=4]="Error",s[s.Critical=5]="Critical",s[s.Off=6]="Off"})(c=t.LogLevel||(t.LogLevel={})),t.DEFAULT_LOG_LEVEL=c.Info;class d extends O.Disposable{constructor(){super(...arguments);this.level=t.DEFAULT_LOG_LEVEL,this._onDidChangeLogLevel=this._register(new I.Emitter),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}}t.AbstractLogger=d;class v extends d{constructor(e){super();this.logAlways=e}checkLogLevel(e){return this.logAlways||this.getLevel()<=e}trace(e,...i){this.checkLogLevel(c.Trace)&&this.log(c.Trace,this.format([e,...i]))}debug(e,...i){this.checkLogLevel(c.Debug)&&this.log(c.Debug,this.format([e,...i]))}info(e,...i){this.checkLogLevel(c.Info)&&this.log(c.Info,this.format([e,...i]))}warn(e,...i){this.checkLogLevel(c.Warning)&&this.log(c.Warning,this.format([e,...i]))}error(e,...i){if(this.checkLogLevel(c.Error))if(e instanceof Error){const n=Array.prototype.slice.call(arguments);n[0]=e.stack,this.log(c.Error,this.format(n))}else this.log(c.Error,this.format([e,...i]))}critical(e,...i){this.checkLogLevel(c.Critical)&&this.log(c.Critical,this.format([e,...i]))}flush(){}format(e){let i="";for(let n=0;n<e.length;n++){let o=e[n];if(typeof o=="object")try{o=JSON.stringify(o)}catch(a){}i+=(n>0?" ":"")+o}return i}}t.AbstractMessageLogger=v;class p extends d{constructor(e=t.DEFAULT_LOG_LEVEL){super();this.setLevel(e),this.useColors=!E.isWindows}trace(e,...i){this.getLevel()<=c.Trace&&(this.useColors?console.log(`[90m[main ${L()}][0m`,e,...i):console.log(`[main ${L()}]`,e,...i))}debug(e,...i){this.getLevel()<=c.Debug&&(this.useColors?console.log(`[90m[main ${L()}][0m`,e,...i):console.log(`[main ${L()}]`,e,...i))}info(e,...i){this.getLevel()<=c.Info&&(this.useColors?console.log(`[90m[main ${L()}][0m`,e,...i):console.log(`[main ${L()}]`,e,...i))}warn(e,...i){this.getLevel()<=c.Warning&&(this.useColors?console.warn(`[93m[main ${L()}][0m`,e,...i):console.warn(`[main ${L()}]`,e,...i))}error(e,...i){this.getLevel()<=c.Error&&(this.useColors?console.error(`[91m[main ${L()}][0m`,e,...i):console.error(`[main ${L()}]`,e,...i))}critical(e,...i){this.getLevel()<=c.Critical&&(this.useColors?console.error(`[90m[main ${L()}][0m`,e,...i):console.error(`[main ${L()}]`,e,...i))}dispose(){}flush(){}}t.ConsoleMainLogger=p;class w extends d{constructor(e=t.DEFAULT_LOG_LEVEL){super();this.setLevel(e)}trace(e,...i){this.getLevel()<=c.Trace&&console.log("%cTRACE","color: #888",e,...i)}debug(e,...i){this.getLevel()<=c.Debug&&console.log("%cDEBUG","background: #eee; color: #888",e,...i)}info(e,...i){this.getLevel()<=c.Info&&console.log("%c INFO","color: #33f",e,...i)}warn(e,...i){this.getLevel()<=c.Warning&&console.log("%c WARN","color: #993",e,...i)}error(e,...i){this.getLevel()<=c.Error&&console.log("%c  ERR","color: #f33",e,...i)}critical(e,...i){this.getLevel()<=c.Critical&&console.log("%cCRITI","background: #f33; color: white",e,...i)}dispose(){}flush(){}}t.ConsoleLogger=w;class F extends d{constructor(e,i=t.DEFAULT_LOG_LEVEL){super();this.adapter=e,this.setLevel(i)}trace(e,...i){this.getLevel()<=c.Trace&&this.adapter.log(c.Trace,[this.extractMessage(e),...i])}debug(e,...i){this.getLevel()<=c.Debug&&this.adapter.log(c.Debug,[this.extractMessage(e),...i])}info(e,...i){this.getLevel()<=c.Info&&this.adapter.log(c.Info,[this.extractMessage(e),...i])}warn(e,...i){this.getLevel()<=c.Warning&&this.adapter.log(c.Warning,[this.extractMessage(e),...i])}error(e,...i){this.getLevel()<=c.Error&&this.adapter.log(c.Error,[this.extractMessage(e),...i])}critical(e,...i){this.getLevel()<=c.Critical&&this.adapter.log(c.Critical,[this.extractMessage(e),...i])}extractMessage(e){return typeof e=="string"?e:(0,T.toErrorMessage)(e,this.getLevel()<=c.Trace)}dispose(){}flush(){}}t.AdapterLogger=F;class l extends d{constructor(e){super();this.logServices=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const i of this.logServices)i.setLevel(e);super.setLevel(e)}trace(e,...i){for(const n of this.logServices)n.trace(e,...i)}debug(e,...i){for(const n of this.logServices)n.debug(e,...i)}info(e,...i){for(const n of this.logServices)n.info(e,...i)}warn(e,...i){for(const n of this.logServices)n.warn(e,...i)}error(e,...i){for(const n of this.logServices)n.error(e,...i)}critical(e,...i){for(const n of this.logServices)n.critical(e,...i)}flush(){for(const e of this.logServices)e.flush()}dispose(){for(const e of this.logServices)e.dispose()}}t.MultiplexLogService=l;class u extends O.Disposable{constructor(e){super();this.logger=e,this._register(e)}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...i){this.logger.trace(e,...i)}debug(e,...i){this.logger.debug(e,...i)}info(e,...i){this.logger.info(e,...i)}warn(e,...i){this.logger.warn(e,...i)}error(e,...i){this.logger.error(e,...i)}critical(e,...i){this.logger.critical(e,...i)}flush(){this.logger.flush()}}t.LogService=u;class R extends O.Disposable{constructor(e,i){super();this.logLevel=e,this.loggers=new Map,this.logLevelChangeableLoggers=[],this._register(i(n=>{this.logLevel=n,this.logLevelChangeableLoggers.forEach(o=>o.setLevel(n))}))}getLogger(e){return this.loggers.get(e.toString())}createLogger(e,i){let n=this.loggers.get(e.toString());return n||(n=this.doCreateLogger(e,i?.always?c.Trace:this.logLevel,i),this.loggers.set(e.toString(),n),i?.always||this.logLevelChangeableLoggers.push(n)),n}dispose(){this.logLevelChangeableLoggers.splice(0,this.logLevelChangeableLoggers.length),this.loggers.forEach(e=>e.dispose()),this.loggers.clear(),super.dispose()}}t.AbstractLoggerService=R;class b{constructor(){this.onDidChangeLogLevel=new I.Emitter().event}setLevel(e){}getLevel(){return c.Info}trace(e,...i){}debug(e,...i){}info(e,...i){}warn(e,...i){}error(e,...i){}critical(e,...i){}dispose(){}flush(){}}t.NullLogService=b;function D(s){if(s.verbose)return c.Trace;if(typeof s.logLevel=="string"){const e=f(s.logLevel.toLowerCase());if(e!==void 0)return e}return t.DEFAULT_LOG_LEVEL}t.getLogLevel=D;function f(s){switch(s){case"trace":return c.Trace;case"debug":return c.Debug;case"info":return c.Info;case"warn":return c.Warning;case"error":return c.Error;case"critical":return c.Critical;case"off":return c.Off}}t.parseLogLevel=f;function r(s){switch(s){case c.Trace:return"trace";case c.Debug:return"debug";case c.Info:return"info";case c.Warning:return"warn";case c.Error:return"error";case c.Critical:return"critical";case c.Off:return"off"}}t.LogLevelToString=r}),define(Z[102],te([0,1,11,2,17,22,21,7,20,23,15,29,41,10,4,8]),function(q,t,g,O,E,I,T,L,c,d,v,p,w,F,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsDownloader=void 0;const R=/^([^.]+\..+)-(\d+\.\d+\.\d+)$/;let b=class extends O.Disposable{constructor(f,r,s,e){super();this.fileService=r,this.extensionGalleryService=s,this.logService=e,this.extensionsDownloadDir=L.URI.file(f.extensionsDownloadPath),this.cache=20,this.cleanUpPromise=this.cleanUp()}async downloadExtension(f,r){await this.cleanUpPromise;const s=this.getName(f),e=(0,c.joinPath)(this.extensionsDownloadDir,s);if(!await this.fileService.exists(e)){const i=(0,c.joinPath)(this.extensionsDownloadDir,`.${(0,p.generateUuid)()}`);await this.fileService.exists(i)||await this.extensionGalleryService.download(f,i,r);try{await this.rename(i,e,Date.now()+2*60*1e3)}catch(n){try{await this.fileService.del(i)}catch(o){}if(n.code==="ENOTEMPTY")this.logService.info("Rename failed because vsix was downloaded by another source. So ignoring renaming.",f.identifier.id);else throw this.logService.info(`Rename failed because of ${(0,u.getErrorMessage)(n)}. Deleted the vsix from downloaded location`,i.path),n}}return e}async delete(f){}async rename(f,r,s){try{await g.Promises.rename(f.fsPath,r.fsPath)}catch(e){if(F.isWindows&&e&&e.code==="EPERM"&&Date.now()<s)return this.logService.info(`Failed renaming ${f} to ${r} with 'EPERM' error. Trying again...`),this.rename(f,r,s);throw e}}async cleanUp(){try{if(!await this.fileService.exists(this.extensionsDownloadDir)){this.logService.trace("Extension VSIX downlads cache dir does not exist");return}const f=await this.fileService.resolve(this.extensionsDownloadDir,{resolveMetadata:!0});if(f.children){const r=[],s=[];for(const n of f.children){const o=this.parse(n.name);o&&s.push([o,n])}const e=(0,d.groupByExtension)(s,([n])=>n),i=[];for(const n of e)n.sort((o,a)=>w.rcompare(o[0].version,a[0].version)),r.push(...n.slice(1).map(o=>o[1].resource)),i.push(n[0][1]);i.sort((n,o)=>n.mtime-o.mtime),r.push(...i.slice(0,Math.max(0,i.length-this.cache)).map(n=>n.resource)),await l.Promises.settled(r.map(n=>(this.logService.trace("Deleting vsix from cache",n.path),this.fileService.del(n))))}}catch(f){this.logService.error(f)}}getName(f){return this.cache?new d.ExtensionIdentifierWithVersion(f.identifier,f.version).key().toLowerCase():(0,p.generateUuid)()}parse(f){const r=R.exec(f);return r&&r[1]&&r[2]?new d.ExtensionIdentifierWithVersion({id:r[1]},r[2]):null}};b=ue([fe(0,T.INativeEnvironmentService),fe(1,E.IFileService),fe(2,I.IExtensionGalleryService),fe(3,v.ILogService)],b),t.ExtensionsDownloader=b}),define(Z[103],te([0,1,2,15,32,28,3,4,14,9,11,21]),function(q,t,g,O,E,I,T,L,c,d,v,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsLifecycle=void 0;let w=class extends g.Disposable{constructor(l,u){super();this.environmentService=l,this.logService=u,this.processesLimiter=new L.Limiter(5)}async postUninstall(l){const u=this.parseScript(l,"uninstall");return u&&(this.logService.info(l.identifier.id,l.manifest.version,"Running post uninstall script"),await this.processesLimiter.queue(()=>this.runLifecycleHook(u.script,"uninstall",u.args,!0,l).then(()=>this.logService.info(l.identifier.id,l.manifest.version,"Finished running post uninstall script"),R=>this.logService.error(l.identifier.id,l.manifest.version,`Failed to run post uninstall script: ${R}`)))),v.Promises.rm(this.getExtensionStoragePath(l)).then(void 0,R=>this.logService.error("Error while removing extension storage path",R))}parseScript(l,u){const R=`vscode:${u}`;if(l.location.scheme===d.Schemas.file&&l.manifest&&l.manifest.scripts&&typeof l.manifest.scripts[R]=="string"){const b=l.manifest.scripts[R].split(" ");return b.length<2||b[0]!=="node"||!b[1]?(this.logService.warn(l.identifier.id,l.manifest.version,`${R} should be a node script`),null):{script:(0,T.join)(l.location.fsPath,b[1]),args:b.slice(2)||[]}}return null}runLifecycleHook(l,u,R,b,D){return new Promise((f,r)=>{const s=this.start(l,u,R,D);let e;const i=n=>{e&&(clearTimeout(e),e=null),n?r(n):f(void 0)};s.on("error",n=>{i((0,I.toErrorMessage)(n)||"Unknown")}),s.on("exit",(n,o)=>{i(n?`post-${u} process exited with code ${n}`:void 0)}),b&&(e=setTimeout(()=>{e=null,s.kill(),r("timed out")},5e3))})}start(l,u,R,b){const D={silent:!0,execArgv:void 0},f=(0,E.fork)(l,[`--type=extension-post-${u}`,...R],D);f.stdout.setEncoding("utf8"),f.stderr.setEncoding("utf8");const r=c.Event.fromNodeEventEmitter(f.stdout,"data"),s=c.Event.fromNodeEventEmitter(f.stderr,"data");r(n=>this.logService.info(b.identifier.id,b.manifest.version,`post-${u}`,n)),s(n=>this.logService.error(b.identifier.id,b.manifest.version,`post-${u}`,n));const e=c.Event.any(c.Event.map(r,n=>({data:`%c${n}`,format:[""]})),c.Event.map(s,n=>({data:`%c${n}`,format:["color: red"]})));return c.Event.debounce(e,(n,o)=>n?{data:n.data+o.data,format:[...n.format,...o.format]}:{data:o.data,format:o.format},100)(n=>{console.group(b.identifier.id),console.log(n.data,...n.format),console.groupEnd()}),f}getExtensionStoragePath(l){return(0,T.join)(this.environmentService.globalStorageHome.fsPath,l.identifier.id.toLowerCase())}};w=ue([fe(0,p.IEnvironmentService),fe(1,O.ILogService)],w),t.ExtensionsLifecycle=w}),define(Z[104],te([0,1,2,21,14,17,7,23,20,15]),function(q,t,g,O,E,I,T,L,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsWatcher=void 0;let v=class extends g.Disposable{constructor(w,F,l,u){super();this.extensionsManagementService=w,this.logService=u,this._onDidChangeExtensionsByAnotherSource=this._register(new E.Emitter),this.onDidChangeExtensionsByAnotherSource=this._onDidChangeExtensionsByAnotherSource.event,this.startTimestamp=0,this.installingExtensions=[],this.extensionsManagementService.getInstalled(1).then(D=>{this.installedExtensions=D.map(f=>f.identifier),this.startTimestamp=Date.now()}),this._register(w.onInstallExtension(D=>this.onInstallExtension(D))),this._register(w.onDidInstallExtensions(D=>this.onDidInstallExtensions(D))),this._register(w.onDidUninstallExtension(D=>this.onDidUninstallExtension(D)));const R=T.URI.file(l.extensionsPath),b=new c.ExtUri(D=>!F.hasCapability(D,1024));this._register(F.watch(R)),this._register(E.Event.filter(F.onDidChangeFilesRaw,D=>D.changes.some(f=>this.doesChangeAffects(f,R,b)))(()=>this.onDidChange()))}doesChangeAffects(w,F,l){return l.isEqual(l.dirname(w.resource),F)?l.isEqual(w.resource,l.joinPath(F,".obsolete"))?!0:!(w.type!==1&&w.type!==2||l.basename(w.resource).startsWith(".")):!1}onInstallExtension(w){this.addInstallingExtension(w.identifier)}onDidInstallExtensions(w){for(const F of w)this.removeInstallingExtension(F.identifier),F.local&&this.addInstalledExtension(F.identifier)}onDidUninstallExtension(w){w.error||this.removeInstalledExtension(w.identifier)}addInstallingExtension(w){this.removeInstallingExtension(w),this.installingExtensions.push(w)}removeInstallingExtension(w){this.installingExtensions=this.installingExtensions.filter(F=>!(0,L.areSameExtensions)(F,w))}addInstalledExtension(w){this.installedExtensions&&(this.removeInstalledExtension(w),this.installedExtensions.push(w))}removeInstalledExtension(w){this.installedExtensions&&(this.installedExtensions=this.installedExtensions.filter(F=>!(0,L.areSameExtensions)(F,w)))}async onDidChange(){if(this.installedExtensions){const w=await this.extensionsManagementService.getInstalled(1),F=w.filter(u=>[...this.installingExtensions,...this.installedExtensions].some(R=>(0,L.areSameExtensions)(R,u.identifier))?!1:u.installedTimestamp&&u.installedTimestamp>this.startTimestamp?(this.logService.info("Detected extension installed from another source",u.identifier.id),!0):(this.logService.info("Ignored extension installed by another source because of invalid timestamp",u.identifier.id),!1)),l=this.installedExtensions.filter(u=>this.installingExtensions.some(R=>(0,L.areSameExtensions)(R,u))?!1:w.every(R=>!(0,L.areSameExtensions)(R.identifier,u))?(this.logService.info("Detected extension removed from another source",u.id),!0):!1);this.installedExtensions=w.map(u=>u.identifier),(F.length||l.length)&&this._onDidChangeExtensionsByAnotherSource.fire({added:F,removed:l})}}};v=ue([fe(1,I.IFileService),fe(2,O.INativeEnvironmentService),fe(3,d.ILogService)],v),t.ExtensionsWatcher=v}),define(Z[105],te([0,1,11,129,22,2,21,4,23,15,53,24,9,3]),function(q,t,g,O,E,I,T,L,c,d,v,p,w,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalizationsService=void 0;let l=class extends I.Disposable{constructor(b,D,f){super();this.extensionManagementService=b,this.logService=f,this.cache=this._register(new u(D,f)),this.extensionManagementService.registerParticipant({postInstall:async r=>this.postInstallExtension(r),postUninstall:async r=>this.postUninstallExtension(r)})}async getLanguageIds(){const b=await this.cache.getLanguagePacks(),D=["en",...Object.keys(b)];return(0,p.distinct)(D)}async postInstallExtension(b){b&&b.manifest&&b.manifest.contributes&&b.manifest.contributes.localizations&&b.manifest.contributes.localizations.length&&(this.logService.info("Adding language packs from the extension",b.identifier.id),await this.update())}async postUninstallExtension(b){const D=await this.cache.getLanguagePacks();Object.keys(D).some(f=>D[f]&&D[f].extensions.some(r=>(0,c.areSameExtensions)(r.extensionIdentifier,b.identifier)))&&(this.logService.info("Removing language packs from the extension",b.identifier.id),await this.update())}async update(){const[b,D]=await Promise.all([this.cache.getLanguagePacks(),this.extensionManagementService.getInstalled()]),f=await this.cache.update(D);return!(0,p.equals)(Object.keys(b),Object.keys(f))}};l=ue([fe(0,E.IExtensionManagementService),fe(1,T.INativeEnvironmentService),fe(2,d.ILogService)],l),t.LocalizationsService=l;let u=class extends I.Disposable{constructor(b,D){super();this.logService=D,this.languagePacks={},this.languagePacksFilePath=(0,F.join)(b.userDataPath,"languagepacks.json"),this.languagePacksFileLimiter=new L.Queue}getLanguagePacks(){return this.languagePacksFileLimiter.size||!this.initializedCache?this.withLanguagePacks().then(()=>this.languagePacks):Promise.resolve(this.languagePacks)}update(b){return this.withLanguagePacks(D=>{Object.keys(D).forEach(f=>delete D[f]),this.createLanguagePacksFromExtensions(D,...b)}).then(()=>this.languagePacks)}createLanguagePacksFromExtensions(b,...D){for(const f of D)f&&f.manifest&&f.manifest.contributes&&f.manifest.contributes.localizations&&f.manifest.contributes.localizations.length&&this.createLanguagePacksFromExtension(b,f);Object.keys(b).forEach(f=>this.updateHash(b[f]))}createLanguagePacksFromExtension(b,D){const f=D.identifier,r=D.manifest.contributes&&D.manifest.contributes.localizations?D.manifest.contributes.localizations:[];for(const s of r)if(D.location.scheme===w.Schemas.file&&(0,v.isValidLocalization)(s)){let e=b[s.languageId];e||(e={hash:"",extensions:[],translations:{}},b[s.languageId]=e);let i=e.extensions.filter(n=>(0,c.areSameExtensions)(n.extensionIdentifier,f))[0];i?i.version=D.manifest.version:e.extensions.push({extensionIdentifier:f,version:D.manifest.version});for(const n of s.translations)e.translations[n.id]=(0,F.join)(D.location.fsPath,n.path)}}updateHash(b){if(b){const D=(0,O.createHash)("md5");for(const f of b.extensions)D.update(f.extensionIdentifier.uuid||f.extensionIdentifier.id).update(f.version);b.hash=D.digest("hex")}}withLanguagePacks(b=()=>null){return this.languagePacksFileLimiter.queue(()=>{let D=null;return g.Promises.readFile(this.languagePacksFilePath,"utf8").then(void 0,f=>f.code==="ENOENT"?Promise.resolve("{}"):Promise.reject(f)).then(f=>{try{return JSON.parse(f)}catch(r){return{}}}).then(f=>(D=b(f),f)).then(f=>{for(const s of Object.keys(f))f[s]||delete f[s];this.languagePacks=f,this.initializedCache=!0;const r=JSON.stringify(this.languagePacks);return this.logService.debug("Writing language packs",r),g.Promises.writeFile(this.languagePacksFilePath,r)}).then(()=>D,f=>this.logService.error(f))})}};u=ue([fe(0,T.INativeEnvironmentService),fe(1,d.ILogService)],u)}),define(Z[106],te([0,1,15,17]),function(q,t,g,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpdLogLogger=t.createRotatingLogger=void 0;async function E(c,d,v,p){try{const w=await new Promise((F,l)=>{q(["spdlog"],F,l)});return w.setFlushOn(g.LogLevel.Trace),w.createAsyncRotatingLogger(c,d,v,p)}catch(w){console.error(w)}return null}function I(c,d,v,p){const w=q.__$__nodeRequire("spdlog");return w.setFlushOn(g.LogLevel.Trace),w.createRotatingLogger(c,d,v,p)}t.createRotatingLogger=I;function T(c,d,v){switch(d){case g.LogLevel.Trace:c.trace(v);break;case g.LogLevel.Debug:c.debug(v);break;case g.LogLevel.Info:c.info(v);break;case g.LogLevel.Warning:c.warn(v);break;case g.LogLevel.Error:c.error(v);break;case g.LogLevel.Critical:c.critical(v);break;default:throw new Error("Invalid log level")}}class L extends g.AbstractMessageLogger{constructor(d,v,p,w){super();this.name=d,this.filepath=v,this.rotating=p,this.buffer=[],this.setLevel(w),this._loggerCreationPromise=this._createSpdLogLogger(),this._register(this.onDidChangeLogLevel(F=>{this._logger&&this._logger.setLevel(F)}))}_createSpdLogLogger(){const d=this.rotating?6:1,v=30/d*O.ByteSize.MB;return E(this.name,this.filepath,v,d).then(p=>{if(p){this._logger=p,this._logger.setLevel(this.getLevel());for(const{level:w,message:F}of this.buffer)T(this._logger,w,F);this.buffer=[]}})}log(d,v){this._logger?T(this._logger,d,v):this.getLevel()<=d&&this.buffer.push({level:d,message:v})}clearFormatters(){this._logger?this._logger.clearFormatters():this._loggerCreationPromise.then(()=>this.clearFormatters())}flush(){this._logger?this._logger.flush():this._loggerCreationPromise.then(()=>this.flush())}dispose(){this._logger?this.disposeLogger():this._loggerCreationPromise.then(()=>this.disposeLogger())}disposeLogger(){this._logger&&(this._logger.drop(),this._logger=void 0)}}t.SpdLogLogger=L}),define(Z[54],te([0,1,82,16,17,8,34]),function(q,t,g,O,E,I,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readFileIntoStream=void 0;async function L(p,w,F,l,u,R){let b;try{await c(p,w,F,l,u,R)}catch(D){b=D}finally{b&&u.errorTransformer&&(b=u.errorTransformer(b)),typeof b!="undefined"&&F.error(b),F.end()}}t.readFileIntoStream=L;async function c(p,w,F,l,u,R){d(R);const b=await p.open(w,{create:!1});try{d(R);let D=0,f=0,r=u&&typeof u.length=="number"?u.length:void 0,s=O.VSBuffer.alloc(Math.min(u.bufferSize,typeof r=="number"?r:u.bufferSize)),e=u&&typeof u.position=="number"?u.position:0,i=0;do f=await p.read(b,e,s.buffer,i,s.byteLength-i),e+=f,i+=f,D+=f,typeof r=="number"&&(r-=f),i===s.byteLength&&(await F.write(l(s)),s=O.VSBuffer.alloc(Math.min(u.bufferSize,typeof r=="number"?r:u.bufferSize)),i=0);while(f>0&&(typeof r!="number"||r>0)&&d(R)&&v(D,u));if(i>0){let n=i;typeof r=="number"&&(n=Math.min(i,r)),F.write(l(s.slice(0,n)))}}catch(D){throw(0,E.ensureFileSystemProviderError)(D)}finally{await p.close(b)}}function d(p){if(p.isCancellationRequested)throw(0,I.canceled)();return!0}function v(p,w){if(w?.limits){if(typeof w.limits.memory=="number"&&p>w.limits.memory)throw(0,E.createFileSystemProviderError)((0,g.localize)(0,null,T.default.nameShort),E.FileSystemProviderErrorCode.FileExceedsMemoryLimit);if(typeof w.limits.size=="number"&&p>w.limits.size)throw(0,E.createFileSystemProviderError)((0,g.localize)(1,null),E.FileSystemProviderErrorCode.FileTooLarge)}return!0}}),define(Z[107],te([0,1,81,130,2,17,14,20,45,24,15,16,36,4,26,9,54,131]),function(q,t,g,O,E,I,T,L,c,d,v,p,w,F,l,u,R,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileService=void 0;let D=class Ne extends E.Disposable{constructor(r){super();this.logService=r,this.BUFFER_SIZE=64*1024,this._onDidChangeFileSystemProviderRegistrations=this._register(new T.Emitter),this.onDidChangeFileSystemProviderRegistrations=this._onDidChangeFileSystemProviderRegistrations.event,this._onWillActivateFileSystemProvider=this._register(new T.Emitter),this.onWillActivateFileSystemProvider=this._onWillActivateFileSystemProvider.event,this._onDidChangeFileSystemProviderCapabilities=this._register(new T.Emitter),this.onDidChangeFileSystemProviderCapabilities=this._onDidChangeFileSystemProviderCapabilities.event,this.provider=new Map,this._onDidRunOperation=this._register(new T.Emitter),this.onDidRunOperation=this._onDidRunOperation.event,this._onError=this._register(new T.Emitter),this.onError=this._onError.event,this._onDidFilesChange=this._register(new T.Emitter),this.onDidFilesChange=this._onDidFilesChange.event,this._onDidChangeFilesRaw=this._register(new T.Emitter),this.onDidChangeFilesRaw=this._onDidChangeFilesRaw.event,this.activeWatchers=new Map,this.caseSensitiveFileEventsWorker=this._register(new F.ThrottledWorker(Ne.FILE_EVENTS_THROTTLING.maxChangesChunkSize,Ne.FILE_EVENTS_THROTTLING.maxChangesBufferSize,Ne.FILE_EVENTS_THROTTLING.coolDownDelay,s=>this._onDidFilesChange.fire(new I.FileChangesEvent(s,!1)))),this.caseInsensitiveFileEventsWorker=this._register(new F.ThrottledWorker(Ne.FILE_EVENTS_THROTTLING.maxChangesChunkSize,Ne.FILE_EVENTS_THROTTLING.maxChangesBufferSize,Ne.FILE_EVENTS_THROTTLING.coolDownDelay,s=>this._onDidFilesChange.fire(new I.FileChangesEvent(s,!0)))),this.watchedResources=c.TernarySearchTree.forUris(s=>{const e=this.getProvider(s.scheme);return e?!this.isPathCaseSensitive(e):!1}),this.writeQueue=this._register(new F.ResourceQueue)}registerProvider(r,s){if(this.provider.has(r))throw new Error(`A filesystem provider for the scheme '${r}' is already registered.`);(0,O.mark)(`code/registerFilesystem/${r}`),this.provider.set(r,s),this._onDidChangeFileSystemProviderRegistrations.fire({added:!0,scheme:r,provider:s});const e=new E.DisposableStore;return e.add(s.onDidChangeFile(i=>this.onDidChangeFile(i,this.isPathCaseSensitive(s)))),e.add(s.onDidChangeCapabilities(()=>this._onDidChangeFileSystemProviderCapabilities.fire({provider:s,scheme:r}))),typeof s.onDidErrorOccur=="function"&&e.add(s.onDidErrorOccur(i=>this._onError.fire(new Error(i)))),(0,E.toDisposable)(()=>{this._onDidChangeFileSystemProviderRegistrations.fire({added:!1,scheme:r,provider:s}),this.provider.delete(r),(0,E.dispose)(e)})}getProvider(r){return this.provider.get(r)}async activateProvider(r){const s=[];this._onWillActivateFileSystemProvider.fire({scheme:r,join(e){s.push(e)}}),!this.provider.has(r)&&await F.Promises.settled(s)}canHandleResource(r){return this.provider.has(r.scheme)}hasCapability(r,s){const e=this.provider.get(r.scheme);return!!(e&&e.capabilities&s)}listCapabilities(){return b.Iterable.map(this.provider,([r,s])=>({scheme:r,capabilities:s.capabilities}))}async withProvider(r){if(!(0,L.isAbsolutePath)(r))throw new I.FileOperationError((0,g.localize)(0,null,this.resourceForError(r)),8);await this.activateProvider(r.scheme);const s=this.provider.get(r.scheme);if(!s){const e=new Error;throw e.name="ENOPRO",e.message=(0,g.localize)(1,null,r.toString()),e}return s}async withReadProvider(r){const s=await this.withProvider(r);if((0,I.hasOpenReadWriteCloseCapability)(s)||(0,I.hasReadWriteCapability)(s)||(0,I.hasFileReadStreamCapability)(s))return s;throw new Error(`Filesystem provider for scheme '${r.scheme}' neither has FileReadWrite, FileReadStream nor FileOpenReadWriteClose capability which is needed for the read operation.`)}async withWriteProvider(r){const s=await this.withProvider(r);if((0,I.hasOpenReadWriteCloseCapability)(s)||(0,I.hasReadWriteCapability)(s))return s;throw new Error(`Filesystem provider for scheme '${r.scheme}' neither has FileReadWrite nor FileOpenReadWriteClose capability which is needed for the write operation.`)}async resolve(r,s){try{return await this.doResolveFile(r,s)}catch(e){throw(0,I.toFileSystemProviderErrorCode)(e)===I.FileSystemProviderErrorCode.FileNotFound?new I.FileOperationError((0,g.localize)(2,null,this.resourceForError(r)),1):(0,I.ensureFileSystemProviderError)(e)}}async doResolveFile(r,s){const e=await this.withProvider(r),i=this.isPathCaseSensitive(e),n=s?.resolveTo,o=s?.resolveSingleChildDescendants,a=s?.resolveMetadata,h=await e.stat(r);let m;return this.toFileStat(e,r,h,void 0,!!a,(k,P)=>(m||(m=c.TernarySearchTree.forUris(()=>!i),m.set(r,!0),(0,d.isNonEmptyArray)(n)&&n.forEach(N=>m.set(N,!0))),Boolean(m.findSuperstr(k.resource)||m.get(k.resource))?!0:k.isDirectory&&o?P===1:!1))}async toFileStat(r,s,e,i,n,o){const{providerExtUri:a}=this.getExtUri(r),h={resource:s,name:a.basename(s),isFile:(e.type&I.FileType.File)!=0,isDirectory:(e.type&I.FileType.Directory)!=0,isSymbolicLink:(e.type&I.FileType.SymbolicLink)!=0,mtime:e.mtime,ctime:e.ctime,size:e.size,readonly:Boolean((e.permissions??0)&I.FilePermission.Readonly)||Boolean(r.capabilities&2048),etag:(0,I.etag)({mtime:e.mtime,size:e.size})};if(h.isDirectory&&o(h,i)){try{const m=await r.readdir(s),k=await F.Promises.settled(m.map(async([P,N])=>{try{const x=a.joinPath(s,P),_=n?await r.stat(x):{type:N};return await this.toFileStat(r,x,_,m.length,n,o)}catch(x){return this.logService.trace(x),null}}));h.children=(0,d.coalesce)(k)}catch(m){this.logService.trace(m),h.children=[]}return h}return h}async resolveAll(r){return F.Promises.settled(r.map(async s=>{try{return{stat:await this.doResolveFile(s.resource,s.options),success:!0}}catch(e){return this.logService.trace(e),{stat:void 0,success:!1}}}))}async exists(r){const s=await this.withProvider(r);try{return!!await s.stat(r)}catch(e){return!1}}async canCreateFile(r,s){try{await this.doValidateCreateFile(r,s)}catch(e){return e}return!0}async doValidateCreateFile(r,s){if(!s?.overwrite&&await this.exists(r))throw new I.FileOperationError((0,g.localize)(3,null,this.resourceForError(r)),3,s)}async createFile(r,s=p.VSBuffer.fromString(""),e){await this.doValidateCreateFile(r,e);const i=await this.writeFile(r,s);return this._onDidRunOperation.fire(new I.FileOperationEvent(r,0,i)),i}async writeFile(r,s,e){const i=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(r),r),{providerExtUri:n}=this.getExtUri(i);try{await this.validateWriteFile(i,r,e)||await this.mkdirp(i,n.dirname(r));let a;if((0,I.hasReadWriteCapability)(i)&&!(s instanceof p.VSBuffer))if((0,w.isReadableStream)(s)){const h=await(0,w.peekStream)(s,3);h.ended?a=p.VSBuffer.concat(h.buffer):a=h}else a=(0,w.peekReadable)(s,h=>p.VSBuffer.concat(h),3);else a=s;!(0,I.hasOpenReadWriteCloseCapability)(i)||(0,I.hasReadWriteCapability)(i)&&a instanceof p.VSBuffer?await this.doWriteUnbuffered(i,r,e,a):await this.doWriteBuffered(i,r,e,a instanceof p.VSBuffer?(0,p.bufferToReadable)(a):a)}catch(o){throw new I.FileOperationError((0,g.localize)(4,null,this.resourceForError(r),(0,I.ensureFileSystemProviderError)(o).toString()),(0,I.toFileOperationResult)(o),e)}return this.resolve(r,{resolveMetadata:!0})}async validateWriteFile(r,s,e){if(!!e?.unlock&&!(r.capabilities&8192))throw new Error((0,g.localize)(5,null,this.resourceForError(s)));let n;try{n=await r.stat(s)}catch(o){return}if((n.type&I.FileType.Directory)!=0)throw new I.FileOperationError((0,g.localize)(6,null,this.resourceForError(s)),0,e);if(this.throwIfFileIsReadonly(s,n),e&&typeof e.mtime=="number"&&typeof e.etag=="string"&&e.etag!==I.ETAG_DISABLED&&typeof n.mtime=="number"&&typeof n.size=="number"&&e.mtime<n.mtime&&e.etag!==(0,I.etag)({mtime:e.mtime,size:n.size}))throw new I.FileOperationError((0,g.localize)(7,null),3,e);return n}async readFile(r,s){const e=await this.withReadProvider(r);return s?.atomic?this.doReadFileAtomic(e,r,s):this.doReadFile(e,r,s)}async doReadFileAtomic(r,s,e){return new Promise((i,n)=>{this.writeQueue.queueFor(s,this.getExtUri(r).providerExtUri).queue(async()=>{try{const o=await this.doReadFile(r,s,e);i(o)}catch(o){n(o)}})})}async doReadFile(r,s,e){const i=await this.doReadFileStream(r,s,{...e,preferUnbuffered:!0});return{...i,value:await(0,p.streamToBuffer)(i.value)}}async readFileStream(r,s){const e=await this.withReadProvider(r);return this.doReadFileStream(e,r,s)}async doReadFileStream(r,s,e){const i=new l.CancellationTokenSource,n=this.validateReadFile(s,e).then(a=>a,a=>{throw i.cancel(),a});let o;try{return e&&typeof e.etag=="string"&&e.etag!==I.ETAG_DISABLED&&await n,!((0,I.hasOpenReadWriteCloseCapability)(r)||(0,I.hasFileReadStreamCapability)(r))||(0,I.hasReadWriteCapability)(r)&&e?.preferUnbuffered?o=this.readFileUnbuffered(r,s,e):(0,I.hasFileReadStreamCapability)(r)?o=this.readFileStreamed(r,s,i.token,e):o=this.readFileBuffered(r,s,i.token,e),{...await n,value:o}}catch(a){o&&await(0,w.consumeStream)(o);const h=(0,g.localize)(8,null,this.resourceForError(s),(0,I.ensureFileSystemProviderError)(a).toString());throw a instanceof I.NotModifiedSinceFileOperationError?new I.NotModifiedSinceFileOperationError(h,a.stat,e):new I.FileOperationError(h,(0,I.toFileOperationResult)(a),e)}}readFileStreamed(r,s,e,i=Object.create(null)){const n=r.readFileStream(s,i,e);return(0,w.transform)(n,{data:o=>o instanceof p.VSBuffer?o:p.VSBuffer.wrap(o),error:o=>new I.FileOperationError((0,g.localize)(9,null,this.resourceForError(s),(0,I.ensureFileSystemProviderError)(o).toString()),(0,I.toFileOperationResult)(o),i)},o=>p.VSBuffer.concat(o))}readFileBuffered(r,s,e,i=Object.create(null)){const n=(0,p.newWriteableBufferStream)();return(0,R.readFileIntoStream)(r,s,n,o=>o,{...i,bufferSize:this.BUFFER_SIZE,errorTransformer:o=>new I.FileOperationError((0,g.localize)(10,null,this.resourceForError(s),(0,I.ensureFileSystemProviderError)(o).toString()),(0,I.toFileOperationResult)(o),i)},e),n}readFileUnbuffered(r,s,e){const i=(0,w.newWriteableStream)(n=>p.VSBuffer.concat(n));return(async()=>{try{let n=await r.readFile(s);e&&typeof e.position=="number"&&(n=n.slice(e.position)),e&&typeof e.length=="number"&&(n=n.slice(0,e.length)),this.validateReadFileLimits(s,n.byteLength,e),i.end(p.VSBuffer.wrap(n))}catch(n){i.error(n),i.end()}})(),i}async validateReadFile(r,s){const e=await this.resolve(r,{resolveMetadata:!0});if(e.isDirectory)throw new I.FileOperationError((0,g.localize)(11,null,this.resourceForError(r)),0,s);if(s&&typeof s.etag=="string"&&s.etag!==I.ETAG_DISABLED&&s.etag===e.etag)throw new I.NotModifiedSinceFileOperationError((0,g.localize)(12,null),e,s);return this.validateReadFileLimits(r,e.size,s),e}validateReadFileLimits(r,s,e){if(e?.limits){let i;if(typeof e.limits.memory=="number"&&s>e.limits.memory&&(i=9),typeof e.limits.size=="number"&&s>e.limits.size&&(i=7),typeof i=="number")throw new I.FileOperationError((0,g.localize)(13,null,this.resourceForError(r)),i)}}async canMove(r,s,e){return this.doCanMoveCopy(r,s,"move",e)}async canCopy(r,s,e){return this.doCanMoveCopy(r,s,"copy",e)}async doCanMoveCopy(r,s,e,i){if(r.toString()!==s.toString())try{const n=e==="move"?this.throwIfFileSystemIsReadonly(await this.withWriteProvider(r),r):await this.withReadProvider(r),o=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(s),s);await this.doValidateMoveCopy(n,r,o,s,e,i)}catch(n){return n}return!0}async move(r,s,e){const i=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(r),r),n=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(s),s),o=await this.doMoveCopy(i,r,n,s,"move",!!e),a=await this.resolve(s,{resolveMetadata:!0});return this._onDidRunOperation.fire(new I.FileOperationEvent(r,o==="move"?2:3,a)),a}async copy(r,s,e){const i=await this.withReadProvider(r),n=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(s),s),o=await this.doMoveCopy(i,r,n,s,"copy",!!e),a=await this.resolve(s,{resolveMetadata:!0});return this._onDidRunOperation.fire(new I.FileOperationEvent(r,o==="copy"?3:2,a)),a}async doMoveCopy(r,s,e,i,n,o){if(s.toString()===i.toString())return n;const{exists:a,isSameResourceWithDifferentPathCase:h}=await this.doValidateMoveCopy(r,s,e,i,n,o);if(a&&!h&&o&&await this.del(i,{recursive:!0}),await this.mkdirp(e,this.getExtUri(e).providerExtUri.dirname(i)),n==="copy"){if(r===e&&(0,I.hasFileFolderCopyCapability)(r))await r.copy(s,i,{overwrite:o});else{const m=await this.resolve(s);m.isDirectory?await this.doCopyFolder(r,m,e,i):await this.doCopyFile(r,s,e,i)}return n}else return r===e?(await r.rename(s,i,{overwrite:o}),n):(await this.doMoveCopy(r,s,e,i,"copy",o),await this.del(s,{recursive:!0}),"copy")}async doCopyFile(r,s,e,i){if((0,I.hasOpenReadWriteCloseCapability)(r)&&(0,I.hasOpenReadWriteCloseCapability)(e))return this.doPipeBuffered(r,s,e,i);if((0,I.hasOpenReadWriteCloseCapability)(r)&&(0,I.hasReadWriteCapability)(e))return this.doPipeBufferedToUnbuffered(r,s,e,i);if((0,I.hasReadWriteCapability)(r)&&(0,I.hasOpenReadWriteCloseCapability)(e))return this.doPipeUnbufferedToBuffered(r,s,e,i);if((0,I.hasReadWriteCapability)(r)&&(0,I.hasReadWriteCapability)(e))return this.doPipeUnbuffered(r,s,e,i)}async doCopyFolder(r,s,e,i){await e.mkdir(i),Array.isArray(s.children)&&await F.Promises.settled(s.children.map(async n=>{const o=this.getExtUri(e).providerExtUri.joinPath(i,n.name);return n.isDirectory?this.doCopyFolder(r,await this.resolve(n.resource),e,o):this.doCopyFile(r,n.resource,e,o)}))}async doValidateMoveCopy(r,s,e,i,n,o){let a=!1;if(r===e){const{providerExtUri:m,isPathCaseSensitive:k}=this.getExtUri(r);if(k||(a=m.isEqual(s,i)),a&&n==="copy")throw new Error((0,g.localize)(14,null,this.resourceForError(s),this.resourceForError(i)));if(!a&&m.isEqualOrParent(i,s))throw new Error((0,g.localize)(15,null,this.resourceForError(s),this.resourceForError(i)))}const h=await this.exists(i);if(h&&!a){if(!o)throw new I.FileOperationError((0,g.localize)(16,null,this.resourceForError(s),this.resourceForError(i)),4);if(r===e){const{providerExtUri:m}=this.getExtUri(r);if(m.isEqualOrParent(s,i))throw new Error((0,g.localize)(17,null,this.resourceForError(s),this.resourceForError(i)))}}return{exists:h,isSameResourceWithDifferentPathCase:a}}getExtUri(r){const s=this.isPathCaseSensitive(r);return{providerExtUri:s?L.extUri:L.extUriIgnorePathCase,isPathCaseSensitive:s}}isPathCaseSensitive(r){return!!(r.capabilities&1024)}async createFolder(r){const s=this.throwIfFileSystemIsReadonly(await this.withProvider(r),r);await this.mkdirp(s,r);const e=await this.resolve(r,{resolveMetadata:!0});return this._onDidRunOperation.fire(new I.FileOperationEvent(r,0,e)),e}async mkdirp(r,s){const e=[],{providerExtUri:i}=this.getExtUri(r);for(;!i.isEqual(s,i.dirname(s));)try{if(((await r.stat(s)).type&I.FileType.Directory)==0)throw new Error((0,g.localize)(18,null,this.resourceForError(s)));break}catch(n){if((0,I.toFileSystemProviderErrorCode)(n)!==I.FileSystemProviderErrorCode.FileNotFound)throw n;e.push(i.basename(s)),s=i.dirname(s)}for(let n=e.length-1;n>=0;n--){s=i.joinPath(s,e[n]);try{await r.mkdir(s)}catch(o){if((0,I.toFileSystemProviderErrorCode)(o)!==I.FileSystemProviderErrorCode.FileExists)throw o}}}async canDelete(r,s){try{await this.doValidateDelete(r,s)}catch(e){return e}return!0}async doValidateDelete(r,s){const e=this.throwIfFileSystemIsReadonly(await this.withProvider(r),r);if(!!s?.useTrash&&!(e.capabilities&4096))throw new Error((0,g.localize)(19,null,this.resourceForError(r)));let n;try{n=await e.stat(r)}catch(a){}if(n)this.throwIfFileIsReadonly(r,n);else throw new I.FileOperationError((0,g.localize)(20,null,this.resourceForError(r)),1);if(!!!s?.recursive){const a=await this.resolve(r);if(a.isDirectory&&Array.isArray(a.children)&&a.children.length>0)throw new Error((0,g.localize)(21,null,this.resourceForError(r)))}return e}async del(r,s){const e=await this.doValidateDelete(r,s),i=!!s?.useTrash,n=!!s?.recursive;await e.delete(r,{recursive:n,useTrash:i}),this._onDidRunOperation.fire(new I.FileOperationEvent(r,1))}onDidChangeFile(r,s){this._onDidChangeFilesRaw.fire({changes:r});let e,i;{for(const n of r)this.watchedResources.has(n.resource)?(e||(e=[]),e.push(n)):(i||(i=[]),i.push(n));e&&this._onDidFilesChange.fire(new I.FileChangesEvent(e,!s))}if(i){const n=s?this.caseSensitiveFileEventsWorker:this.caseInsensitiveFileEventsWorker;!n.work(i)&&Ne.FILE_EVENTS_THROTTLING.warningscounter++<10&&this.logService.warn(`[File watcher]: started ignoring events due to too many file change events at once (incoming: ${i.length}, most recent change: ${i[0].resource.toString()}). Use 'files.watcherExclude' setting to exclude folders with lots of changing files (e.g. compilation output).`),n.pending>0&&this.logService.trace(`[File watcher]: started throttling events due to large amount of file change events at once (pending: ${n.pending}, most recent change: ${i[0].resource.toString()}). Use 'files.watcherExclude' setting to exclude folders with lots of changing files (e.g. compilation output).`)}}watch(r,s={recursive:!1,excludes:[]}){const e=new E.DisposableStore;{let i=!1,n=()=>{i=!0};e.add((0,E.toDisposable)(()=>n())),this.doWatch(r,s).then(o=>{i?(0,E.dispose)(o):n=()=>(0,E.dispose)(o)},o=>this.logService.error(o))}return s.recursive||(this.watchedResources.set(r,(this.watchedResources.get(r)??0)+1),e.add((0,E.toDisposable)(()=>{const i=this.watchedResources.get(r);typeof i=="number"&&(i<=1?this.watchedResources.delete(r):this.watchedResources.set(r,i-1))}))),e}async doWatch(r,s){const e=await this.withProvider(r),i=this.toWatchKey(e,r,s),n=this.activeWatchers.get(i)||{count:0,disposable:e.watch(r,s)};return this.activeWatchers.has(i)||this.activeWatchers.set(i,n),n.count+=1,(0,E.toDisposable)(()=>{n.count--,n.count===0&&((0,E.dispose)(n.disposable),this.activeWatchers.delete(i))})}toWatchKey(r,s,e){const{providerExtUri:i}=this.getExtUri(r);return[i.getComparisonKey(s),String(e.recursive),e.excludes.join()].join()}dispose(){super.dispose(),this.activeWatchers.forEach(r=>(0,E.dispose)(r.disposable)),this.activeWatchers.clear()}async doWriteBuffered(r,s,e,i){return this.writeQueue.queueFor(s,this.getExtUri(r).providerExtUri).queue(async()=>{const n=await r.open(s,{create:!0,unlock:e?.unlock??!1});try{(0,w.isReadableStream)(i)||(0,w.isReadableBufferedStream)(i)?await this.doWriteStreamBufferedQueued(r,n,i):await this.doWriteReadableBufferedQueued(r,n,i)}catch(o){throw(0,I.ensureFileSystemProviderError)(o)}finally{await r.close(n)}})}async doWriteStreamBufferedQueued(r,s,e){let i=0,n;if((0,w.isReadableBufferedStream)(e)){if(e.buffer.length>0){const o=p.VSBuffer.concat(e.buffer);await this.doWriteBuffer(r,s,o,o.byteLength,i,0),i+=o.byteLength}if(e.ended)return;n=e.stream}else n=e;return new Promise(async(o,a)=>{(0,w.listenStream)(n,{onData:async h=>{n.pause();try{await this.doWriteBuffer(r,s,h,h.byteLength,i,0)}catch(m){return a(m)}i+=h.byteLength,setTimeout(()=>n.resume())},onError:h=>a(h),onEnd:()=>o()})})}async doWriteReadableBufferedQueued(r,s,e){let i=0,n;for(;(n=e.read())!==null;)await this.doWriteBuffer(r,s,n,n.byteLength,i,0),i+=n.byteLength}async doWriteBuffer(r,s,e,i,n,o){let a=0;for(;a<i;)a+=await r.write(s,n+a,e.buffer,o+a,i-a)}async doWriteUnbuffered(r,s,e,i){return this.writeQueue.queueFor(s,this.getExtUri(r).providerExtUri).queue(()=>this.doWriteUnbufferedQueued(r,s,e,i))}async doWriteUnbufferedQueued(r,s,e,i){let n;i instanceof p.VSBuffer?n=i:(0,w.isReadableStream)(i)?n=await(0,p.streamToBuffer)(i):(0,w.isReadableBufferedStream)(i)?n=await(0,p.bufferedStreamToBuffer)(i):n=(0,p.readableToBuffer)(i),await r.writeFile(s,n.buffer,{create:!0,overwrite:!0,unlock:e?.unlock??!1})}async doPipeBuffered(r,s,e,i){return this.writeQueue.queueFor(i,this.getExtUri(e).providerExtUri).queue(()=>this.doPipeBufferedQueued(r,s,e,i))}async doPipeBufferedQueued(r,s,e,i){let n,o;try{n=await r.open(s,{create:!1}),o=await e.open(i,{create:!0,unlock:!1});const a=p.VSBuffer.alloc(this.BUFFER_SIZE);let h=0,m=0,k=0;do k=await r.read(n,h,a.buffer,m,a.byteLength-m),await this.doWriteBuffer(e,o,a,k,h,m),h+=k,m+=k,m===a.byteLength&&(m=0);while(k>0)}catch(a){throw(0,I.ensureFileSystemProviderError)(a)}finally{await F.Promises.settled([typeof n=="number"?r.close(n):Promise.resolve(),typeof o=="number"?e.close(o):Promise.resolve()])}}async doPipeUnbuffered(r,s,e,i){return this.writeQueue.queueFor(i,this.getExtUri(e).providerExtUri).queue(()=>this.doPipeUnbufferedQueued(r,s,e,i))}async doPipeUnbufferedQueued(r,s,e,i){return e.writeFile(i,await r.readFile(s),{create:!0,overwrite:!0,unlock:!1})}async doPipeUnbufferedToBuffered(r,s,e,i){return this.writeQueue.queueFor(i,this.getExtUri(e).providerExtUri).queue(()=>this.doPipeUnbufferedToBufferedQueued(r,s,e,i))}async doPipeUnbufferedToBufferedQueued(r,s,e,i){const n=await e.open(i,{create:!0,unlock:!1});try{const o=await r.readFile(s);await this.doWriteBuffer(e,n,p.VSBuffer.wrap(o),o.byteLength,0,0)}catch(o){throw(0,I.ensureFileSystemProviderError)(o)}finally{await e.close(n)}}async doPipeBufferedToUnbuffered(r,s,e,i){const n=await(0,p.streamToBuffer)(this.readFileBuffered(r,s,l.CancellationToken.None));await this.doWriteUnbuffered(e,i,void 0,n)}throwIfFileSystemIsReadonly(r,s){if(r.capabilities&2048)throw new I.FileOperationError((0,g.localize)(22,null,this.resourceForError(s)),6);return r}throwIfFileIsReadonly(r,s){if((s.permissions??0)&I.FilePermission.Readonly)throw new I.FileOperationError((0,g.localize)(23,null,this.resourceForError(r)),6)}resourceForError(r){return r.scheme===u.Schemas.file?r.fsPath:r.toString(!0)}};D.FILE_EVENTS_THROTTLING={maxChangesChunkSize:500,maxChangesBufferSize:3e4,coolDownDelay:200,warningscounter:0},D=ue([fe(0,v.ILogService)],D),t.FileService=D}),define(Z[108],te([0,1,2,17,14,10,11,3,20,37,4,15,83,51,92,94,91,100,36,54,24,16]),function(q,t,g,O,E,I,T,L,c,d,v,p,w,F,l,u,R,b,D,f,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiskFileSystemProvider=void 0;class e extends g.Disposable{constructor(n,o){super();this.logService=n,this.options=o,this.BUFFER_SIZE=this.options?.bufferSize||64*1024,this.onDidChangeCapabilities=E.Event.None,this.mapHandleToPos=new Map,this.writeHandles=new Map,this.canFlush=!0,this._onDidWatchErrorOccur=this._register(new E.Emitter),this.onDidErrorOccur=this._onDidWatchErrorOccur.event,this._onDidChangeFile=this._register(new E.Emitter),this.onDidChangeFile=this._onDidChangeFile.event,this.recursiveFoldersToWatch=[],this.recursiveWatchRequestDelayer=this._register(new v.ThrottledDelayer(0))}get capabilities(){return this._capabilities||(this._capabilities=2|4|16|8|8192,I.isLinux&&(this._capabilities|=1024)),this._capabilities}async stat(n){try{const{stat:o,symbolicLink:a}=await T.SymlinkSupport.stat(this.toFilePath(n));return{type:this.toType(o,a),ctime:o.birthtime.getTime(),mtime:o.mtime.getTime(),size:o.size}}catch(o){throw this.toFileSystemProviderError(o)}}async readdir(n){try{const o=await T.Promises.readdir(this.toFilePath(n),{withFileTypes:!0}),a=[];return await Promise.all(o.map(async h=>{try{let m;h.isSymbolicLink()?m=(await this.stat((0,c.joinPath)(n,h.name))).type:m=this.toType(h),a.push([h.name,m])}catch(m){this.logService.trace(m)}})),a}catch(o){throw this.toFileSystemProviderError(o)}}toType(n,o){let a;return o?.dangling?a=O.FileType.Unknown:n.isFile()?a=O.FileType.File:n.isDirectory()?a=O.FileType.Directory:a=O.FileType.Unknown,o&&(a|=O.FileType.SymbolicLink),a}async readFile(n){try{const o=this.toFilePath(n);return await T.Promises.readFile(o)}catch(o){throw this.toFileSystemProviderError(o)}}readFileStream(n,o,a){const h=(0,D.newWriteableStream)(m=>s.VSBuffer.concat(m.map(k=>s.VSBuffer.wrap(k))).buffer);return(0,f.readFileIntoStream)(this,n,h,m=>m.buffer,{...o,bufferSize:this.BUFFER_SIZE},a),h}async writeFile(n,o,a){let h;try{const m=this.toFilePath(n);if(!a.create||!a.overwrite){if(await T.Promises.exists(m)){if(!a.overwrite)throw(0,O.createFileSystemProviderError)((0,w.localize)(0,null),O.FileSystemProviderErrorCode.FileExists)}else if(!a.create)throw(0,O.createFileSystemProviderError)((0,w.localize)(1,null),O.FileSystemProviderErrorCode.FileNotFound)}h=await this.open(n,{create:!0,unlock:a.unlock}),await this.write(h,0,o,0,o.byteLength)}catch(m){throw await this.toFileSystemProviderWriteError(n,m)}finally{typeof h=="number"&&await this.close(h)}}async open(n,o){try{const a=this.toFilePath(n);if((0,O.isFileOpenForWriteOptions)(o)&&o.unlock)try{const{stat:k}=await T.SymlinkSupport.stat(a);k.mode&128||await T.Promises.chmod(a,k.mode|128)}catch(k){this.logService.trace(k)}let h;if((0,O.isFileOpenForWriteOptions)(o)){if(I.isWindows)try{await T.Promises.truncate(a,0),h="r+"}catch(k){k.code!=="ENOENT"&&this.logService.trace(k)}h||(h="w")}else h="r";const m=await T.Promises.open(a,h);return this.mapHandleToPos.set(m,0),(0,O.isFileOpenForWriteOptions)(o)&&this.writeHandles.set(m,n),m}catch(a){throw(0,O.isFileOpenForWriteOptions)(o)?await this.toFileSystemProviderWriteError(n,a):this.toFileSystemProviderError(a)}}async close(n){try{if(this.mapHandleToPos.delete(n),this.writeHandles.delete(n)&&this.canFlush)try{await T.Promises.fdatasync(n)}catch(o){this.canFlush=!1,this.logService.error(o)}return await T.Promises.close(n)}catch(o){throw this.toFileSystemProviderError(o)}}async read(n,o,a,h,m){const k=this.normalizePos(n,o);let P=null;try{const N=await T.Promises.read(n,a,h,m,k);return typeof N=="number"?P=N:P=N.bytesRead,P}catch(N){throw this.toFileSystemProviderError(N)}finally{this.updatePos(n,k,P)}}normalizePos(n,o){return o===this.mapHandleToPos.get(n)?null:o}updatePos(n,o,a){const h=this.mapHandleToPos.get(n);typeof h=="number"&&(typeof o=="number"||(typeof a=="number"?this.mapHandleToPos.set(n,h+a):this.mapHandleToPos.delete(n)))}async write(n,o,a,h,m){return(0,v.retry)(()=>this.doWrite(n,o,a,h,m),100,3)}async doWrite(n,o,a,h,m){const k=this.normalizePos(n,o);let P=null;try{const N=await T.Promises.write(n,a,h,m,k);return typeof N=="number"?P=N:P=N.bytesWritten,P}catch(N){throw await this.toFileSystemProviderWriteError(this.writeHandles.get(n),N)}finally{this.updatePos(n,k,P)}}async mkdir(n){try{await T.Promises.mkdir(this.toFilePath(n))}catch(o){throw this.toFileSystemProviderError(o)}}async delete(n,o){try{const a=this.toFilePath(n);await this.doDelete(a,o)}catch(a){throw this.toFileSystemProviderError(a)}}async doDelete(n,o){o.recursive?await T.Promises.rm(n,T.RimRafMode.MOVE):await T.Promises.unlink(n)}async rename(n,o,a){const h=this.toFilePath(n),m=this.toFilePath(o);if(h!==m)try{await this.validateTargetDeleted(n,o,"move",a.overwrite),await T.Promises.move(h,m)}catch(k){throw(k.code==="EINVAL"||k.code==="EBUSY"||k.code==="ENAMETOOLONG")&&(k=new Error((0,w.localize)(2,null,(0,L.basename)(h),(0,L.basename)((0,L.dirname)(m)),k.toString()))),this.toFileSystemProviderError(k)}}async copy(n,o,a){const h=this.toFilePath(n),m=this.toFilePath(o);if(h!==m)try{await this.validateTargetDeleted(n,o,"copy",a.overwrite),await T.Promises.copy(h,m,{preserveSymlinks:!0})}catch(k){throw(k.code==="EINVAL"||k.code==="EBUSY"||k.code==="ENAMETOOLONG")&&(k=new Error((0,w.localize)(3,null,(0,L.basename)(h),(0,L.basename)((0,L.dirname)(m)),k.toString()))),this.toFileSystemProviderError(k)}}async validateTargetDeleted(n,o,a,h){const m=this.toFilePath(n),k=this.toFilePath(o);let P=!1;if(!!(this.capabilities&1024)||(P=(0,d.isEqual)(m,k,!0)),P&&a==="copy")throw(0,O.createFileSystemProviderError)((0,w.localize)(4,null),O.FileSystemProviderErrorCode.FileExists);if(!P&&await T.Promises.exists(k)){if(!h)throw(0,O.createFileSystemProviderError)((0,w.localize)(5,null),O.FileSystemProviderErrorCode.FileExists);await this.delete(o,{recursive:!0,useTrash:!1})}}watch(n,o){return o.recursive?this.watchRecursive(n,o.excludes):this.watchNonRecursive(n)}watchRecursive(n,o){const a={path:this.toFilePath(n),excludes:o},h=(0,r.insert)(this.recursiveFoldersToWatch,a);return this.refreshRecursiveWatchers(),(0,g.toDisposable)(()=>{h(),this.refreshRecursiveWatchers()})}refreshRecursiveWatchers(){this.recursiveWatchRequestDelayer.trigger(async()=>{this.doRefreshRecursiveWatchers()})}doRefreshRecursiveWatchers(){if(this.recursiveWatcher instanceof R.FileWatcher)this.recursiveWatcher.setFolders(this.recursiveFoldersToWatch);else if((0,g.dispose)(this.recursiveWatcher),this.recursiveWatcher=void 0,this.recursiveFoldersToWatch.length>0){let n,o;this.options?.watcher?.usePolling?(n=l.FileWatcher,o=this.options?.watcher):this.recursiveFoldersToWatch.length===1?I.isWindows?n=u.FileWatcher:n=l.FileWatcher:n=R.FileWatcher,this.recursiveWatcher=new n(this.recursiveFoldersToWatch,a=>this._onDidChangeFile.fire((0,F.toFileChanges)(a)),a=>{a.type==="error"&&this._onDidWatchErrorOccur.fire(a.message),this.logService[a.type](a.message)},this.logService.getLevel()===p.LogLevel.Trace,o),this.recursiveWatcherLogLevelListener||(this.recursiveWatcherLogLevelListener=this.logService.onDidChangeLogLevel(()=>{this.recursiveWatcher&&this.recursiveWatcher.setVerboseLogging(this.logService.getLevel()===p.LogLevel.Trace)}))}}watchNonRecursive(n){const o=new b.FileWatcher(this.toFilePath(n),h=>this._onDidChangeFile.fire((0,F.toFileChanges)(h)),h=>{h.type==="error"&&this._onDidWatchErrorOccur.fire(h.message),this.logService[h.type](h.message)},this.logService.getLevel()===p.LogLevel.Trace),a=this.logService.onDidChangeLogLevel(()=>{o.setVerboseLogging(this.logService.getLevel()===p.LogLevel.Trace)});return(0,g.combinedDisposable)(o,a)}toFilePath(n){return(0,L.normalize)(n.fsPath)}toFileSystemProviderError(n){if(n instanceof O.FileSystemProviderError)return n;let o;switch(n.code){case"ENOENT":o=O.FileSystemProviderErrorCode.FileNotFound;break;case"EISDIR":o=O.FileSystemProviderErrorCode.FileIsADirectory;break;case"ENOTDIR":o=O.FileSystemProviderErrorCode.FileNotADirectory;break;case"EEXIST":o=O.FileSystemProviderErrorCode.FileExists;break;case"EPERM":case"EACCES":o=O.FileSystemProviderErrorCode.NoPermissions;break;default:o=O.FileSystemProviderErrorCode.Unknown}return(0,O.createFileSystemProviderError)(n,o)}async toFileSystemProviderWriteError(n,o){let a=this.toFileSystemProviderError(o);if(n&&a.code===O.FileSystemProviderErrorCode.NoPermissions)try{const{stat:h}=await T.SymlinkSupport.stat(this.toFilePath(n));h.mode&128||(a=(0,O.createFileSystemProviderError)(o,O.FileSystemProviderErrorCode.FileWriteLocked))}catch(h){this.logService.trace(h)}return a}dispose(){super.dispose(),(0,g.dispose)(this.recursiveWatcher),this.recursiveWatcher=void 0,(0,g.dispose)(this.recursiveWatcherLogLevelListener),this.recursiveWatcherLogLevelListener=void 0}}t.DiskFileSystemProvider=e}),define(Z[42],te([0,1,12]),function(q,t,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IProductService=void 0,t.IProductService=(0,g.createDecorator)("productService")}),define(Z[25],te([0,1,13,57]),function(q,t,g,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Registry=void 0;class E{constructor(){this.data=new Map}add(T,L){O.ok(g.isString(T)),O.ok(g.isObject(L)),O.ok(!this.data.has(T),"There is already an extension with this id"),this.data.set(T,L)}knows(T){return this.data.has(T)}as(T){return this.data.get(T)||null}}t.Registry=new E}),define(Z[109],te([0,1,25,14]),function(q,t,g,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Extensions=void 0,t.Extensions={JSONContribution:"base.contributions.json"};function E(L){return L.length>0&&L.charAt(L.length-1)==="#"?L.substring(0,L.length-1):L}class I{constructor(){this._onDidChangeSchema=new O.Emitter,this.onDidChangeSchema=this._onDidChangeSchema.event,this.schemasById={}}registerSchema(c,d){this.schemasById[E(c)]=d,this._onDidChangeSchema.fire(c)}notifySchemaChanged(c){this._onDidChangeSchema.fire(c)}getSchemaContributions(){return{schemas:this.schemasById}}}const T=new I;g.Registry.add(t.Extensions.JSONContribution,T)}),define(Z[30],te([0,1,73,14,25,13,109]),function(q,t,g,O,E,I,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getScopes=t.validateProperty=t.getDefaultValue=t.overrideIdentifierFromKey=t.OVERRIDE_PROPERTY_PATTERN=t.resourceLanguageSettingsSchemaId=t.resourceSettings=t.windowSettings=t.machineOverridableSettings=t.machineSettings=t.applicationSettings=t.allSettings=t.ConfigurationScope=t.Extensions=t.EditPresentationTypes=void 0;var L;(function(b){b.Multiline="multilineText",b.Singleline="singlelineText"})(L=t.EditPresentationTypes||(t.EditPresentationTypes={})),t.Extensions={Configuration:"base.contributions.configuration"};var c;(function(b){b[b.APPLICATION=1]="APPLICATION",b[b.MACHINE=2]="MACHINE",b[b.WINDOW=3]="WINDOW",b[b.RESOURCE=4]="RESOURCE",b[b.LANGUAGE_OVERRIDABLE=5]="LANGUAGE_OVERRIDABLE",b[b.MACHINE_OVERRIDABLE=6]="MACHINE_OVERRIDABLE"})(c=t.ConfigurationScope||(t.ConfigurationScope={})),t.allSettings={properties:{},patternProperties:{}},t.applicationSettings={properties:{},patternProperties:{}},t.machineSettings={properties:{},patternProperties:{}},t.machineOverridableSettings={properties:{},patternProperties:{}},t.windowSettings={properties:{},patternProperties:{}},t.resourceSettings={properties:{},patternProperties:{}},t.resourceLanguageSettingsSchemaId="vscode://schemas/settings/resourceLanguage";const d=E.Registry.as(T.Extensions.JSONContribution);class v{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new O.Emitter,this.onDidSchemaChange=this._onDidSchemaChange.event,this._onDidUpdateConfiguration=new O.Emitter,this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event,this.defaultValues={},this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:g.localize(0,null),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!1,errorMessage:"Unknown editor configuration setting",allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.excludedConfigurationProperties={},d.registerSchema(t.resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema)}registerConfiguration(D,f=!0){this.registerConfigurations([D],f)}registerConfigurations(D,f=!0){const r=[];D.forEach(s=>{r.push(...this.validateAndRegisterProperties(s,f,s.extensionInfo)),this.configurationContributors.push(s),this.registerJSONConfiguration(s)}),d.registerSchema(t.resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(r)}deregisterConfigurations(D){const f=[],r=s=>{if(s.properties)for(const e in s.properties)f.push(e),delete this.configurationProperties[e],this.removeFromSchema(e,s.properties[e]);s.allOf&&s.allOf.forEach(e=>r(e))};for(const s of D){r(s);const e=this.configurationContributors.indexOf(s);e!==-1&&this.configurationContributors.splice(e,1)}d.registerSchema(t.resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(f)}registerDefaultConfigurations(D){const f=[],r=[];for(const s of D)for(const e in s)if(f.push(e),t.OVERRIDE_PROPERTY_PATTERN.test(e)){this.defaultValues[e]={...this.defaultValues[e]||{},...s[e]};const i={type:"object",default:this.defaultValues[e],description:g.localize(1,null,e),$ref:t.resourceLanguageSettingsSchemaId};r.push(w(e)),this.configurationProperties[e]=i,this.defaultLanguageConfigurationOverridesNode.properties[e]=i}else{this.defaultValues[e]=s[e];const i=this.configurationProperties[e];i&&(this.updatePropertyDefaultValue(e,i),this.updateSchema(e,i))}this.registerOverrideIdentifiers(r),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(f)}deregisterDefaultConfigurations(D){const f=[];for(const r of D)for(const s in r)if(f.push(s),delete this.defaultValues[s],t.OVERRIDE_PROPERTY_PATTERN.test(s))delete this.configurationProperties[s],delete this.defaultLanguageConfigurationOverridesNode.properties[s];else{const e=this.configurationProperties[s];e&&(this.updatePropertyDefaultValue(s,e),this.updateSchema(s,e))}this.updateOverridePropertyPatternKey(),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(f)}notifyConfigurationSchemaUpdated(...D){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(D){for(const f of D)this.overrideIdentifiers.add(f);this.updateOverridePropertyPatternKey()}validateAndRegisterProperties(D,f=!0,r,s=3){s=I.isUndefinedOrNull(D.scope)?s:D.scope;let e=[],i=D.properties;if(i)for(let o in i){if(f&&u(o)){delete i[o];continue}const a=i[o];if(this.updatePropertyDefaultValue(o,a),t.OVERRIDE_PROPERTY_PATTERN.test(o)?a.scope=void 0:(a.scope=I.isUndefinedOrNull(a.scope)?s:a.scope,a.restricted=I.isUndefinedOrNull(a.restricted)?!!r?.restrictedConfigurations?.includes(o):a.restricted),i[o].hasOwnProperty("included")&&!i[o].included){this.excludedConfigurationProperties[o]=i[o],delete i[o];continue}else this.configurationProperties[o]=i[o];!i[o].deprecationMessage&&i[o].markdownDeprecationMessage&&(i[o].deprecationMessage=i[o].markdownDeprecationMessage),e.push(o)}let n=D.allOf;if(n)for(let o of n)e.push(...this.validateAndRegisterProperties(o,f,r,s));return e}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}registerJSONConfiguration(D){const f=r=>{let s=r.properties;if(s)for(const i in s)this.updateSchema(i,s[i]);let e=r.allOf;e&&e.forEach(f)};f(D)}updateSchema(D,f){switch(t.allSettings.properties[D]=f,f.scope){case 1:t.applicationSettings.properties[D]=f;break;case 2:t.machineSettings.properties[D]=f;break;case 6:t.machineOverridableSettings.properties[D]=f;break;case 3:t.windowSettings.properties[D]=f;break;case 4:t.resourceSettings.properties[D]=f;break;case 5:t.resourceSettings.properties[D]=f,this.resourceLanguageSettingsSchema.properties[D]=f;break}}removeFromSchema(D,f){switch(delete t.allSettings.properties[D],f.scope){case 1:delete t.applicationSettings.properties[D];break;case 2:delete t.machineSettings.properties[D];break;case 6:delete t.machineOverridableSettings.properties[D];break;case 3:delete t.windowSettings.properties[D];break;case 4:case 5:delete t.resourceSettings.properties[D];break}}updateOverridePropertyPatternKey(){for(const D of this.overrideIdentifiers.values()){const f=`[${D}]`,r={type:"object",description:g.localize(2,null),errorMessage:g.localize(3,null),$ref:t.resourceLanguageSettingsSchemaId};this.updatePropertyDefaultValue(f,r),t.allSettings.properties[f]=r,t.applicationSettings.properties[f]=r,t.machineSettings.properties[f]=r,t.machineOverridableSettings.properties[f]=r,t.windowSettings.properties[f]=r,t.resourceSettings.properties[f]=r}this._onDidSchemaChange.fire()}updatePropertyDefaultValue(D,f){let r=this.defaultValues[D];I.isUndefined(r)&&(r=f.default),I.isUndefined(r)&&(r=F(f.type)),f.default=r}}const p="\\[.*\\]$";t.OVERRIDE_PROPERTY_PATTERN=new RegExp(p);function w(b){return b.substring(1,b.length-1)}t.overrideIdentifierFromKey=w;function F(b){switch(Array.isArray(b)?b[0]:b){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}t.getDefaultValue=F;const l=new v;E.Registry.add(t.Extensions.Configuration,l);function u(b){return b.trim()?t.OVERRIDE_PROPERTY_PATTERN.test(b)?g.localize(5,null,b):l.getConfigurationProperties()[b]!==void 0?g.localize(6,null,b):null:g.localize(4,null)}t.validateProperty=u;function R(){const b=[],D=l.getConfigurationProperties();for(const f of Object.keys(D))b.push([f,D[f].scope]);return b.push(["launch",4]),b.push(["task",4]),b}t.getScopes=R}),define(Z[27],te([0,1,19,13,7,25,12,30]),function(q,t,g,O,E,I,T,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMigratedSettingValue=t.keyFromOverrideIdentifier=t.getDefaultValues=t.getConfigurationKeys=t.merge=t.getConfigurationValue=t.removeFromValueTree=t.addToValueTree=t.toValuesTree=t.toOverrides=t.compare=t.ConfigurationTargetToString=t.ConfigurationTarget=t.isConfigurationOverrides=t.IConfigurationService=void 0,t.IConfigurationService=(0,T.createDecorator)("configurationService");function c(i){return i&&typeof i=="object"&&(!i.overrideIdentifier||typeof i.overrideIdentifier=="string")&&(!i.resource||i.resource instanceof E.URI)}t.isConfigurationOverrides=c;var d;(function(i){i[i.USER=1]="USER",i[i.USER_LOCAL=2]="USER_LOCAL",i[i.USER_REMOTE=3]="USER_REMOTE",i[i.WORKSPACE=4]="WORKSPACE",i[i.WORKSPACE_FOLDER=5]="WORKSPACE_FOLDER",i[i.DEFAULT=6]="DEFAULT",i[i.MEMORY=7]="MEMORY"})(d=t.ConfigurationTarget||(t.ConfigurationTarget={}));function v(i){switch(i){case 1:return"USER";case 2:return"USER_LOCAL";case 3:return"USER_REMOTE";case 4:return"WORKSPACE";case 5:return"WORKSPACE_FOLDER";case 6:return"DEFAULT";case 7:return"MEMORY"}}t.ConfigurationTargetToString=v;function p(i,n){const o=n?i?n.keys.filter(x=>i.keys.indexOf(x)===-1):[...n.keys]:[],a=i?n?i.keys.filter(x=>n.keys.indexOf(x)===-1):[...i.keys]:[],h=[];if(n&&i){for(const x of i.keys)if(n.keys.indexOf(x)!==-1){const _=b(i.contents,x),J=b(n.contents,x);g.equals(_,J)||h.push(x)}}const m=[],k=x=>{const _={};for(const J of x)for(const ie of J.identifiers)_[s(ie)]=J;return _},P=n?k(n.overrides):{},N=i?k(i.overrides):{};if(Object.keys(P).length)for(const x of o){const _=P[x];_&&m.push([(0,L.overrideIdentifierFromKey)(x),_.keys])}if(Object.keys(N).length)for(const x of a){const _=N[x];_&&m.push([(0,L.overrideIdentifierFromKey)(x),_.keys])}if(Object.keys(P).length&&Object.keys(N).length)for(const x of h){const _=N[x],J=P[x];if(_&&J){const ie=p({contents:_.contents,keys:_.keys,overrides:[]},{contents:J.contents,keys:J.keys,overrides:[]});m.push([(0,L.overrideIdentifierFromKey)(x),[...ie.added,...ie.removed,...ie.updated]])}}return{added:o,removed:a,updated:h,overrides:m}}t.compare=p;function w(i,n){const o=[];for(const a of Object.keys(i))if(L.OVERRIDE_PROPERTY_PATTERN.test(a)){const h={};for(const m in i[a])h[m]=i[a][m];o.push({identifiers:[(0,L.overrideIdentifierFromKey)(a).trim()],keys:Object.keys(h),contents:F(h,n)})}return o}t.toOverrides=w;function F(i,n){const o=Object.create(null);for(let a in i)l(o,a,i[a],n);return o}t.toValuesTree=F;function l(i,n,o,a){const h=n.split("."),m=h.pop();let k=i;for(let P=0;P<h.length;P++){let N=h[P],x=k[N];switch(typeof x){case"undefined":x=k[N]=Object.create(null);break;case"object":break;default:a(`Ignoring ${n} as ${h.slice(0,P+1).join(".")} is ${JSON.stringify(x)}`);return}k=x}if(typeof k=="object"&&k!==null)try{k[m]=o}catch(P){a(`Ignoring ${n} as ${h.join(".")} is ${JSON.stringify(k)}`)}else a(`Ignoring ${n} as ${h.join(".")} is ${JSON.stringify(k)}`)}t.addToValueTree=l;function u(i,n){const o=n.split(".");R(i,o)}t.removeFromValueTree=u;function R(i,n){const o=n.shift();if(n.length===0){delete i[o];return}if(Object.keys(i).indexOf(o)!==-1){const a=i[o];typeof a=="object"&&!Array.isArray(a)&&(R(a,n),Object.keys(a).length===0&&delete i[o])}}function b(i,n,o){function a(k,P){let N=k;for(const x of P){if(typeof N!="object"||N===null)return;N=N[x]}return N}const h=n.split("."),m=a(i,h);return typeof m=="undefined"?o:m}t.getConfigurationValue=b;function D(i,n,o){Object.keys(n).forEach(a=>{a!=="__proto__"&&(a in i?O.isObject(i[a])&&O.isObject(n[a])?D(i[a],n[a],o):o&&(i[a]=n[a]):i[a]=n[a])})}t.merge=D;function f(){const i=I.Registry.as(L.Extensions.Configuration).getConfigurationProperties();return Object.keys(i)}t.getConfigurationKeys=f;function r(){const i=Object.create(null),n=I.Registry.as(L.Extensions.Configuration).getConfigurationProperties();for(let o in n){let a=n[o].default;l(i,o,a,h=>console.error(`Conflict in default settings: ${h}`))}return i}t.getDefaultValues=r;function s(i){return`[${i}]`}t.keyFromOverrideIdentifier=s;function e(i,n,o){const a=i.inspect(n),h=i.inspect(o);return typeof a.userValue!="undefined"||typeof a.workspaceValue!="undefined"||typeof a.workspaceFolderValue!="undefined"?a.value:typeof h.userValue!="undefined"||typeof h.workspaceValue!="undefined"||typeof h.workspaceFolderValue!="undefined"?h.value:a.defaultValue}t.getMigratedSettingValue=e}),define(Z[110],te([0,1,58,45,24,13,19,7,30,27,25,2,14]),function(q,t,g,O,E,I,T,L,c,d,v,p,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllKeysConfigurationChangeEvent=t.ConfigurationChangeEvent=t.mergeChanges=t.Configuration=t.UserSettings=t.ConfigurationModelParser=t.DefaultConfigurationModel=t.ConfigurationModel=void 0;class F{constructor(e={},i=[],n=[]){this._contents=e,this._keys=i,this._overrides=n,this.isFrozen=!1}get contents(){return this.checkAndFreeze(this._contents)}get overrides(){return this.checkAndFreeze(this._overrides)}get keys(){return this.checkAndFreeze(this._keys)}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?(0,d.getConfigurationValue)(this.contents,e):this.contents}getOverrideValue(e,i){const n=this.getContentsForOverrideIdentifer(i);return n?e?(0,d.getConfigurationValue)(n,e):n:void 0}getKeysForOverrideIdentifier(e){for(const i of this.overrides)if(i.identifiers.indexOf(e)!==-1)return i.keys;return[]}override(e){const i=this.getContentsForOverrideIdentifer(e);if(!i||typeof i!="object"||!Object.keys(i).length)return this;let n={};for(const o of E.distinct([...Object.keys(this.contents),...Object.keys(i)])){let a=this.contents[o],h=i[o];h&&(typeof a=="object"&&typeof h=="object"?(a=T.deepClone(a),this.mergeContents(a,h)):a=h),n[o]=a}return new F(n,this.keys,this.overrides)}merge(...e){const i=T.deepClone(this.contents),n=T.deepClone(this.overrides),o=[...this.keys];for(const a of e){this.mergeContents(i,a.contents);for(const h of a.overrides){const[m]=n.filter(k=>E.equals(k.identifiers,h.identifiers));m?this.mergeContents(m.contents,h.contents):n.push(T.deepClone(h))}for(const h of a.keys)o.indexOf(h)===-1&&o.push(h)}return new F(i,o,n)}freeze(){return this.isFrozen=!0,this}mergeContents(e,i){for(const n of Object.keys(i)){if(n in e&&I.isObject(e[n])&&I.isObject(i[n])){this.mergeContents(e[n],i[n]);continue}e[n]=T.deepClone(i[n])}}checkAndFreeze(e){return this.isFrozen&&!Object.isFrozen(e)?T.deepFreeze(e):e}getContentsForOverrideIdentifer(e){for(const i of this.overrides)if(i.identifiers.indexOf(e)!==-1)return i.contents;return null}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,i){this.addKey(e),(0,d.addToValueTree)(this.contents,e,i,n=>{throw new Error(n)})}removeValue(e){this.removeKey(e)&&(0,d.removeFromValueTree)(this.contents,e)}addKey(e){let i=this.keys.length;for(let n=0;n<i;n++)e.indexOf(this.keys[n])===0&&(i=n);this.keys.splice(i,1,e)}removeKey(e){let i=this.keys.indexOf(e);return i!==-1?(this.keys.splice(i,1),!0):!1}}t.ConfigurationModel=F;class l extends F{constructor(){const e=(0,d.getDefaultValues)(),i=(0,d.getConfigurationKeys)(),n=[];for(const o of Object.keys(e))c.OVERRIDE_PROPERTY_PATTERN.test(o)&&n.push({identifiers:[(0,c.overrideIdentifierFromKey)(o).trim()],keys:Object.keys(e[o]),contents:(0,d.toValuesTree)(e[o],a=>console.error(`Conflict in default settings file: ${a}`))});super(e,i,n)}}t.DefaultConfigurationModel=l;class u{constructor(e){this._name=e,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[],this._parseErrors=[]}get configurationModel(){return this._configurationModel||new F}get restrictedConfigurations(){return this._restrictedConfigurations}get errors(){return this._parseErrors}parse(e,i){if(!I.isUndefinedOrNull(e)){const n=this.doParseContent(e);this.parseRaw(n,i)}}reparse(e){this._raw&&this.parseRaw(this._raw,e)}parseRaw(e,i){this._raw=e;const{contents:n,keys:o,overrides:a,restricted:h}=this.doParseRaw(e,i);this._configurationModel=new F(n,o,a),this._restrictedConfigurations=h||[]}doParseContent(e){let i={},n=null,o=[],a=[],h=[];function m(P){Array.isArray(o)?o.push(P):n!==null&&(o[n]=P)}let k={onObjectBegin:()=>{let P={};m(P),a.push(o),o=P,n=null},onObjectProperty:P=>{n=P},onObjectEnd:()=>{o=a.pop()},onArrayBegin:()=>{let P=[];m(P),a.push(o),o=P,n=null},onArrayEnd:()=>{o=a.pop()},onLiteralValue:m,onError:(P,N,x)=>{h.push({error:P,offset:N,length:x})}};if(e)try{g.visit(e,k),i=o[0]||{}}catch(P){console.error(`Error while parsing settings file ${this._name}: ${P}`),this._parseErrors=[P]}return i}doParseRaw(e,i){const n=v.Registry.as(c.Extensions.Configuration).getConfigurationProperties(),o=this.filter(e,n,!0,i);e=o.raw;const a=(0,d.toValuesTree)(e,k=>console.error(`Conflict in settings file ${this._name}: ${k}`)),h=Object.keys(e),m=(0,d.toOverrides)(e,k=>console.error(`Conflict in settings file ${this._name}: ${k}`));return{contents:a,keys:h,overrides:m,restricted:o.restricted}}filter(e,i,n,o){if(!o?.scopes&&!o?.skipRestricted)return{raw:e,restricted:[]};const a={},h=[];for(let m in e)if(c.OVERRIDE_PROPERTY_PATTERN.test(m)&&n){const k=this.filter(e[m],i,!1,o);a[m]=k.raw,h.push(...k.restricted)}else{const k=i[m],P=k?typeof k.scope!="undefined"?k.scope:3:void 0;k?.restricted&&h.push(m),(P===void 0||o.scopes===void 0||o.scopes.includes(P))&&(o.skipRestricted&&k?.restricted||(a[m]=e[m]))}return{raw:a,restricted:h}}}t.ConfigurationModelParser=u;class R extends p.Disposable{constructor(e,i,n,o){super();this.userSettingsResource=e,this.scopes=i,this.fileService=o,this._onDidChange=this._register(new w.Emitter),this.onDidChange=this._onDidChange.event,this.parser=new u(this.userSettingsResource.toString()),this.parseOptions={scopes:this.scopes},this._register(this.fileService.watch(n.dirname(this.userSettingsResource))),this._register(this.fileService.watch(this.userSettingsResource)),this._register(w.Event.filter(this.fileService.onDidFilesChange,a=>a.contains(this.userSettingsResource))(()=>this._onDidChange.fire()))}async loadConfiguration(){try{const e=await this.fileService.readFile(this.userSettingsResource);return this.parser.parse(e.value.toString()||"{}",this.parseOptions),this.parser.configurationModel}catch(e){return new F}}reparse(){return this.parser.reparse(this.parseOptions),this.parser.configurationModel}getRestrictedSettings(){return this.parser.restrictedConfigurations}}t.UserSettings=R;class b{constructor(e,i,n=new F,o=new F,a=new O.ResourceMap,h=new F,m=new O.ResourceMap,k=!0){this._defaultConfiguration=e,this._localUserConfiguration=i,this._remoteUserConfiguration=n,this._workspaceConfiguration=o,this._folderConfigurations=a,this._memoryConfiguration=h,this._memoryConfigurationByResource=m,this._freeze=k,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new O.ResourceMap,this._userConfiguration=null}getValue(e,i,n){return this.getConsolidateConfigurationModel(i,n).getValue(e)}updateValue(e,i,n={}){let o;n.resource?(o=this._memoryConfigurationByResource.get(n.resource),o||(o=new F,this._memoryConfigurationByResource.set(n.resource,o))):o=this._memoryConfiguration,i===void 0?o.removeValue(e):o.setValue(e,i),n.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,i,n){const o=this.getConsolidateConfigurationModel(i,n),a=this.getFolderConfigurationModelForResource(i.resource,n),h=i.resource?this._memoryConfigurationByResource.get(i.resource)||this._memoryConfiguration:this._memoryConfiguration,m=i.overrideIdentifier?this._defaultConfiguration.freeze().override(i.overrideIdentifier).getValue(e):this._defaultConfiguration.freeze().getValue(e),k=i.overrideIdentifier?this.userConfiguration.freeze().override(i.overrideIdentifier).getValue(e):this.userConfiguration.freeze().getValue(e),P=i.overrideIdentifier?this.localUserConfiguration.freeze().override(i.overrideIdentifier).getValue(e):this.localUserConfiguration.freeze().getValue(e),N=i.overrideIdentifier?this.remoteUserConfiguration.freeze().override(i.overrideIdentifier).getValue(e):this.remoteUserConfiguration.freeze().getValue(e),x=n?i.overrideIdentifier?this._workspaceConfiguration.freeze().override(i.overrideIdentifier).getValue(e):this._workspaceConfiguration.freeze().getValue(e):void 0,_=a?i.overrideIdentifier?a.freeze().override(i.overrideIdentifier).getValue(e):a.freeze().getValue(e):void 0,J=i.overrideIdentifier?h.override(i.overrideIdentifier).getValue(e):h.getValue(e),ie=o.getValue(e),se=E.distinct(E.flatten(o.overrides.map(Y=>Y.identifiers))).filter(Y=>o.getOverrideValue(e,Y)!==void 0);return{defaultValue:m,userValue:k,userLocalValue:P,userRemoteValue:N,workspaceValue:x,workspaceFolderValue:_,memoryValue:J,value:ie,default:m!==void 0?{value:this._defaultConfiguration.freeze().getValue(e),override:i.overrideIdentifier?this._defaultConfiguration.freeze().getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,user:k!==void 0?{value:this.userConfiguration.freeze().getValue(e),override:i.overrideIdentifier?this.userConfiguration.freeze().getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,userLocal:P!==void 0?{value:this.localUserConfiguration.freeze().getValue(e),override:i.overrideIdentifier?this.localUserConfiguration.freeze().getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,userRemote:N!==void 0?{value:this.remoteUserConfiguration.freeze().getValue(e),override:i.overrideIdentifier?this.remoteUserConfiguration.freeze().getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,workspace:x!==void 0?{value:this._workspaceConfiguration.freeze().getValue(e),override:i.overrideIdentifier?this._workspaceConfiguration.freeze().getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,workspaceFolder:_!==void 0?{value:a?.freeze().getValue(e),override:i.overrideIdentifier?a?.freeze().getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,memory:J!==void 0?{value:h.getValue(e),override:i.overrideIdentifier?h.getOverrideValue(e,i.overrideIdentifier):void 0}:void 0,overrideIdentifiers:se.length?se:void 0}}keys(e){const i=this.getFolderConfigurationModelForResource(void 0,e);return{default:this._defaultConfiguration.freeze().keys,user:this.userConfiguration.freeze().keys,workspace:this._workspaceConfiguration.freeze().keys,workspaceFolder:i?i.freeze().keys:[]}}updateDefaultConfiguration(e){this._defaultConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(e){this._localUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(e){this._remoteUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(e){this._workspaceConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(e,i){this._folderConfigurations.set(e,i),this._foldersConsolidatedConfigurations.delete(e)}deleteFolderConfiguration(e){this.folderConfigurations.delete(e),this._foldersConsolidatedConfigurations.delete(e)}compareAndUpdateDefaultConfiguration(e,i){const n=i.filter(o=>c.OVERRIDE_PROPERTY_PATTERN.test(o)).map(o=>{const a=(0,c.overrideIdentifierFromKey)(o),h=this._defaultConfiguration.getKeysForOverrideIdentifier(a),m=e.getKeysForOverrideIdentifier(a),k=[...m.filter(P=>h.indexOf(P)===-1),...h.filter(P=>m.indexOf(P)===-1),...h.filter(P=>!T.equals(this._defaultConfiguration.override(a).getValue(P),e.override(a).getValue(P)))];return[a,k]});return this.updateDefaultConfiguration(e),{keys:i,overrides:n}}compareAndUpdateLocalUserConfiguration(e){const{added:i,updated:n,removed:o,overrides:a}=(0,d.compare)(this.localUserConfiguration,e),h=[...i,...n,...o];return h.length&&this.updateLocalUserConfiguration(e),{keys:h,overrides:a}}compareAndUpdateRemoteUserConfiguration(e){const{added:i,updated:n,removed:o,overrides:a}=(0,d.compare)(this.remoteUserConfiguration,e);let h=[...i,...n,...o];return h.length&&this.updateRemoteUserConfiguration(e),{keys:h,overrides:a}}compareAndUpdateWorkspaceConfiguration(e){const{added:i,updated:n,removed:o,overrides:a}=(0,d.compare)(this.workspaceConfiguration,e);let h=[...i,...n,...o];return h.length&&this.updateWorkspaceConfiguration(e),{keys:h,overrides:a}}compareAndUpdateFolderConfiguration(e,i){const n=this.folderConfigurations.get(e),{added:o,updated:a,removed:h,overrides:m}=(0,d.compare)(n,i);let k=[...o,...a,...h];return(k.length||!n)&&this.updateFolderConfiguration(e,i),{keys:k,overrides:m}}compareAndDeleteFolderConfiguration(e){const i=this.folderConfigurations.get(e);if(!i)throw new Error("Unknown folder");this.deleteFolderConfiguration(e);const{added:n,updated:o,removed:a,overrides:h}=(0,d.compare)(i,void 0);return{keys:[...n,...o,...a],overrides:h}}get defaults(){return this._defaultConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration),this._freeze&&this._userConfiguration.freeze()),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidateConfigurationModel(e,i){let n=this.getConsolidatedConfigurationModelForResource(e,i);return e.overrideIdentifier?n.override(e.overrideIdentifier):n}getConsolidatedConfigurationModelForResource({resource:e},i){let n=this.getWorkspaceConsolidatedConfiguration();if(i&&e){const o=i.getFolder(e);o&&(n=this.getFolderConsolidatedConfiguration(o.uri)||n);const a=this._memoryConfigurationByResource.get(e);a&&(n=n.merge(a))}return n}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration),this._freeze&&(this._workspaceConfiguration=this._workspaceConfiguration.freeze())),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let i=this._foldersConsolidatedConfigurations.get(e);if(!i){const n=this.getWorkspaceConsolidatedConfiguration(),o=this._folderConfigurations.get(e);o?(i=n.merge(o),this._freeze&&(i=i.freeze()),this._foldersConsolidatedConfigurations.set(e,i)):i=n}return i}getFolderConfigurationModelForResource(e,i){if(i&&e){const n=i.getFolder(e);if(n)return this._folderConfigurations.get(n.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,i)=>{const{contents:n,overrides:o,keys:a}=this._folderConfigurations.get(i);return e.push([i,{contents:n,overrides:o,keys:a}]),e},[])}}allKeys(){const e=new Set;return this._defaultConfiguration.freeze().keys.forEach(i=>e.add(i)),this.userConfiguration.freeze().keys.forEach(i=>e.add(i)),this._workspaceConfiguration.freeze().keys.forEach(i=>e.add(i)),this._folderConfigurations.forEach(i=>i.freeze().keys.forEach(n=>e.add(n))),[...e.values()]}getAllKeysForOverrideIdentifier(e){const i=new Set;return this._defaultConfiguration.getKeysForOverrideIdentifier(e).forEach(n=>i.add(n)),this.userConfiguration.getKeysForOverrideIdentifier(e).forEach(n=>i.add(n)),this._workspaceConfiguration.getKeysForOverrideIdentifier(e).forEach(n=>i.add(n)),this._folderConfigurations.forEach(n=>n.getKeysForOverrideIdentifier(e).forEach(o=>i.add(o))),[...i.values()]}static parse(e){const i=this.parseConfigurationModel(e.defaults),n=this.parseConfigurationModel(e.user),o=this.parseConfigurationModel(e.workspace),a=e.folders.reduce((h,m)=>(h.set(L.URI.revive(m[0]),this.parseConfigurationModel(m[1])),h),new O.ResourceMap);return new b(i,n,new F,o,a,new F,new O.ResourceMap,!1)}static parseConfigurationModel(e){return new F(e.contents,e.keys,e.overrides).freeze()}}t.Configuration=b;function D(...s){if(s.length===0)return{keys:[],overrides:[]};if(s.length===1)return s[0];const e=new Set,i=new Map;for(const o of s)o.keys.forEach(a=>e.add(a)),o.overrides.forEach(([a,h])=>{const m=(0,O.getOrSet)(i,a,new Set);h.forEach(k=>m.add(k))});const n=[];return i.forEach((o,a)=>n.push([a,[...o.values()]])),{keys:[...e.values()],overrides:n}}t.mergeChanges=D;class f{constructor(e,i,n,o){this.change=e,this.previous=i,this.currentConfiguraiton=n,this.currentWorkspace=o,this._previousConfiguration=void 0;const a=new Set;e.keys.forEach(m=>a.add(m)),e.overrides.forEach(([,m])=>m.forEach(k=>a.add(k))),this.affectedKeys=[...a.values()];const h=new F;this.affectedKeys.forEach(m=>h.setValue(m,{})),this.affectedKeysTree=h.contents}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=b.parse(this.previous.data)),this._previousConfiguration}affectsConfiguration(e,i){if(this.doesAffectedKeysTreeContains(this.affectedKeysTree,e)){if(i){const n=this.previousConfiguration?this.previousConfiguration.getValue(e,i,this.previous?.workspace):void 0,o=this.currentConfiguraiton.getValue(e,i,this.currentWorkspace);return!T.equals(n,o)}return!0}return!1}doesAffectedKeysTreeContains(e,i){let n=(0,d.toValuesTree)({[i]:!0},()=>{}),o;for(;typeof n=="object"&&(o=Object.keys(n)[0]);){if(e=e[o],!e)return!1;n=n[o]}return!0}}t.ConfigurationChangeEvent=f;class r extends f{constructor(e,i,n,o){super({keys:e.allKeys(),overrides:[]},void 0,e,i);this.source=n,this.sourceConfig=o}}t.AllKeysConfigurationChangeEvent=r}),define(Z[111],te([0,1,25,30,2,27,110,14,4,20]),function(q,t,g,O,E,I,T,L,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationService=void 0;class v extends E.Disposable{constructor(w,F){super();this.settingsResource=w,this._onDidChangeConfiguration=this._register(new L.Emitter),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this.userConfiguration=this._register(new T.UserSettings(this.settingsResource,void 0,d.extUriBiasedIgnorePathCase,F)),this.configuration=new T.Configuration(new T.DefaultConfigurationModel,new T.ConfigurationModel),this.reloadConfigurationScheduler=this._register(new c.RunOnceScheduler(()=>this.reloadConfiguration(),50)),this._register(g.Registry.as(O.Extensions.Configuration).onDidUpdateConfiguration(l=>this.onDidDefaultConfigurationChange(l))),this._register(this.userConfiguration.onDidChange(()=>this.reloadConfigurationScheduler.schedule()))}async initialize(){const w=await this.userConfiguration.loadConfiguration();this.configuration=new T.Configuration(new T.DefaultConfigurationModel,w)}getConfigurationData(){return this.configuration.toData()}getValue(w,F){const l=typeof w=="string"?w:void 0,u=(0,I.isConfigurationOverrides)(w)?w:(0,I.isConfigurationOverrides)(F)?F:{};return this.configuration.getValue(l,u,void 0)}updateValue(w,F,l,u){return Promise.reject(new Error("not supported"))}inspect(w){return this.configuration.inspect(w,{},void 0)}keys(){return this.configuration.keys(void 0)}async reloadConfiguration(){const w=await this.userConfiguration.loadConfiguration();this.onDidChangeUserConfiguration(w)}onDidChangeUserConfiguration(w){const F=this.configuration.toData(),l=this.configuration.compareAndUpdateLocalUserConfiguration(w);this.trigger(l,F,1)}onDidDefaultConfigurationChange(w){const F=this.configuration.toData(),l=this.configuration.compareAndUpdateDefaultConfiguration(new T.DefaultConfigurationModel,w);this.trigger(l,F,6)}trigger(w,F,l){const u=new T.ConfigurationChangeEvent(w,{data:F},this.configuration);u.source=l,u.sourceConfig=this.getTargetConfiguration(l),this._onDidChangeConfiguration.fire(u)}getTargetConfiguration(w){switch(w){case 6:return this.configuration.defaults.contents;case 1:return this.configuration.localUserConfiguration.contents}return{}}}t.ConfigurationService=v}),define(Z[55],te([0,1,84,12,30,25,16]),function(q,t,g,O,E,I,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateProxyConfigurationsScope=t.asJson=t.asText=t.isSuccess=t.IRequestService=void 0,t.IRequestService=(0,O.createDecorator)("requestService");function L(l){return l.res.statusCode&&l.res.statusCode>=200&&l.res.statusCode<300||l.res.statusCode===1223}t.isSuccess=L;function c(l){return l.res.statusCode===204}async function d(l){if(!L(l))throw new Error("Server returned "+l.res.statusCode);return c(l)?null:(await(0,T.streamToBuffer)(l.stream)).toString()}t.asText=d;async function v(l){if(!L(l))throw new Error("Server returned "+l.res.statusCode);if(c(l))return null;const R=(await(0,T.streamToBuffer)(l.stream)).toString();try{return JSON.parse(R)}catch(b){throw b.message+=`:
`+R,b}}t.asJson=v;function p(l){F(l)}t.updateProxyConfigurationsScope=p;let w;function F(l){const u=I.Registry.as(E.Extensions.Configuration);w&&u.deregisterConfigurations([w]),w={id:"http",order:15,title:(0,g.localize)(0,null),type:"object",scope:l,properties:{"http.proxy":{type:"string",pattern:"^https?://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",markdownDescription:(0,g.localize)(1,null),restricted:!0},"http.proxyStrictSSL":{type:"boolean",default:!0,description:(0,g.localize)(2,null),restricted:!0},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:(0,g.localize)(3,null),restricted:!0},"http.proxySupport":{type:"string",enum:["off","on","fallback","override"],enumDescriptions:[(0,g.localize)(4,null),(0,g.localize)(5,null),(0,g.localize)(6,null),(0,g.localize)(7,null)],default:"override",description:(0,g.localize)(8,null),restricted:!0},"http.systemCertificates":{type:"boolean",default:!0,description:(0,g.localize)(9,null),restricted:!0}}},u.registerConfiguration(w)}F(2)}),define(Z[112],te([0,1,113,13]),function(q,t,g,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProxyAgent=void 0;function E(T,L){return T.protocol==="http:"?L.HTTP_PROXY||L.http_proxy||null:T.protocol==="https:"&&(L.HTTPS_PROXY||L.https_proxy||L.HTTP_PROXY||L.http_proxy)||null}async function I(T,L,c={}){const d=(0,g.parse)(T),v=c.proxyUrl||E(d,L);if(!v)return null;const p=(0,g.parse)(v);if(!/^https?:$/.test(p.protocol||""))return null;const w={host:p.hostname||"",port:p.port||(p.protocol==="https"?"443":"80"),auth:p.auth,rejectUnauthorized:(0,O.isBoolean)(c.strictSSL)?c.strictSSL:!0};return d.protocol==="http:"?new(await new Promise((F,l)=>{q(["http-proxy-agent"],F,l)}))(w):new(await new Promise((F,l)=>{q(["https-proxy-agent"],F,l)}))(w)}t.getProxyAgent=I}),define(Z[114],te([0,1,29,16]),function(q,t,g,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getServiceMachineId=void 0;async function E(I,T,L){let c=L&&L.get("storage.serviceMachineId",0)||null;if(c)return c;try{const v=(await T.readFile(I.serviceMachineIdResource)).value.toString();c=(0,g.isUUID)(v)?v:null}catch(d){c=null}if(!c){c=(0,g.generateUuid)();try{await T.writeFile(I.serviceMachineIdResource,O.VSBuffer.fromString(c))}catch(d){}}return L&&L.store("storage.serviceMachineId",c,0,1),c}t.getServiceMachineId=E}),define(Z[115],te([0,1,12,14,2,13,66,4]),function(q,t,g,O,E,I,T,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logStorage=t.InMemoryStorageService=t.AbstractStorageService=t.StorageTarget=t.StorageScope=t.WillSaveStateReason=t.IStorageService=t.IS_NEW_KEY=void 0,t.IS_NEW_KEY="__$__isNewStorageMarker";const c="__$__targetStorageMarker";t.IStorageService=(0,g.createDecorator)("storageService");var d;(function(u){u[u.NONE=0]="NONE",u[u.SHUTDOWN=1]="SHUTDOWN"})(d=t.WillSaveStateReason||(t.WillSaveStateReason={}));var v;(function(u){u[u.GLOBAL=0]="GLOBAL",u[u.WORKSPACE=1]="WORKSPACE"})(v=t.StorageScope||(t.StorageScope={}));var p;(function(u){u[u.USER=0]="USER",u[u.MACHINE=1]="MACHINE"})(p=t.StorageTarget||(t.StorageTarget={}));class w extends E.Disposable{constructor(R={flushInterval:w.DEFAULT_FLUSH_INTERVAL}){super();this.options=R,this._onDidChangeValue=this._register(new O.PauseableEmitter),this.onDidChangeValue=this._onDidChangeValue.event,this._onDidChangeTarget=this._register(new O.PauseableEmitter),this.onDidChangeTarget=this._onDidChangeTarget.event,this._onWillSaveState=this._register(new O.Emitter),this.onWillSaveState=this._onWillSaveState.event,this.flushWhenIdleScheduler=this._register(new L.RunOnceScheduler(()=>this.doFlushWhenIdle(),this.options.flushInterval)),this.runFlushWhenIdle=this._register(new E.MutableDisposable),this._workspaceKeyTargets=void 0,this._globalKeyTargets=void 0}doFlushWhenIdle(){this.runFlushWhenIdle.value=(0,L.runWhenIdle)(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){(0,E.dispose)([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{await this.doInitialize(),this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(R,b){b===c?(R===0?this._globalKeyTargets=void 0:R===1&&(this._workspaceKeyTargets=void 0),this._onDidChangeTarget.fire({scope:R})):this._onDidChangeValue.fire({scope:R,key:b,target:this.getKeyTargets(R)[b]})}emitWillSaveState(R){this._onWillSaveState.fire({reason:R})}get(R,b,D){return this.getStorage(b)?.get(R,D)}getBoolean(R,b,D){return this.getStorage(b)?.getBoolean(R,D)}getNumber(R,b,D){return this.getStorage(b)?.getNumber(R,D)}store(R,b,D,f){if((0,I.isUndefinedOrNull)(b)){this.remove(R,D);return}this.withPausedEmitters(()=>{this.updateKeyTarget(R,D,f),this.getStorage(D)?.set(R,b)})}remove(R,b){this.withPausedEmitters(()=>{this.updateKeyTarget(R,b,void 0),this.getStorage(b)?.delete(R)})}withPausedEmitters(R){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{R()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(R,b){const D=[],f=this.getKeyTargets(R);for(const r of Object.keys(f))f[r]===b&&D.push(r);return D}updateKeyTarget(R,b,D){const f=this.getKeyTargets(b);typeof D=="number"?f[R]!==D&&(f[R]=D,this.getStorage(b)?.set(c,JSON.stringify(f))):typeof f[R]=="number"&&(delete f[R],this.getStorage(b)?.set(c,JSON.stringify(f)))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get globalKeyTargets(){return this._globalKeyTargets||(this._globalKeyTargets=this.loadKeyTargets(0)),this._globalKeyTargets}getKeyTargets(R){return R===0?this.globalKeyTargets:this.workspaceKeyTargets}loadKeyTargets(R){const b=this.get(c,R);if(b)try{return JSON.parse(b)}catch(D){}return Object.create(null)}isNew(R){return this.getBoolean(t.IS_NEW_KEY,R)===!0}async flush(){this._onWillSaveState.fire({reason:d.NONE}),await L.Promises.settled([this.getStorage(0)?.whenFlushed()??Promise.resolve(),this.getStorage(1)?.whenFlushed()??Promise.resolve()])}async logStorage(){const R=this.getStorage(0)?.items??new Map,b=this.getStorage(1)?.items??new Map;return l(R,b,this.getLogDetails(0)??"",this.getLogDetails(1)??"")}}t.AbstractStorageService=w,w.DEFAULT_FLUSH_INTERVAL=60*1e3;class F extends w{constructor(){super();this.globalStorage=this._register(new T.Storage(new T.InMemoryStorageDatabase)),this.workspaceStorage=this._register(new T.Storage(new T.InMemoryStorageDatabase)),this._register(this.workspaceStorage.onDidChangeStorage(R=>this.emitDidChangeValue(1,R))),this._register(this.globalStorage.onDidChangeStorage(R=>this.emitDidChangeValue(0,R)))}getStorage(R){return R===0?this.globalStorage:this.workspaceStorage}getLogDetails(R){return R===0?"inMemory (global)":"inMemory (workspace)"}async doInitialize(){}async migrate(R){}}t.InMemoryStorageService=F;async function l(u,R,b,D){const f=a=>{try{return JSON.parse(a)}catch(h){return a}},r=new Map,s=new Map;u.forEach((a,h)=>{r.set(h,a),s.set(h,f(a))});const e=new Map,i=new Map;R.forEach((a,h)=>{e.set(h,a),i.set(h,f(a))}),console.group(`Storage: Global (path: ${b})`);let n=[];r.forEach((a,h)=>{n.push({key:h,value:a})}),console.table(n),console.groupEnd(),console.log(s),console.group(`Storage: Workspace (path: ${D})`);let o=[];e.forEach((a,h)=>{o.push({key:h,value:a})}),console.table(o),console.groupEnd(),console.log(i)}t.logStorage=l}),define(Z[116],te([0,1,10,33,29,7]),function(q,t,g,O,E,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifyMicrosoftInternalDomain=t.resolveCommonProperties=void 0;function T(d){if(g.platform===2&&/^penguin(\.|$)/i.test(d))return"chromebook"}async function L(d,v,p,w,F,l,u,R,b,D){const f=Object.create(null);f["common.machineId"]=u,f.sessionID=(0,E.generateUuid)()+Date.now(),f.commitHash=F,f.version=l,f["common.platformVersion"]=(v||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),f["common.platform"]=(0,g.PlatformToString)(g.platform),f["common.nodePlatform"]=O.platform,f["common.nodeArch"]=w,f["common.product"]=D||"desktop";const r=c(R||[]);r&&(f["common.msftInternal"]=r);let s=0;const e=Date.now();Object.defineProperties(f,{timestamp:{get:()=>new Date,enumerable:!0},"common.timesincesessionstart":{get:()=>Date.now()-e,enumerable:!0},"common.sequence":{get:()=>s++,enumerable:!0}}),g.isLinuxSnap&&(f["common.snap"]="true");const i=T(p);i&&(f["common.platformDetail"]=i);try{const n=await d.readFile(I.URI.file(b));f["common.source"]=n.value.toString().slice(0,30)}catch(n){}return f}t.resolveCommonProperties=L;function c(d){const v=O.env.USERDNSDOMAIN;if(!v)return!1;const p=v.toLowerCase();return d.some(w=>p===w)}t.verifyMicrosoftInternalDomain=c}),define(Z[35],te([0,1,12]),function(q,t,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.machineIdKey=t.lastSessionDateStorageKey=t.firstSessionDateStorageKey=t.currentSessionDateStorageKey=t.instanceStorageKey=t.ICustomEndpointTelemetryService=t.ITelemetryService=void 0,t.ITelemetryService=(0,g.createDecorator)("telemetryService"),t.ICustomEndpointTelemetryService=(0,g.createDecorator)("customEndpointTelemetryService"),t.instanceStorageKey="telemetry.instanceId",t.currentSessionDateStorageKey="telemetry.currentSessionDate",t.firstSessionDateStorageKey="telemetry.firstSessionDate",t.lastSessionDateStorageKey="telemetry.lastSessionDate",t.machineIdKey="telemetry.machineId"}),define(Z[117],te([0,1,74,2,22,23,14,34,15,35,26,8,7,4,10]),function(q,t,g,O,E,I,T,L,c,d,v,p,w,F,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractExtensionTask=t.reportTelemetry=t.joinErrors=t.AbstractExtensionManagementService=t.INSTALL_ERROR_LOCAL=t.ERROR_UNKNOWN=t.INSTALL_ERROR_VALIDATING=void 0,t.INSTALL_ERROR_VALIDATING="validating",t.ERROR_UNKNOWN="unknown",t.INSTALL_ERROR_LOCAL="local";let u=class extends O.Disposable{constructor(r,s,e){super();this.galleryService=r,this.telemetryService=s,this.logService=e,this.lastReportTimestamp=0,this.installingExtensions=new Map,this.uninstallingExtensions=new Map,this._onInstallExtension=this._register(new T.Emitter),this.onInstallExtension=this._onInstallExtension.event,this._onDidInstallExtensions=this._register(new T.Emitter),this.onDidInstallExtensions=this._onDidInstallExtensions.event,this._onUninstallExtension=this._register(new T.Emitter),this.onUninstallExtension=this._onUninstallExtension.event,this._onDidUninstallExtension=this._register(new T.Emitter),this.onDidUninstallExtension=this._onDidUninstallExtension.event,this.participants=[],this._register((0,O.toDisposable)(()=>{this.installingExtensions.forEach(i=>i.cancel()),this.uninstallingExtensions.forEach(i=>i.cancel()),this.installingExtensions.clear(),this.uninstallingExtensions.clear()}))}async installFromGallery(r,s={}){if(!this.galleryService.isEnabled())throw new Error(g.localize(0,null));try{r=await this.checkAndGetCompatibleVersion(r)}catch(i){throw this.logService.error((0,p.getErrorMessage)(i)),b(this.telemetryService,"extensionGallery:install",(0,I.getGalleryExtensionTelemetryData)(r),void 0,i),i}if(!await this.canInstall(r)){const i=new E.ExtensionManagementError("Not supported",t.INSTALL_ERROR_VALIDATING);throw this.logService.error("Canno install extension as it is not supported.",r.identifier.id,i.message),b(this.telemetryService,"extensionGallery:install",(0,I.getGalleryExtensionTelemetryData)(r),void 0,i),i}const e=await this.galleryService.getManifest(r,v.CancellationToken.None);if(e===null){const i=new E.ExtensionManagementError(`Missing manifest for extension ${r.identifier.id}`,t.INSTALL_ERROR_VALIDATING);throw this.logService.error("Failed to install extension:",r.identifier.id,i.message),b(this.telemetryService,"extensionGallery:install",(0,I.getGalleryExtensionTelemetryData)(r),void 0,i),i}return this.installExtension(e,r,s)}async uninstall(r,s={}){return this.logService.trace("ExtensionManagementService#uninstall",r.identifier.id),this.unininstallExtension(r,s)}async reinstallFromGallery(r){if(this.logService.trace("ExtensionManagementService#reinstallFromGallery",r.identifier.id),!this.galleryService.isEnabled())throw new Error(g.localize(1,null));const s=await this.findGalleryExtension(r);if(!s)throw new Error(g.localize(2,null));await this.createUninstallExtensionTask(r,{remove:!0,versionOnly:!0}).run(),await this.installFromGallery(s)}getExtensionsReport(){const r=new Date().getTime();return(!this.reportedExtensions||r-this.lastReportTimestamp>1e3*60*5)&&(this.reportedExtensions=this.updateReportCache(),this.lastReportTimestamp=r),this.reportedExtensions}registerParticipant(r){this.participants.push(r)}async installExtension(r,s,e){if(!w.URI.isUri(s)){let h=this.installingExtensions.get(new I.ExtensionIdentifierWithVersion(s.identifier,s.version).key());if(h)return this.logService.info("Extensions is already requested to install",s.identifier.id),h.waitUntilTaskIsFinished();e={...e,installOnlyNewlyAddedFromExtensionPack:!0}}const i=[],n=[],o=this.createInstallExtensionTask(r,s,e);w.URI.isUri(s)||this.installingExtensions.set(new I.ExtensionIdentifierWithVersion(o.identifier,r.version).key(),o),this._onInstallExtension.fire({identifier:o.identifier,source:s}),this.logService.info("Installing extension:",o.identifier.id),i.push({task:o,manifest:r});let a=!1;try{if(e.donotIncludePackAndDependencies)this.logService.info("Installing the extension without checking dependencies and pack",o.identifier.id);else try{const m=await this.getAllDepsAndPackExtensionsToInstall(o.identifier,r,!!e.installOnlyNewlyAddedFromExtensionPack);for(const{gallery:k,manifest:P}of m)if(a=a||!!P.extensionDependencies?.some(N=>(0,I.areSameExtensions)({id:N},o.identifier)),this.installingExtensions.has(new I.ExtensionIdentifierWithVersion(k.identifier,k.version).key()))this.logService.info("Extension is already requested to install",k.identifier.id);else{const N=this.createInstallExtensionTask(P,k,{...e,donotIncludePackAndDependencies:!0});this.installingExtensions.set(new I.ExtensionIdentifierWithVersion(N.identifier,P.version).key(),N),this._onInstallExtension.fire({identifier:N.identifier,source:k}),this.logService.info("Installing extension:",N.identifier.id),i.push({task:N,manifest:P})}}catch(m){throw this.logService.error("Error while preparing to install dependencies and extension packs of the extension:",o.identifier.id),this.logService.error(m),m}const h=i.reduce((m,{task:k,manifest:P})=>(m.set(k.identifier.id.toLowerCase(),{task:k,manifest:P}),m),new Map);for(;h.size;){let m;const k=[...h.values()].filter(({manifest:P})=>!P.extensionDependencies?.some(N=>h.has(N.toLowerCase())));k.length?m=h.size===1?k:k.filter(({task:P})=>!(P===o&&!a)):(this.logService.info("Found extensions with circular dependencies",k.map(({task:P})=>P.identifier.id)),m=[...h.values()]),await this.joinAllSettled(m.map(async({task:P})=>{const N=new Date().getTime();try{const x=await P.run();if(await this.joinAllSettled(this.participants.map(_=>_.postInstall(x,P.source,e,v.CancellationToken.None))),!w.URI.isUri(P.source)&&(b(this.telemetryService,P.operation===2?"extensionGallery:update":"extensionGallery:install",(0,I.getGalleryExtensionTelemetryData)(P.source),new Date().getTime()-N,void 0),l.isWeb&&P.operation===1))try{await this.galleryService.reportStatistic(x.manifest.publisher,x.manifest.name,x.manifest.version,"install")}catch(_){}n.push({local:x,identifier:P.identifier,operation:P.operation,source:P.source})}catch(x){throw w.URI.isUri(P.source)||b(this.telemetryService,P.operation===2?"extensionGallery:update":"extensionGallery:install",(0,I.getGalleryExtensionTelemetryData)(P.source),new Date().getTime()-N,x),this.logService.error("Error while installing the extension:",P.identifier.id),this.logService.error(x),x}finally{h.delete(P.identifier.id.toLowerCase())}}))}return n.forEach(({identifier:m})=>this.logService.info("Extension installed successfully:",m.id)),this._onDidInstallExtensions.fire(n),n.filter(({identifier:m})=>(0,I.areSameExtensions)(m,o.identifier))[0].local}catch(h){if(i.forEach(({task:m})=>m.cancel()),n.length)try{const m=await Promise.allSettled(n.map(({local:k})=>this.createUninstallExtensionTask(k,{versionOnly:!0}).run()));for(let k=0;k<m.length;k++){const P=m[k],{identifier:N}=n[k];P.status==="fulfilled"?this.logService.info("Rollback: Uninstalled extension",N.id):this.logService.warn("Rollback: Error while uninstalling extension",N.id,(0,p.getErrorMessage)(P.reason))}}catch(m){this.logService.warn("Error while rolling back extensions",(0,p.getErrorMessage)(m),n.map(({identifier:k})=>k.id))}throw this.logService.error("Failed to install extension:",o.identifier.id,(0,p.getErrorMessage)(h)),this._onDidInstallExtensions.fire(i.map(({task:m})=>({identifier:m.identifier,operation:1,source:m.source}))),h instanceof Error&&(h.name=h&&h.code?h.code:t.ERROR_UNKNOWN),h}finally{for(const{task:h,manifest:m}of i)if(!w.URI.isUri(h.source)){const k=new I.ExtensionIdentifierWithVersion(h.identifier,m.version).key();this.installingExtensions.delete(k)||this.logService.warn("Installation task is not found in the cache",k)}}}async joinAllSettled(r){const s=[],e=[],i=await Promise.allSettled(r);for(const n of i)n.status==="fulfilled"?s.push(n.value):e.push(n.reason);if(e.length)throw R(e);return s}async getAllDepsAndPackExtensionsToInstall(r,s,e){if(!this.galleryService.isEnabled())return[];let i=await this.getInstalled();const n=[r,...i.map(h=>h.identifier)],o=[],a=async(h,m)=>{const k=m.extensionDependencies||[];if(m.extensionPack){const P=e?i.find(N=>(0,I.areSameExtensions)(N.identifier,h)):void 0;for(const N of m.extensionPack)P&&P.manifest.extensionPack&&P.manifest.extensionPack.some(x=>(0,I.areSameExtensions)({id:x},{id:N}))||k.every(x=>!(0,I.areSameExtensions)({id:x},{id:N}))&&k.push(N)}if(k.length){const P=[...n,...o.map(x=>x.gallery.identifier)],N=k.filter(x=>P.every(_=>!(0,I.areSameExtensions)(_,{id:x})));if(N.length){const x=await this.galleryService.query({names:N,pageSize:k.length},v.CancellationToken.None);for(const _ of x.firstPage){if(P.find(se=>(0,I.areSameExtensions)(se,_.identifier)))continue;const J=await this.checkAndGetCompatibleVersion(_);if(!await this.canInstall(J)){this.logService.info("Skipping the extension as it cannot be installed",J.identifier.id);continue}const ie=await this.galleryService.getManifest(J,v.CancellationToken.None);if(ie===null)throw new E.ExtensionManagementError(`Missing manifest for extension ${J.identifier.id}`,t.INSTALL_ERROR_VALIDATING);o.push({gallery:J,manifest:ie}),await a(J.identifier,ie)}}}};return await a(r,s),i=await this.getInstalled(),o.filter(h=>!i.some(m=>(0,I.areSameExtensions)(m.identifier,h.gallery.identifier)))}async checkAndGetCompatibleVersion(r){if(await this.isMalicious(r))throw new E.ExtensionManagementError(g.localize(3,null,r.identifier.id),E.INSTALL_ERROR_MALICIOUS);const s=await this.galleryService.getCompatibleExtension(r);if(!s)throw new E.ExtensionManagementError(g.localize(4,null,r.identifier.id,L.default.version),E.INSTALL_ERROR_INCOMPATIBLE);return s}async isMalicious(r){const s=await this.getExtensionsReport();return(0,I.getMaliciousExtensionsSet)(s).has(r.identifier.id)}async unininstallExtension(r,s){const e=this.uninstallingExtensions.get(r.identifier.id.toLowerCase());if(e)return this.logService.info("Extensions is already requested to uninstall",r.identifier.id),e.waitUntilTaskIsFinished();const i=(h,m)=>{const k=this.createUninstallExtensionTask(h,m);return this.uninstallingExtensions.set(k.extension.identifier.id.toLowerCase(),k),this.logService.info("Uninstalling extension:",h.identifier.id),this._onUninstallExtension.fire(h.identifier),k},n=(h,m)=>{m?this.logService.error("Failed to uninstall extension:",h.identifier.id,m.message):this.logService.info("Successfully uninstalled extension:",h.identifier.id),b(this.telemetryService,"extensionGallery:uninstall",(0,I.getLocalExtensionTelemetryData)(h),void 0,m),this._onDidUninstallExtension.fire({identifier:h.identifier,error:m?.code})},o=[],a=[];try{o.push(i(r,{}));const h=await this.getInstalled(1);if(s.donotIncludePack)this.logService.info("Uninstalling the extension without including packed extension",r.identifier.id);else{const m=this.getAllPackExtensionsToUninstall(r,h);for(const k of m)this.uninstallingExtensions.has(k.identifier.id.toLowerCase())?this.logService.info("Extensions is already requested to uninstall",k.identifier.id):o.push(i(k,{}))}s.donotCheckDependents?this.logService.info("Uninstalling the extension without checking dependents",r.identifier.id):this.checkForDependents(o.map(m=>m.extension),h,r),await this.joinAllSettled(o.map(async m=>{try{if(await m.run(),await this.joinAllSettled(this.participants.map(k=>k.postUninstall(m.extension,s,v.CancellationToken.None))),m.extension.identifier.uuid)try{await this.galleryService.reportStatistic(m.extension.manifest.publisher,m.extension.manifest.name,m.extension.manifest.version,"uninstall")}catch(k){}n(m.extension)}catch(k){const P=k instanceof E.ExtensionManagementError?k:new E.ExtensionManagementError((0,p.getErrorMessage)(k),t.ERROR_UNKNOWN);throw n(m.extension,P),P}finally{a.push(m)}}))}catch(h){const m=h instanceof E.ExtensionManagementError?h:new E.ExtensionManagementError((0,p.getErrorMessage)(h),t.ERROR_UNKNOWN);for(const k of o){try{k.cancel()}catch(P){}a.includes(k)||n(k.extension,m)}throw m}finally{for(const h of o)this.uninstallingExtensions.delete(h.extension.identifier.id.toLowerCase())||this.logService.warn("Uninstallation task is not found in the cache",h.extension.identifier.id)}}checkForDependents(r,s,e){for(const i of r){const n=this.getDependents(i,s);if(n.length){const o=n.filter(a=>r.indexOf(a)===-1);if(o.length)throw new Error(this.getDependentsErrorMessage(i,o,e))}}}getDependentsErrorMessage(r,s,e){return e===r?s.length===1?g.localize(5,null,e.manifest.displayName||e.manifest.name,s[0].manifest.displayName||s[0].manifest.name):s.length===2?g.localize(6,null,e.manifest.displayName||e.manifest.name,s[0].manifest.displayName||s[0].manifest.name,s[1].manifest.displayName||s[1].manifest.name):g.localize(7,null,e.manifest.displayName||e.manifest.name,s[0].manifest.displayName||s[0].manifest.name,s[1].manifest.displayName||s[1].manifest.name):s.length===1?g.localize(8,null,e.manifest.displayName||e.manifest.name,r.manifest.displayName||r.manifest.name,s[0].manifest.displayName||s[0].manifest.name):s.length===2?g.localize(9,null,e.manifest.displayName||e.manifest.name,r.manifest.displayName||r.manifest.name,s[0].manifest.displayName||s[0].manifest.name,s[1].manifest.displayName||s[1].manifest.name):g.localize(10,null,e.manifest.displayName||e.manifest.name,r.manifest.displayName||r.manifest.name,s[0].manifest.displayName||s[0].manifest.name,s[1].manifest.displayName||s[1].manifest.name)}getAllPackExtensionsToUninstall(r,s,e=[]){if(e.indexOf(r)!==-1)return[];e.push(r);const i=r.manifest.extensionPack?r.manifest.extensionPack:[];if(i.length){const n=s.filter(a=>!a.isBuiltin&&i.some(h=>(0,I.areSameExtensions)({id:h},a.identifier))),o=[];for(const a of n)o.push(...this.getAllPackExtensionsToUninstall(a,s,e));return[...n,...o]}return[]}getDependents(r,s){return s.filter(e=>e.manifest.extensionDependencies&&e.manifest.extensionDependencies.some(i=>(0,I.areSameExtensions)({id:i},r.identifier)))}async findGalleryExtension(r){if(r.identifier.uuid){const s=await this.findGalleryExtensionById(r.identifier.uuid);return s||this.findGalleryExtensionByName(r.identifier.id)}return this.findGalleryExtensionByName(r.identifier.id)}async findGalleryExtensionById(r){return(await this.galleryService.query({ids:[r],pageSize:1},v.CancellationToken.None)).firstPage[0]}async findGalleryExtensionByName(r){return(await this.galleryService.query({names:[r],pageSize:1},v.CancellationToken.None)).firstPage[0]}async updateReportCache(){try{this.logService.trace("ExtensionManagementService.refreshReportedCache");const r=await this.galleryService.getExtensionsReport();return this.logService.trace(`ExtensionManagementService.refreshReportedCache - got ${r.length} reported extensions from service`),r}catch(r){return this.logService.trace("ExtensionManagementService.refreshReportedCache - failed to get extension report"),[]}}};u=ue([fe(0,E.IExtensionGalleryService),fe(1,d.ITelemetryService),fe(2,c.ILogService)],u),t.AbstractExtensionManagementService=u;function R(f){const r=Array.isArray(f)?f:[f];return r.length===1?r[0]instanceof Error?r[0]:new Error(r[0]):r.reduce((s,e)=>new Error(`${s.message}${s.message?",":""}${e instanceof Error?e.message:e}`),new Error(""))}t.joinErrors=R;function b(f,r,s,e,i){const n=i?i instanceof E.ExtensionManagementError?i.code:t.ERROR_UNKNOWN:void 0;f.publicLogError(r,{...s,success:!i,duration:e,errorcode:n})}t.reportTelemetry=b;class D{constructor(){this.barrier=new F.Barrier}async waitUntilTaskIsFinished(){return await this.barrier.wait(),this.cancellablePromise}async run(){return this.cancellablePromise||(this.cancellablePromise=(0,F.createCancelablePromise)(r=>this.doRun(r))),this.barrier.open(),this.cancellablePromise}cancel(){this.cancellablePromise||(this.cancellablePromise=(0,F.createCancelablePromise)(r=>new Promise((s,e)=>{const i=r.onCancellationRequested(()=>{i.dispose(),e((0,p.canceled)())})})),this.barrier.open()),this.cancellablePromise.cancel()}}t.AbstractExtensionTask=D}),define(Z[118],te([0,1,8,22,23,19,35,55,49,21,26,15,17,7,42,115,114,12,10]),function(q,t,g,O,E,I,T,L,c,d,v,p,w,F,l,u,R,b,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveMarketplaceHeaders=t.ExtensionGalleryService=void 0;var f;(function(B){B[B.None=0]="None",B[B.IncludeVersions=1]="IncludeVersions",B[B.IncludeFiles=2]="IncludeFiles",B[B.IncludeCategoryAndTags=4]="IncludeCategoryAndTags",B[B.IncludeSharedAccounts=8]="IncludeSharedAccounts",B[B.IncludeVersionProperties=16]="IncludeVersionProperties",B[B.ExcludeNonValidated=32]="ExcludeNonValidated",B[B.IncludeInstallationTargets=64]="IncludeInstallationTargets",B[B.IncludeAssetUri=128]="IncludeAssetUri",B[B.IncludeStatistics=256]="IncludeStatistics",B[B.IncludeLatestVersionOnly=512]="IncludeLatestVersionOnly",B[B.Unpublished=4096]="Unpublished"})(f||(f={}));function r(...B){return String(B.reduce((W,U)=>W|U,0))}var s;(function(B){B[B.Tag=1]="Tag",B[B.ExtensionId=4]="ExtensionId",B[B.Category=5]="Category",B[B.ExtensionName=7]="ExtensionName",B[B.Target=8]="Target",B[B.Featured=9]="Featured",B[B.SearchText=10]="SearchText",B[B.ExcludeWithFlags=12]="ExcludeWithFlags"})(s||(s={}));const e={Icon:"Microsoft.VisualStudio.Services.Icons.Default",Details:"Microsoft.VisualStudio.Services.Content.Details",Changelog:"Microsoft.VisualStudio.Services.Content.Changelog",Manifest:"Microsoft.VisualStudio.Code.Manifest",VSIX:"Microsoft.VisualStudio.Services.VSIXPackage",License:"Microsoft.VisualStudio.Services.Content.License",Repository:"Microsoft.VisualStudio.Services.Links.Source"},i={Dependency:"Microsoft.VisualStudio.Code.ExtensionDependencies",ExtensionPack:"Microsoft.VisualStudio.Code.ExtensionPack",Engine:"Microsoft.VisualStudio.Code.Engine",LocalizedLanguages:"Microsoft.VisualStudio.Code.LocalizedLanguages",WebExtension:"Microsoft.VisualStudio.Code.WebExtension"},o={pageNumber:1,pageSize:10,sortBy:0,sortOrder:0,flags:f.None,criteria:[],assetTypes:[]};class a{constructor(W=o){this.state=W}get pageNumber(){return this.state.pageNumber}get pageSize(){return this.state.pageSize}get sortBy(){return this.state.sortBy}get sortOrder(){return this.state.sortOrder}get flags(){return this.state.flags}withPage(W,U=this.state.pageSize){return new a({...this.state,pageNumber:W,pageSize:U})}withFilter(W,...U){const S=[...this.state.criteria,...U.length?U.map(M=>({filterType:W,value:M})):[{filterType:W}]];return new a({...this.state,criteria:S})}withSortBy(W){return new a({...this.state,sortBy:W})}withSortOrder(W){return new a({...this.state,sortOrder:W})}withFlags(...W){return new a({...this.state,flags:W.reduce((U,S)=>U|S,0)})}withAssetTypes(...W){return new a({...this.state,assetTypes:W})}get raw(){const{criteria:W,pageNumber:U,pageSize:S,sortBy:M,sortOrder:y,flags:A,assetTypes:C}=this.state;return{filters:[{criteria:W,pageNumber:U,pageSize:S,sortBy:M,sortOrder:y}],assetTypes:C,flags:A}}get searchText(){const W=this.state.criteria.filter(U=>U.filterType===s.SearchText)[0];return W&&W.value?W.value:""}get telemetryData(){return{filterTypes:this.state.criteria.map(W=>String(W.filterType)),sortBy:String(this.sortBy),sortOrder:String(this.sortOrder)}}}function h(B,W){const U=(B||[]).filter(S=>S.statisticName===W)[0];return U?U.value:0}function m(B){const W="Microsoft.VisualStudio.Code.Translation.";return B.files.filter(S=>S.assetType.indexOf(W)===0).reduce((S,M)=>{const y=x(B,M.assetType);return y&&S.push([M.assetType.substring(W.length),y]),S},[])}function k(B){if(B.properties){const W=B.properties.filter(M=>M.key===e.Repository),U=new RegExp("((git|ssh|http(s)?)|(git@[\\w.]+))(:(//)?)([\\w.@:/\\-~]+)(.git)(/)?"),S=W.filter(M=>U.test(M.value))[0];return S?{uri:S.value,fallbackUri:S.value}:null}return x(B,e.Repository)}function P(B){return{uri:`${B.fallbackAssetUri}/${e.VSIX}?redirect=true`,fallbackUri:`${B.fallbackAssetUri}/${e.VSIX}`}}function N(B){const W=x(B,e.Icon);if(W)return W;const U=O.DefaultIconPath;return{uri:U,fallbackUri:U}}function x(B,W){return B.files.filter(S=>S.assetType===W)[0]?{uri:`${B.assetUri}/${W}`,fallbackUri:`${B.fallbackAssetUri}/${W}`}:null}function _(B,W){const U=B.properties?B.properties.filter(M=>M.key===W):[],S=U.length>0&&U[0].value;return S?S.split(",").map(M=>(0,E.adoptToGalleryExtensionId)(M)):[]}function J(B){const W=B.properties?B.properties.filter(U=>U.key===i.Engine):[];return W.length>0&&W[0].value||""}function ie(B){const W=B.properties?B.properties.filter(S=>S.key===i.LocalizedLanguages):[],U=W.length>0&&W[0].value||"";return U?U.split(","):[]}function se(B){return B.indexOf("preview")!==-1}function Y(B,W,U,S,M){const y={manifest:x(W,e.Manifest),readme:x(W,e.Details),changelog:x(W,e.Changelog),license:x(W,e.License),repository:k(W),download:P(W),icon:N(W),coreTranslations:m(W)};return{identifier:{id:(0,E.getGalleryExtensionId)(B.publisher.publisherName,B.extensionName),uuid:B.extensionId},name:B.extensionName,version:W.version,date:W.lastUpdated,displayName:B.displayName,publisherId:B.publisher.publisherId,publisher:B.publisher.publisherName,publisherDisplayName:B.publisher.displayName,description:B.shortDescription||"",installCount:h(B.statistics,"install"),rating:h(B.statistics,"averagerating"),ratingCount:h(B.statistics,"ratingcount"),assetUri:F.URI.parse(W.assetUri),categories:B.categories||[],tags:B.tags||[],releaseDate:Date.parse(B.releaseDate),lastUpdated:Date.parse(B.lastUpdated),webExtension:!!B.tags?.includes(O.WEB_EXTENSION_TAG),assetTypes:W.files.map(({assetType:A})=>A),assets:y,properties:{dependencies:_(W,i.Dependency),extensionPack:_(W,i.ExtensionPack),engine:J(W),localizedLanguages:ie(W)},telemetryData:{index:(S.pageNumber-1)*S.pageSize+U,querySource:M},preview:se(B.flags)}}let X=class{constructor(W,U,S,M,y,A,C){this.requestService=W,this.logService=U,this.environmentService=S,this.telemetryService=M,this.fileService=y,this.productService=A;const z=A.extensionsGallery;this.extensionsGalleryUrl=z&&z.serviceUrl,this.extensionsControlUrl=z&&z.controlUrl,this.commonHeadersPromise=Q(A.version,this.environmentService,this.fileService,C)}api(W=""){return`${this.extensionsGalleryUrl}${W}`}isEnabled(){return!!this.extensionsGalleryUrl}async getExtensions(W,U){const S=[];let{total:M,firstPage:y,getPage:A}=await this.query({names:W,pageSize:W.length},U);S.push(...y);for(let C=1;S.length<M&&(y=await A(C,U),y.length);C++)S.push(...y);return S}async getCompatibleExtension(W,U){return this.getCompatibleExtensionByEngine(W,U)}async getCompatibleExtensionByEngine(W,U){const S=(0,O.isIExtensionIdentifier)(W)?null:W;if(S&&S.properties.engine&&(0,c.isEngineValid)(S.properties.engine,this.productService.version,this.productService.date))return S;const{id:M,uuid:y}=S?S.identifier:W;let A=new a().withFlags(f.IncludeAssetUri,f.IncludeStatistics,f.IncludeCategoryAndTags,f.IncludeFiles,f.IncludeVersionProperties).withPage(1,1).withFilter(s.Target,"Microsoft.VisualStudio.Code");y?A=A.withFilter(s.ExtensionId,y):A=A.withFilter(s.ExtensionName,M);const{galleryExtensions:C}=await this.queryGallery(A,v.CancellationToken.None),[z]=C;if(!z||!z.versions.length)return null;if(U){const $=z.versions.filter(H=>H.version===U)[0];if($){const H=Y(z,$,0,A);if(H.properties.engine&&(0,c.isEngineValid)(H.properties.engine,this.productService.version,this.productService.date))return H}return null}const j=await this.getLastValidExtensionVersion(z,z.versions);return j?Y(z,j,0,A):null}async query(W,U){const S=v.CancellationToken.isCancellationToken(W)?{}:W,M=v.CancellationToken.isCancellationToken(W)?W:U;if(!this.isEnabled())throw new Error("No extension gallery service configured.");let y=S.text||"";const A=(0,I.getOrDefault)(S,ee=>ee.pageSize,50);let C=new a().withFlags(f.IncludeLatestVersionOnly,f.IncludeAssetUri,f.IncludeStatistics,f.IncludeCategoryAndTags,f.IncludeFiles,f.IncludeVersionProperties).withPage(1,A).withFilter(s.Target,"Microsoft.VisualStudio.Code");y?(y=y.replace(/\bcategory:("([^"]*)"|([^"]\S*))(\s+|\b|$)/g,(ee,ne,re)=>(C=C.withFilter(s.Category,re||ne),"")),y=y.replace(/\btag:("([^"]*)"|([^"]\S*))(\s+|\b|$)/g,(ee,ne,re)=>(C=C.withFilter(s.Tag,re||ne),"")),y=y.replace(/\bfeatured(\s+|\b|$)/g,()=>(C=C.withFilter(s.Featured),"")),y=y.trim(),y&&(y=y.length<200?y:y.substring(0,200),C=C.withFilter(s.SearchText,y)),C=C.withSortBy(0)):S.ids?C=C.withFilter(s.ExtensionId,...S.ids):S.names?C=C.withFilter(s.ExtensionName,...S.names):C=C.withSortBy(4),typeof S.sortBy=="number"&&(C=C.withSortBy(S.sortBy)),typeof S.sortOrder=="number"&&(C=C.withSortOrder(S.sortOrder));const{galleryExtensions:z,total:j}=await this.queryGallery(C,M),$=z.map((ee,ne)=>Y(ee,ee.versions[0],ne,C,S.source)),H=async(ee,ne)=>{if(ne.isCancellationRequested)throw(0,g.canceled)();const re=C.withPage(ee+1),{galleryExtensions:ce}=await this.queryGallery(re,ne);return ce.map((me,be)=>Y(me,me.versions[0],be,re,S.source))};return{firstPage:$,total:j,pageSize:C.pageSize,getPage:H}}async queryGallery(W,U){if(!this.isEnabled())throw new Error("No extension gallery service configured.");W=W.withFlags(W.flags,f.ExcludeNonValidated).withFilter(s.ExcludeWithFlags,r(f.Unpublished));const S=await this.commonHeadersPromise,M=JSON.stringify(W.raw),y={...S,"Content-Type":"application/json",Accept:"application/json;api-version=3.0-preview.1","Accept-Encoding":"gzip","Content-Length":String(M.length)},A=new Date().getTime();let C,z,j=0;try{if(C=await this.requestService.request({type:"POST",url:this.api("/extensionquery"),data:M,headers:y},U),C.res.statusCode&&C.res.statusCode>=400&&C.res.statusCode<500)return{galleryExtensions:[],total:j};const $=await(0,L.asJson)(C);if($){const H=$.results[0],ee=H.extensions,ne=H.resultMetadata&&H.resultMetadata.filter(re=>re.metadataType==="ResultCount")[0];return j=ne&&ne.metadataItems.filter(re=>re.name==="TotalCount")[0].count||0,{galleryExtensions:ee,total:j}}return{galleryExtensions:[],total:j}}catch($){throw z=$,$}finally{this.telemetryService.publicLog2("galleryService:query",{...W.telemetryData,requestBodySize:String(M.length),duration:new Date().getTime()-A,success:!!C&&(0,L.isSuccess)(C),responseBodySize:C?.res.headers["Content-Length"],statusCode:C?String(C.res.statusCode):void 0,errorCode:z?(0,g.isPromiseCanceledError)(z)?"canceled":(0,g.getErrorMessage)(z).startsWith("XHR timeout")?"timeout":"failed":void 0,count:String(j)})}}async reportStatistic(W,U,S,M){if(!this.isEnabled())return;const y=D.isWeb?this.api(`/itemName/${W}.${U}/version/${S}/statType/${M==="install"?"1":"3"}/vscodewebextension`):this.api(`/publishers/${W}/extensions/${U}/${S}/stats?statType=${M}`),A=D.isWeb?"api-version=6.1-preview.1":"*/*;api-version=4.0-preview.1",z={...await this.commonHeadersPromise,Accept:A};try{await this.requestService.request({type:"POST",url:y,headers:z},v.CancellationToken.None)}catch(j){}}async download(W,U,S){this.logService.trace("ExtensionGalleryService#download",W.identifier.id);const M=(0,E.getGalleryExtensionTelemetryData)(W),y=new Date().getTime(),A=$=>this.telemetryService.publicLog("galleryService:downloadVSIX",{...M,duration:$}),C=S===1?"install":S===2?"update":"",z=C?{uri:`${W.assets.download.uri}&${C}=true`,fallbackUri:`${W.assets.download.fallbackUri}?${C}=true`}:W.assets.download,j=await this.getAsset(z);await this.fileService.writeFile(U,j.stream),A(new Date().getTime()-y)}async getReadme(W,U){if(W.assets.readme){const S=await this.getAsset(W.assets.readme,{},U);return await(0,L.asText)(S)||""}return""}async getManifest(W,U){if(W.assets.manifest){const S=await this.getAsset(W.assets.manifest,{},U),M=await(0,L.asText)(S);return M?JSON.parse(M):null}return null}async getCoreTranslation(W,U){const S=W.assets.coreTranslations.filter(M=>M[0]===U.toUpperCase())[0];if(S){const M=await this.getAsset(S[1]),y=await(0,L.asText)(M);return y?JSON.parse(y):null}return null}async getChangelog(W,U){if(W.assets.changelog){const S=await this.getAsset(W.assets.changelog,{},U);return await(0,L.asText)(S)||""}return""}async getAllVersions(W,U){let S=new a().withFlags(f.IncludeVersions,f.IncludeCategoryAndTags,f.IncludeFiles,f.IncludeVersionProperties).withPage(1,1).withFilter(s.Target,"Microsoft.VisualStudio.Code");W.identifier.uuid?S=S.withFilter(s.ExtensionId,W.identifier.uuid):S=S.withFilter(s.ExtensionName,W.identifier.id);const M=[],{galleryExtensions:y}=await this.queryGallery(S,v.CancellationToken.None);return y.length&&(U?await Promise.all(y[0].versions.map(async A=>{let C;try{C=await this.getEngine(A)}catch(z){}C&&(0,c.isEngineValid)(C,this.productService.version,this.productService.date)&&M.push({version:A.version,date:A.lastUpdated})})):M.push(...y[0].versions.map(A=>({version:A.version,date:A.lastUpdated})))),M}async getAsset(W,U={},S=v.CancellationToken.None){const M=await this.commonHeadersPromise,y={type:"GET"},A={...M,...U.headers||{}};U={...U,...y,headers:A};const C=W.uri,z=W.fallbackUri,j={...U,url:C};try{const $=await this.requestService.request(j,S);if($.res.statusCode===200)return $;const H=await(0,L.asText)($);throw new Error(`Expected 200, got back ${$.res.statusCode} instead.

${H}`)}catch($){if((0,g.isPromiseCanceledError)($))throw $;const H=(0,g.getErrorMessage)($);this.telemetryService.publicLog2("galleryService:cdnFallback",{url:C,message:H});const ee={...U,url:z};return this.requestService.request(ee,S)}}async getLastValidExtensionVersion(W,U){const S=this.getLastValidExtensionVersionFromProperties(W,U);return S||this.getLastValidExtensionVersionRecursively(W,U)}getLastValidExtensionVersionFromProperties(W,U){for(const S of U){const M=J(S);if(!M)return null;if((0,c.isEngineValid)(M,this.productService.version,this.productService.date))return S}return null}async getEngine(W){const U=J(W);if(U)return U;const S=x(W,e.Manifest);if(!S)throw new Error("Manifest was not found");const M={"Accept-Encoding":"gzip"},y=await this.getAsset(S,{headers:M}),A=await(0,L.asJson)(y);if(A)return A.engines.vscode;throw new Error("Error while reading manifest")}async getLastValidExtensionVersionRecursively(W,U){if(!U.length)return null;const S=U[0],M=await this.getEngine(S);return(0,c.isEngineValid)(M,this.productService.version,this.productService.date)?{...S,properties:[...S.properties||[],{key:i.Engine,value:M}]}:this.getLastValidExtensionVersionRecursively(W,U.slice(1))}async getExtensionsReport(){if(!this.isEnabled())throw new Error("No extension gallery service configured.");if(!this.extensionsControlUrl)return[];const W=await this.requestService.request({type:"GET",url:this.extensionsControlUrl},v.CancellationToken.None);if(W.res.statusCode!==200)throw new Error("Could not get extensions report.");const U=await(0,L.asJson)(W),S=new Map;if(U)for(const M of U.malicious){const y=S.get(M)||{id:{id:M},malicious:!0,slow:!1};y.malicious=!0,S.set(M,y)}return[...S.values()]}};X=ue([fe(0,L.IRequestService),fe(1,p.ILogService),fe(2,d.IEnvironmentService),fe(3,T.ITelemetryService),fe(4,w.IFileService),fe(5,l.IProductService),fe(6,(0,b.optional)(u.IStorageService))],X),t.ExtensionGalleryService=X;async function Q(B,W,U,S){const M={"X-Market-Client-Id":`VSCode ${B}`,"User-Agent":`VSCode ${B}`},y=await(0,R.getServiceMachineId)(W,U,S);return M["X-Market-User-Id"]=y,M}t.resolveMarketplaceHeaders=Q}),define(Z[119],te([0,1,34,85,18,12,27,30,2,19,25]),function(q,t,g,O,E,I,T,L,c,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryService=void 0;let p=class{constructor(l,u){this._configurationService=u,this._experimentProperties={},this._disposables=new c.DisposableStore,this._cleanupPatterns=[],this._appender=l.appender,this._commonProperties=l.commonProperties||Promise.resolve({}),this._piiPaths=l.piiPaths||[],this._userOptIn=!0,this._enabled=!0,this.sendErrorTelemetry=!!l.sendErrorTelemetry,this._cleanupPatterns=[/file:\/\/\/.*?\/resources\/app\//gi];for(let R of this._piiPaths)this._cleanupPatterns.push(new RegExp((0,E.escapeRegExpCharacters)(R),"gi"));this._configurationService&&(this._updateUserOptIn(),this._configurationService.onDidChangeConfiguration(this._updateUserOptIn,this,this._disposables),this.publicLog2("optInStatus",{optIn:this._userOptIn}),this._commonProperties.then(R=>{const b=/^[a-f0-9]+$/i.test(R["common.machineId"]);this.publicLog2("machineIdFallback",{usingFallbackGuid:!b})}))}setExperimentProperty(l,u){this._experimentProperties[l]=u}setEnabled(l){this._enabled=l}_updateUserOptIn(){const l=this._configurationService?.getValue(w);this._userOptIn=l?l.enableTelemetry:this._userOptIn}get isOptedIn(){return this._userOptIn&&this._enabled}async getTelemetryInfo(){const l=await this._commonProperties;let u=l.sessionID,R=l["common.instanceId"],b=l["common.machineId"],D=l["common.firstSessionDate"],f=l["common.msftInternal"];return{sessionId:u,instanceId:R,machineId:b,firstSessionDate:D,msftInternal:f}}dispose(){this._disposables.dispose()}publicLog(l,u,R){return this.isOptedIn?this._commonProperties.then(b=>{u=(0,d.mixin)(u,b),u=(0,d.mixin)(u,this._experimentProperties),u=(0,d.cloneAndChange)(u,D=>{if(typeof D=="string")return this._cleanupInfo(D,R)}),this._appender.log(l,u)},b=>{console.error(b)}):Promise.resolve(void 0)}publicLog2(l,u,R){return this.publicLog(l,u,R)}publicLogError(l,u){return this.sendErrorTelemetry?this.publicLog(l,u,!0):Promise.resolve(void 0)}publicLogError2(l,u){return this.publicLogError(l,u)}_cleanupInfo(l,u){let R=l;if(u){const b=[];for(let s of this._cleanupPatterns)for(;;){const e=s.exec(l);if(!e)break;b.push([e.index,s.lastIndex])}const D=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,f=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let r=0;for(R="";;){const s=f.exec(l);if(!s)break;!D.test(s[0])&&b.every(([e,i])=>s.index<e||s.index>=i)&&(R+=l.substring(r,s.index)+"<REDACTED: user-file-path>",r=f.lastIndex)}r<l.length&&(R+=l.substr(r))}for(let b of this._cleanupPatterns)R=R.replace(b,"");return R}};p.IDLE_START_EVENT_NAME="UserIdleStart",p.IDLE_STOP_EVENT_NAME="UserIdleStop",p=ue([fe(1,(0,I.optional)(T.IConfigurationService))],p),t.TelemetryService=p;const w="telemetry";v.Registry.as(L.Extensions.Configuration).registerConfiguration({id:w,order:110,type:"object",title:(0,O.localize)(0,null),properties:{"telemetry.enableTelemetry":{type:"boolean",markdownDescription:g.default.privacyStatementUrl?(0,O.localize)(2,null,g.default.nameLong,g.default.privacyStatementUrl):(0,O.localize)(1,null,g.default.nameLong),default:!0,restricted:!0,scope:1,tags:["usesOnlineServices","telemetry"]}}})}),define(Z[56],te([0,1,27,19,13,4]),function(q,t,g,O,E,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cleanRemoteAuthority=t.validateTelemetryData=t.configurationTelemetry=t.NullAppender=t.combinedAppender=t.NullEndpointTelemetryService=t.NullTelemetryService=void 0,t.NullTelemetryService=new class{constructor(){this.sendErrorTelemetry=!1,this.isOptedIn=!0}publicLog(l,u){return Promise.resolve(void 0)}publicLog2(l,u){return this.publicLog(l,u)}publicLogError(l,u){return Promise.resolve(void 0)}publicLogError2(l,u){return this.publicLogError(l,u)}setExperimentProperty(){}setEnabled(){}getTelemetryInfo(){return Promise.resolve({instanceId:"someValue.instanceId",sessionId:"someValue.sessionId",machineId:"someValue.machineId",firstSessionDate:"someValue.firstSessionDate"})}};class T{async publicLog(u,R,b){}async publicLogError(u,R,b){}}t.NullEndpointTelemetryService=T;function L(...l){return{log:(u,R)=>l.forEach(b=>b.log(u,R)),flush:()=>I.Promises.settled(l.map(u=>u.flush())),productIdentifier:l.find(u=>u.productIdentifier!==void 0)?.productIdentifier}}t.combinedAppender=L,t.NullAppender={log:()=>null,flush:()=>Promise.resolve(null)};function c(l,u){return u.onDidChangeConfiguration(R=>{R.source!==6&&l.publicLog2("updateConfiguration",{configurationSource:(0,g.ConfigurationTargetToString)(R.source),configurationKeys:w(R.sourceConfig)})})}t.configurationTelemetry=c;function d(l){const u=Object.create(null),R=Object.create(null),b=Object.create(null);p(l,b);for(let D in b){D=D.length>150?D.substr(D.length-149):D;const f=b[D];typeof f=="number"?R[D]=f:typeof f=="boolean"?R[D]=f?1:0:typeof f=="string"?u[D]=f.substring(0,1023):typeof f!="undefined"&&f!==null&&(u[D]=f)}return{properties:u,measurements:R}}t.validateTelemetryData=d;function v(l){if(!l)return"none";let u="other";return["ssh-remote","dev-container","attached-container","wsl"].forEach(b=>{l.indexOf(`${b}+`)===0&&(u=b)}),u}t.cleanRemoteAuthority=v;function p(l,u,R=0,b){if(!!l)for(let D of Object.getOwnPropertyNames(l)){const f=l[D],r=b?b+D:D;Array.isArray(f)?u[r]=(0,O.safeStringify)(f):f instanceof Date?u[r]=f.toISOString():(0,E.isObject)(f)?R<2?p(f,u,R+1,r+"."):u[r]=(0,O.safeStringify)(f):u[r]=f}}function w(l){if(!l)return[];const u=[];return F(u,"",l),u}function F(l,u,R){R&&typeof R=="object"&&!Array.isArray(R)?Object.keys(R).forEach(b=>F(l,u?`${u}.${b}`:b,R[b])):l.push(u)}}),define(Z[120],te([0,1,8,19,56]),function(q,t,g,O,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppInsightsAppender=void 0;async function I(L){const c=await new Promise((v,p)=>{q(["applicationinsights"],v,p)});let d;return c.defaultClient?(d=new c.TelemetryClient(L),d.channel.setUseDiskRetryCaching(!0)):(c.setup(L).setAutoCollectRequests(!1).setAutoCollectPerformance(!1).setAutoCollectExceptions(!1).setAutoCollectDependencies(!1).setAutoDependencyCorrelation(!1).setAutoCollectConsole(!1).setInternalLogging(!1,!1).setUseDiskRetryCaching(!0).start(),d=c.defaultClient),L.indexOf("AIF-")===0&&(d.config.endpointUrl="https://vortex.data.microsoft.com/collect/v1"),d}class T{constructor(c,d,v){this._eventPrefix=c,this._defaultData=d,this._defaultData||(this._defaultData=Object.create(null)),typeof v=="function"?this._aiClient=v():this._aiClient=v,this._asyncAIClient=null}_withAIClient(c){if(!!this._aiClient){if(typeof this._aiClient!="string"){c(this._aiClient);return}this._asyncAIClient||(this._asyncAIClient=I(this._aiClient)),this._asyncAIClient.then(d=>{c(d)},d=>{(0,g.onUnexpectedError)(d),console.error(d)})}}log(c,d){!this._aiClient||(d=(0,O.mixin)(d,this._defaultData),d=(0,E.validateTelemetryData)(d),this._withAIClient(v=>v.trackEvent({name:this._eventPrefix+"/"+c,properties:d.properties,measurements:d.measurements})))}flush(){return this._aiClient?new Promise(c=>{this._withAIClient(d=>{d.flush({callback:()=>{this._aiClient=void 0,c(void 0)}})})}):Promise.resolve(void 0)}}t.AppInsightsAppender=T}),define(Z[121],te([0,1,11,3]),function(q,t,g,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildTelemetryMessage=void 0;async function E(I,T){const L=Object.create(null),c=(v,p)=>{const w=JSON.parse(v);L[p]=w};if(T){const v=[],p=await g.Promises.readdir(T);for(const F of p)try{(await g.Promises.stat((0,O.join)(T,F))).isDirectory()&&v.push(F)}catch{}const w=[];for(const F of v)(await g.Promises.readdir((0,O.join)(T,F))).filter(u=>u==="telemetry.json").length===1&&w.push(F);for(const F of w){const l=(await g.Promises.readFile((0,O.join)(T,F,"telemetry.json"))).toString();c(l,F)}}let d=(await g.Promises.readFile((0,O.join)(I,"telemetry-core.json"))).toString();return c(d,"vscode-core"),d=(await g.Promises.readFile((0,O.join)(I,"telemetry-extensions.json"))).toString(),c(d,"vscode-extensions"),JSON.stringify(L,null,4)}t.buildTelemetryMessage=E}),define(Z[43],te([0,1,72,3,38,4,11,132,133,13]),function(q,t,g,O,E,I,T,L,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buffer=t.extract=t.zip=t.ExtractError=void 0;class v extends Error{constructor(e,i){let n=i.message;switch(e){case"CorruptZip":n=`Corrupt ZIP: ${n}`;break}super(n);this.type=e,this.cause=i}}t.ExtractError=v;function p(s){const e=s.externalFileAttributes>>16||33188;return[448,56,7].map(i=>e&i).reduce((i,n)=>i+n,e&61440)}function w(s){if(s instanceof v)return s;let e;return/end of central directory record signature not found/.test(s.message)&&(e="CorruptZip"),new v(e,s)}function F(s,e,i,n,o,a){const h=O.dirname(e),m=O.join(n,h);if(!m.startsWith(n))return Promise.reject(new Error(g.localize(0,null,e)));const k=O.join(n,e);let P;return a.onCancellationRequested(()=>{P&&P.destroy()}),Promise.resolve(T.Promises.mkdir(m,{recursive:!0})).then(()=>new Promise((N,x)=>{if(!a.isCancellationRequested)try{P=(0,E.createWriteStream)(k,{mode:i}),P.once("close",()=>N()),P.once("error",x),s.once("error",x),s.pipe(P)}catch(_){x(_)}}))}function l(s,e,i,n){let o=(0,I.createCancelablePromise)(()=>Promise.resolve()),a=0;return n.onCancellationRequested(()=>{o.cancel(),s.close()}),new Promise((h,m)=>{const k=new I.Sequencer,P=N=>{N.isCancellationRequested||(a++,s.readEntry())};s.once("error",m),s.once("close",()=>o.then(()=>{n.isCancellationRequested||s.entryCount===a?h():m(new v("Incomplete",new Error(g.localize(1,null,a,s.entryCount))))},m)),s.readEntry(),s.on("entry",N=>{if(n.isCancellationRequested)return;if(!i.sourcePathRegex.test(N.fileName)){P(n);return}const x=N.fileName.replace(i.sourcePathRegex,"");if(/\/$/.test(x)){const ie=O.join(e,x);o=(0,I.createCancelablePromise)(se=>T.Promises.mkdir(ie,{recursive:!0}).then(()=>P(se)).then(void 0,m));return}const _=R(s,N),J=p(N);o=(0,I.createCancelablePromise)(ie=>k.queue(()=>_.then(se=>F(se,x,J,e,i,ie).then(()=>P(ie)))).then(null,m))})})}function u(s,e=!1){return new Promise((i,n)=>{(0,L.open)(s,e?{lazyEntries:!0}:void 0,(o,a)=>{o?n(w(o)):i((0,d.assertIsDefined)(a))})})}function R(s,e){return new Promise((i,n)=>{s.openReadStream(e,(o,a)=>{o?n(w(o)):i((0,d.assertIsDefined)(a))})})}function b(s,e){return new Promise((i,n)=>{const o=new c.ZipFile;e.forEach(h=>{h.contents?o.addBuffer(typeof h.contents=="string"?Buffer.from(h.contents,"utf8"):h.contents,h.path):h.localPath&&o.addFile(h.localPath,h.path)}),o.end();const a=(0,E.createWriteStream)(s);o.outputStream.pipe(a),o.outputStream.once("error",n),a.once("error",n),a.once("finish",()=>i(s))})}t.zip=b;function D(s,e,i={},n){const o=new RegExp(i.sourcePath?`^${i.sourcePath}`:"");let a=u(s,!0);return i.overwrite&&(a=a.then(h=>T.Promises.rm(e).then(()=>h))),a.then(h=>l(h,e,{sourcePathRegex:o},n))}t.extract=D;function f(s,e){return u(s).then(i=>new Promise((n,o)=>{i.on("entry",a=>{a.fileName===e&&R(i,a).then(h=>n(h),h=>o(h))}),i.once("close",()=>o(new Error(g.localize(2,null,e))))}))}function r(s,e){return f(s,e).then(i=>new Promise((n,o)=>{const a=[];i.once("error",o),i.on("data",h=>a.push(h)),i.on("end",()=>n(Buffer.concat(a)))}))}t.buffer=r}),define(Z[122],te([0,1,43,78]),function(q,t,g,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getManifest=void 0;function E(I){return(0,g.buffer)(I,"extension/package.json").then(T=>{try{return JSON.parse(T.toString("utf8"))}catch(L){throw new Error((0,O.localize)(0,null))}})}t.getManifest=E}),define(Z[123],te([0,1,41,2,11,3,15,22,23,4,7,21,90,79,42,43,10,24,9,17,20,29,8]),function(q,t,g,O,E,I,T,L,c,d,v,p,w,F,l,u,R,b,D,f,r,s,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsScanner=void 0;const i="scanningSystem",n="scanningUser",o="extracting",a="deleting",h="renaming";let m=class extends O.Disposable{constructor(P,N,x,_,J){super();this.beforeRemovingExtension=P,this.fileService=N,this.logService=x,this.environmentService=_,this.productService=J,this._devSystemExtensionsPath=null,this.systemExtensionsPath=_.builtinExtensionsPath,this.extensionsPath=_.extensionsPath,this.uninstalledPath=I.join(this.extensionsPath,".obsolete"),this.uninstalledFileLimiter=new d.Queue}async cleanUp(){await this.removeUninstalledExtensions(),await this.removeOutdatedExtensions()}async scanExtensions(P){const N=[];(P===null||P===0)&&N.push(this.scanSystemExtensions().then(null,x=>Promise.reject(new L.ExtensionManagementError(this.joinErrors(x).message,i)))),(P===null||P===1)&&N.push(this.scanUserExtensions(!0).then(null,x=>Promise.reject(new L.ExtensionManagementError(this.joinErrors(x).message,n))));try{const x=await Promise.all(N);return(0,b.flatten)(x)}catch(x){throw this.joinErrors(x)}}async scanUserExtensions(P){this.logService.trace("Started scanning user extensions");let[N,x]=await Promise.all([this.getUninstalledExtensions(),this.scanAllUserExtensions()]);return x=x.filter(_=>!N[new c.ExtensionIdentifierWithVersion(_.identifier,_.manifest.version).key()]),P&&(x=(0,c.groupByExtension)(x,J=>J.identifier).map(J=>J.sort((ie,se)=>g.rcompare(ie.manifest.version,se.manifest.version))[0])),this.logService.trace("Scanned user extensions:",x.length),x}async scanAllUserExtensions(){return this.scanExtensionsInDir(this.extensionsPath,1)}async extractUserExtension(P,N,x){const _=P.key(),J=I.join(this.extensionsPath,`.${(0,s.generateUuid)()}`),ie=I.join(this.extensionsPath,_);try{await E.Promises.rm(ie)}catch(Y){try{await E.Promises.rm(ie)}catch(X){}throw new L.ExtensionManagementError((0,F.localize)(0,null,ie,P.id),a)}await this.extractAtLocation(P,N,J,x);let se=await this.scanExtension(v.URI.file(J),1);if(!se)throw new Error((0,F.localize)(1,null,J));await this.storeMetadata(se,{installedTimestamp:Date.now()});try{await this.rename(P,J,ie,Date.now()+2*60*1e3),this.logService.info("Renamed to",ie)}catch(Y){try{await E.Promises.rm(J)}catch(X){}if(Y.code==="ENOTEMPTY")this.logService.info("Rename failed because extension was installed by another source. So ignoring renaming.",P.id);else throw this.logService.info(`Rename failed because of ${(0,e.getErrorMessage)(Y)}. Deleted from extracted location`,J),Y}try{se=await this.scanExtension(v.URI.file(ie),1)}catch(Y){}if(se)return se;throw new Error((0,F.localize)(2,null,this.extensionsPath))}async saveMetadataForLocalExtension(P,N){return this.setMetadata(P,N),await this.storeMetadata(P,{...N,installedTimestamp:P.installedTimestamp}),P}async storeMetadata(P,N){N.isMachineScoped=N.isMachineScoped||void 0,N.isBuiltin=N.isBuiltin||void 0,N.installedTimestamp=N.installedTimestamp||void 0;const x=I.join(P.location.fsPath,"package.json"),_=await E.Promises.readFile(x,"utf8"),{manifest:J}=await this.parseManifest(_);return J.__metadata=N,await E.Promises.writeFile(x,JSON.stringify(J,null,"	")),P}getUninstalledExtensions(){return this.withUninstalledExtensions()}async setUninstalled(...P){const N=P.map(x=>new c.ExtensionIdentifierWithVersion(x.identifier,x.manifest.version));await this.withUninstalledExtensions(x=>{N.forEach(_=>x[_.key()]=!0)})}async setInstalled(P){await this.withUninstalledExtensions(_=>delete _[P.key()]);const x=(await this.scanExtensions(1)).find(_=>new c.ExtensionIdentifierWithVersion(_.identifier,_.manifest.version).equals(P))||null;return x?(await this.storeMetadata(x,{installedTimestamp:Date.now()}),this.scanExtension(x.location,1)):null}async withUninstalledExtensions(P){return this.uninstalledFileLimiter.queue(async()=>{let N;try{N=await E.Promises.readFile(this.uninstalledPath,"utf8")}catch(_){if(_.code!=="ENOENT")throw _}let x={};if(N)try{x=JSON.parse(N)}catch(_){}return P&&(P(x),Object.keys(x).length?await E.Promises.writeFile(this.uninstalledPath,JSON.stringify(x)):await E.Promises.rm(this.uninstalledPath)),x})}async removeExtension(P,N){this.logService.trace(`Deleting ${N} extension from disk`,P.identifier.id,P.location.fsPath),await E.Promises.rm(P.location.fsPath),this.logService.info("Deleted from disk",P.identifier.id,P.location.fsPath)}async removeUninstalledExtension(P){await this.removeExtension(P,"uninstalled"),await this.withUninstalledExtensions(N=>delete N[new c.ExtensionIdentifierWithVersion(P.identifier,P.manifest.version).key()])}async extractAtLocation(P,N,x,_){this.logService.trace(`Started extracting the extension from ${N} to ${x}`);try{await E.Promises.rm(x)}catch(J){throw new L.ExtensionManagementError(this.joinErrors(J).message,a)}try{await(0,u.extract)(N,x,{sourcePath:"extension",overwrite:!0},_),this.logService.info(`Extracted extension to ${x}:`,P.id)}catch(J){try{await E.Promises.rm(x)}catch(ie){}throw new L.ExtensionManagementError(J.message,J instanceof u.ExtractError&&J.type?J.type:o)}}async rename(P,N,x,_){try{await E.Promises.rename(N,x)}catch(J){if(R.isWindows&&J&&J.code==="EPERM"&&Date.now()<_)return this.logService.info(`Failed renaming ${N} to ${x} with 'EPERM' error. Trying again...`,P.id),this.rename(P,N,x,_);throw new L.ExtensionManagementError(J.message||(0,F.localize)(3,null,N,x),J.code||h)}}async scanSystemExtensions(){this.logService.trace("Started scanning system extensions");const P=this.scanDefaultSystemExtensions();if(this.environmentService.isBuilt)return P;const N=this.scanDevSystemExtensions(),[x,_]=await Promise.all([P,N]);return[...x,..._]}async scanExtensionsInDir(P,N){const x=new d.Limiter(10),_=await this.fileService.resolve(v.URI.file(P));return _.children?(await Promise.all(_.children.filter(ie=>ie.isDirectory).map(ie=>x.queue(async()=>N===1&&(0,r.basename)(ie.resource).indexOf(".")===0?null:this.scanExtension(ie.resource,N))))).filter(ie=>ie&&ie.identifier):[]}async scanExtension(P,N){try{const x=await this.fileService.resolve(P);if(x.children){const{manifest:_,metadata:J}=await this.readManifest(P.fsPath),ie=x.children.find(({name:Q})=>/^readme(\.txt|\.md|)$/i.test(Q))?.resource,se=x.children.find(({name:Q})=>/^changelog(\.txt|\.md|)$/i.test(Q))?.resource,Y={id:(0,c.getGalleryExtensionId)(_.publisher,_.name)},X={type:N,identifier:Y,manifest:_,location:P,readmeUrl:ie,changelogUrl:se,publisherDisplayName:null,publisherId:null,isMachineScoped:!1,isBuiltin:N===0};return J&&(this.setMetadata(X,J),X.installedTimestamp=J.installedTimestamp),X}}catch(x){N!==0&&this.logService.trace(x)}return null}async scanDefaultSystemExtensions(){const P=await this.scanExtensionsInDir(this.systemExtensionsPath,0);return this.logService.trace("Scanned system extensions:",P.length),P}async scanDevSystemExtensions(){const P=this.getDevSystemExtensionsList();if(P.length){const N=await this.scanExtensionsInDir(this.devSystemExtensionsPath,0);return this.logService.trace("Scanned dev system extensions:",N.length),N.filter(x=>P.some(_=>(0,c.areSameExtensions)(x.identifier,{id:_})))}else return[]}setMetadata(P,N){P.publisherDisplayName=N.publisherDisplayName||null,P.publisherId=N.publisherId||null,P.identifier.uuid=N.id,P.isMachineScoped=!!N.isMachineScoped,P.isBuiltin=P.type===0||!!N.isBuiltin}async removeUninstalledExtensions(){const P=await this.getUninstalledExtensions(),N=await this.scanAllUserExtensions(),x=new Set;for(const ie of N)P[new c.ExtensionIdentifierWithVersion(ie.identifier,ie.manifest.version).key()]||x.add(ie.identifier.id.toLowerCase());const _=(0,c.groupByExtension)(N,ie=>ie.identifier);await d.Promises.settled(_.map(async ie=>{const se=ie.sort((Y,X)=>g.rcompare(Y.manifest.version,X.manifest.version))[0];x.has(se.identifier.id.toLowerCase())||await this.beforeRemovingExtension(se)}));const J=N.filter(ie=>P[new c.ExtensionIdentifierWithVersion(ie.identifier,ie.manifest.version).key()]);await d.Promises.settled(J.map(ie=>this.removeUninstalledExtension(ie)))}async removeOutdatedExtensions(){const P=await this.scanAllUserExtensions(),N=[],x=(0,c.groupByExtension)(P,_=>_.identifier);N.push(...(0,b.flatten)(x.map(_=>_.sort((J,ie)=>g.rcompare(J.manifest.version,ie.manifest.version)).slice(1)))),await d.Promises.settled(N.map(_=>this.removeExtension(_,"outdated")))}getDevSystemExtensionsList(){return(this.productService.builtInExtensions||[]).map(P=>P.name)}joinErrors(P){const N=Array.isArray(P)?P:[P];return N.length===1?N[0]instanceof Error?N[0]:new Error(N[0]):N.reduce((x,_)=>new Error(`${x.message}${x.message?",":""}${_ instanceof Error?_.message:_}`),new Error(""))}get devSystemExtensionsPath(){return this._devSystemExtensionsPath||(this._devSystemExtensionsPath=I.normalize(I.join(D.FileAccess.asFileUri("",q).fsPath,"..",".build","builtInExtensions"))),this._devSystemExtensionsPath}async readManifest(P){const N=[E.Promises.readFile(I.join(P,"package.json"),"utf8").then(ie=>this.parseManifest(ie)),E.Promises.readFile(I.join(P,"package.nls.json"),"utf8").then(void 0,ie=>ie.code!=="ENOENT"?Promise.reject(ie):"{}").then(ie=>JSON.parse(ie))],[{manifest:x,metadata:_},J]=await Promise.all(N);return{manifest:(0,w.localizeManifest)(x,J),metadata:_}}parseManifest(P){return new Promise((N,x)=>{try{const _=JSON.parse(P),J=_.__metadata||null;N({manifest:_,metadata:J})}catch(_){x(new Error((0,F.localize)(4,null)))}})}};m=ue([fe(1,f.IFileService),fe(2,T.ILogService),fe(3,p.INativeEnvironmentService),fe(4,l.IProductService)],m),t.ExtensionsScanner=m}),define(Z[124],te([0,1,77,3,11,43,22,23,21,41,7,34,10,15,98,28,35,49,20,29,96,12,9,122,102,123,103,104,17,117]),function(q,t,g,O,E,I,T,L,c,d,v,p,w,F,l,u,R,b,D,f,r,s,e,i,n,o,a,h,m,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionManagementService=void 0;const P="unsetUninstalled",N="downloading";let x=class extends k.AbstractExtensionManagementService{constructor(X,Q,B,W,U,S,M){super(X,Q,B);this.environmentService=W,this.downloadService=U;const y=this._register(S.createInstance(a.ExtensionsLifecycle));this.extensionsScanner=this._register(S.createInstance(o.ExtensionsScanner,C=>y.postUninstall(C))),this.manifestCache=this._register(new l.ExtensionsManifestCache(W,this)),this.extensionsDownloader=this._register(S.createInstance(n.ExtensionsDownloader));const A=this._register(new h.ExtensionsWatcher(this,M,W,B));this._register(A.onDidChangeExtensionsByAnotherSource(({added:C,removed:z})=>{C.length&&this._onDidInstallExtensions.fire(C.map(j=>({identifier:j.identifier,operation:0,local:j}))),z.forEach(j=>this._onDidUninstallExtension.fire({identifier:j}))}))}async zip(X){this.logService.trace("ExtensionManagementService#zip",X.identifier.id);const Q=await this.collectFiles(X),B=await(0,I.zip)((0,D.joinPath)(this.environmentService.tmpDir,(0,f.generateUuid)()).fsPath,Q);return v.URI.file(B)}async unzip(X){return this.logService.trace("ExtensionManagementService#unzip",X.toString()),(await this.install(X)).identifier}async getManifest(X){const Q=await this.downloadVsix(X),B=O.resolve(Q.fsPath);return(0,i.getManifest)(B)}getInstalled(X=null){return this.extensionsScanner.scanExtensions(X)}async canInstall(X){return!0}async install(X,Q={}){this.logService.trace("ExtensionManagementService#install",X.toString());const B=await this.downloadVsix(X),W=await(0,i.getManifest)(O.resolve(B.fsPath));if(W.engines&&W.engines.vscode&&!(0,b.isEngineValid)(W.engines.vscode,p.default.version,p.default.date))throw new Error(g.localize(0,null,(0,L.getGalleryExtensionId)(W.publisher,W.name),p.default.version));return this.installExtension(W,B,Q)}async updateMetadata(X,Q){return this.logService.trace("ExtensionManagementService#updateMetadata",X.identifier.id),X=await this.extensionsScanner.saveMetadataForLocalExtension(X,{...X.manifest.__metadata||{},...Q}),this.manifestCache.invalidate(),X}async updateExtensionScope(X,Q){return this.logService.trace("ExtensionManagementService#updateExtensionScope",X.identifier.id),X=await this.extensionsScanner.saveMetadataForLocalExtension(X,{...X.manifest.__metadata||{},isMachineScoped:Q}),this.manifestCache.invalidate(),X}removeDeprecatedExtensions(){return this.extensionsScanner.cleanUp()}async downloadVsix(X){if(X.scheme===e.Schemas.file)return X;if(!this.downloadService)throw new Error("Download service is not available");const Q=(0,D.joinPath)(this.environmentService.tmpDir,(0,f.generateUuid)());return await this.downloadService.download(X,Q),Q}createInstallExtensionTask(X,Q,B){return v.URI.isUri(Q)?new ie(X,Q,B,this.galleryService,this.extensionsScanner,this.logService):new J(Q,B,this.extensionsDownloader,this.extensionsScanner,this.logService)}createUninstallExtensionTask(X,Q){return new se(X,Q,this.extensionsScanner)}async collectFiles(X){const Q=async W=>{let U=await E.Promises.readdir(W);U=U.map(y=>O.join(W,y));const S=await Promise.all(U.map(y=>E.Promises.stat(y)));let M=Promise.resolve([]);return S.forEach((y,A)=>{const C=U[A];y.isFile()&&(M=M.then(z=>[...z,C])),y.isDirectory()&&(M=M.then(z=>Q(C).then(j=>[...z,...j])))}),M};return(await Q(X.location.fsPath)).map(W=>({path:`extension/${O.relative(X.location.fsPath,W)}`,localPath:W}))}};x=ue([fe(0,T.IExtensionGalleryService),fe(1,R.ITelemetryService),fe(2,F.ILogService),fe(3,c.INativeEnvironmentService),fe(4,(0,s.optional)(r.IDownloadService)),fe(5,s.IInstantiationService),fe(6,m.IFileService)],x),t.ExtensionManagementService=x;class _ extends k.AbstractExtensionTask{constructor(X,Q,B,W){super();this.identifier=X,this.source=Q,this.extensionsScanner=B,this.logService=W,this._operation=1}get operation(){return this._operation}async installExtension(X,Q){try{const B=await this.unsetUninstalledAndGetLocal(X.identifierWithVersion);if(B)return X.metadata?this.extensionsScanner.saveMetadataForLocalExtension(B,X.metadata):B}catch(B){throw w.isMacintosh?new T.ExtensionManagementError(g.localize(1,null),P):new T.ExtensionManagementError(g.localize(2,null),P)}return this.extract(X,Q)}async unsetUninstalledAndGetLocal(X){if(!await this.isUninstalled(X))return null;this.logService.trace("Removing the extension from uninstalled list:",X.id);const B=await this.extensionsScanner.setInstalled(X);return this.logService.info("Removed the extension from uninstalled list:",X.id),B}async isUninstalled(X){return!!(await this.extensionsScanner.getUninstalledExtensions())[X.key()]}async extract({zipPath:X,identifierWithVersion:Q,metadata:B},W){let U=await this.extensionsScanner.extractUserExtension(Q,X,W);return this.logService.info("Extracting completed.",Q.id),B&&(U=await this.extensionsScanner.saveMetadataForLocalExtension(U,B)),U}}class J extends _{constructor(X,Q,B,W,U){super(X.identifier,X,W,U);this.gallery=X,this.options=Q,this.extensionsDownloader=B}async doRun(X){const B=(await this.extensionsScanner.scanExtensions(null)).find(S=>(0,L.areSameExtensions)(S.identifier,this.gallery.identifier));B&&(this._operation=2);const W=await this.downloadInstallableExtension(this.gallery,this._operation);W.metadata.isMachineScoped=this.options.isMachineScoped||B?.isMachineScoped,W.metadata.isBuiltin=this.options.isBuiltin||B?.isBuiltin;const U=await this.installExtension(W,X);B&&d.neq(B.manifest.version,this.gallery.version)&&await this.extensionsScanner.setUninstalled(B);try{await this.extensionsDownloader.delete(v.URI.file(W.zipPath))}catch(S){}return U}async downloadInstallableExtension(X,Q){const B={id:X.identifier.uuid,publisherId:X.publisherId,publisherDisplayName:X.publisherDisplayName};let W;try{this.logService.trace("Started downloading extension:",X.identifier.id),W=(await this.extensionsDownloader.downloadExtension(X,Q)).fsPath,this.logService.info("Downloaded extension:",X.identifier.id,W)}catch(U){throw new T.ExtensionManagementError((0,k.joinErrors)(U).message,N)}try{const U=await(0,i.getManifest)(W);return{zipPath:W,identifierWithVersion:new L.ExtensionIdentifierWithVersion(X.identifier,U.version),metadata:B}}catch(U){throw new T.ExtensionManagementError((0,k.joinErrors)(U).message,k.INSTALL_ERROR_VALIDATING)}}}class ie extends _{constructor(X,Q,B,W,U,S){super({id:(0,L.getGalleryExtensionId)(X.publisher,X.name)},Q,U,S);this.manifest=X,this.location=Q,this.options=B,this.galleryService=W}async doRun(X){const Q=new L.ExtensionIdentifierWithVersion(this.identifier,this.manifest.version),W=(await this.extensionsScanner.scanExtensions(1)).find(S=>(0,L.areSameExtensions)(this.identifier,S.identifier)),U=await this.getMetadata(this.identifier.id,X);if(W)if(U.isMachineScoped=this.options.isMachineScoped||W.isMachineScoped,U.isBuiltin=this.options.isBuiltin||W.isBuiltin,this._operation=2,Q.equals(new L.ExtensionIdentifierWithVersion(W.identifier,W.manifest.version)))try{await this.extensionsScanner.removeExtension(W,"existing")}catch(S){throw new Error(g.localize(3,null,this.manifest.displayName||this.manifest.name))}else d.gt(W.manifest.version,this.manifest.version)&&await this.extensionsScanner.setUninstalled(W);else{const S=await this.unsetUninstalledAndGetLocal(Q);if(S)try{await this.extensionsScanner.removeExtension(S,"existing")}catch(M){throw new Error(g.localize(4,null,this.manifest.displayName||this.manifest.name))}}return this.installExtension({zipPath:O.resolve(this.location.fsPath),identifierWithVersion:Q,metadata:U},X)}async getMetadata(X,Q){try{const B=(await this.galleryService.query({names:[X],pageSize:1},Q)).firstPage[0];if(B)return{id:B.identifier.uuid,publisherDisplayName:B.publisherDisplayName,publisherId:B.publisherId}}catch(B){}return{}}}class se extends k.AbstractExtensionTask{constructor(X,Q,B){super();this.extension=X,this.options=Q,this.extensionsScanner=B}async doRun(X){const Q=[],B=await this.extensionsScanner.scanUserExtensions(!1);if(this.options.versionOnly){const W=new L.ExtensionIdentifierWithVersion(this.extension.identifier,this.extension.manifest.version);Q.push(...B.filter(U=>W.equals(new L.ExtensionIdentifierWithVersion(U.identifier,U.manifest.version))))}else Q.push(...B.filter(W=>(0,L.areSameExtensions)(W.identifier,this.extension.identifier)));if(!Q.length)throw new Error(g.localize(5,null,this.extension.manifest.displayName||this.extension.manifest.name));if(await this.extensionsScanner.setUninstalled(...Q),this.options.remove)for(const W of Q)try{X.isCancellationRequested||await this.extensionsScanner.removeUninstalledExtension(W)}catch(U){throw new Error(g.localize(6,null,(0,u.toErrorMessage)(U)))}}}}),define(Z[125],te([0,1,134,113,2,13,8,112,27,15,16,21,99]),function(q,t,g,O,E,I,T,L,c,d,v,p,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestService=void 0;let F=class extends E.Disposable{constructor(u,R,b){super();this.environmentService=R,this.logService=b,this.configure(u.getValue()),this._register(u.onDidChangeConfiguration(()=>this.configure(u.getValue()),this))}configure(u){this.proxyUrl=u.http&&u.http.proxy,this.strictSSL=!!(u.http&&u.http.proxyStrictSSL),this.authorization=u.http&&u.http.proxyAuthorization}async request(u,R){this.logService.trace("RequestService#request",u.url);const{proxyUrl:b,strictSSL:D}=this,f={...process.env,...await(0,w.resolveShellEnv)(this.logService,this.environmentService.args,process.env)},r=u.agent?u.agent:await(0,L.getProxyAgent)(u.url||"",f,{proxyUrl:b,strictSSL:D});return u.agent=r,u.strictSSL=D,this.authorization&&(u.headers={...u.headers||{},"Proxy-Authorization":this.authorization}),this._request(u,R)}async getNodeRequest(u){return((0,O.parse)(u.url).protocol==="https:"?await new Promise((D,f)=>{q(["https"],D,f)}):await new Promise((D,f)=>{q(["http"],D,f)})).request}_request(u,R){return new Promise(async(b,D)=>{let f;const r=(0,O.parse)(u.url),s=u.getRawRequest?u.getRawRequest(u):await this.getNodeRequest(u),e={hostname:r.hostname,port:r.port?parseInt(r.port):r.protocol==="https:"?443:80,protocol:r.protocol,path:r.path,method:u.type||"GET",headers:u.headers,agent:u.agent,rejectUnauthorized:(0,I.isBoolean)(u.strictSSL)?u.strictSSL:!0};u.user&&u.password&&(e.auth=u.user+":"+u.password),f=s(e,i=>{const n=(0,I.isNumber)(u.followRedirects)?u.followRedirects:3;if(i.statusCode&&i.statusCode>=300&&i.statusCode<400&&n>0&&i.headers.location)this._request({...u,url:i.headers.location,followRedirects:n-1},R).then(b,D);else{let o=i;i.headers["content-encoding"]==="gzip"&&(o=i.pipe((0,g.createGunzip)())),b({res:i,stream:(0,v.streamToBufferReadableStream)(o)})}}),f.on("error",D),u.timeout&&f.setTimeout(u.timeout),u.data&&typeof u.data=="string"&&f.write(u.data),f.end(),R.onCancellationRequested(()=>{f.abort(),D((0,T.canceled)())})})}async resolveProxy(u){}};F=ue([fe(0,c.IConfigurationService),fe(1,p.INativeEnvironmentService),fe(2,d.ILogService)],F),t.RequestService=F}),define(Z[135],te([0,1,31,38,136,11,3,4,34,52,50,101,21,89,22,124,118,35,56,119,116,55,125,27,111,120,15,9,106,121,107,17,108,2,42,97,7,105,53,8,28,16,33]),function(q,t,g,O,E,I,T,L,c,d,v,p,w,F,l,u,R,b,D,f,r,s,e,i,n,o,a,h,m,k,P,N,x,_,J,ie,se,Y,X,Q,B,W,U){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.main=void 0;class S extends _.Disposable{constructor(A){super();this.argv=A,(0,E.gracefulify)(O),this.registerListeners()}registerListeners(){process.once("exit",()=>this.dispose())}async run(){const[A,C]=await this.initServices();return A.invokeFunction(async z=>{const j=z.get(a.ILogService),$=z.get(N.IFileService),H=z.get(w.INativeEnvironmentService),ee=z.get(l.IExtensionManagementCLIService);return j.info("CLI main",this.argv),this.registerErrorHandler(j),await this.doRun(H,ee,$),(0,L.raceTimeout)((0,D.combinedAppender)(...C).flush(),1e3)})}async initServices(){const A=new d.ServiceCollection,C={_serviceBrand:void 0,...c.default};A.set(J.IProductService,C);const z=new F.NativeEnvironmentService(this.argv,C);A.set(w.INativeEnvironmentService,z),await Promise.all([z.appSettingsHome.fsPath,z.extensionsPath].map(me=>me?I.Promises.mkdir(me,{recursive:!0}):void 0));const j=(0,a.getLogLevel)(z),$=[];$.push(new m.SpdLogLogger("cli",(0,T.join)(z.logsPath,"cli.log"),!0,j)),j===a.LogLevel.Trace&&$.push(new a.ConsoleLogger(j));const H=this._register(new a.MultiplexLogService($));A.set(a.ILogService,H);const ee=this._register(new P.FileService(H));A.set(N.IFileService,ee);const ne=this._register(new x.DiskFileSystemProvider(H));ee.registerProvider(h.Schemas.file,ne);const re=this._register(new n.ConfigurationService(z.settingsResource,ee));A.set(i.IConfigurationService,re),await re.initialize(),A.set(s.IRequestService,new v.SyncDescriptor(e.RequestService)),A.set(l.IExtensionManagementService,new v.SyncDescriptor(u.ExtensionManagementService)),A.set(l.IExtensionGalleryService,new v.SyncDescriptor(R.ExtensionGalleryService)),A.set(l.IExtensionManagementCLIService,new v.SyncDescriptor(ie.ExtensionManagementCLIService)),A.set(X.ILocalizationsService,new v.SyncDescriptor(Y.LocalizationsService));const ce=[];if(z.isBuilt&&!z.isExtensionDevelopment&&!z.disableTelemetry&&C.enableTelemetry){C.aiConfig&&C.aiConfig.asimovKey&&ce.push(new o.AppInsightsAppender("monacoworkbench",null,C.aiConfig.asimovKey));const{appRoot:me,extensionsPath:be,installSourcePath:ke}=z,Te={appender:(0,D.combinedAppender)(...ce),sendErrorTelemetry:!1,commonProperties:(async()=>{let we;try{const Fe=await I.Promises.readFile((0,T.join)(z.userDataPath,"storage.json"));we=JSON.parse(Fe.toString())[b.machineIdKey]}catch(Fe){Fe.code!=="ENOENT"&&H.error(Fe)}return(0,r.resolveCommonProperties)(ee,(0,g.release)(),(0,g.hostname)(),process.arch,C.commit,C.version,we,C.msftInternalDomains,ke)})(),piiPaths:[me,be]};A.set(b.ITelemetryService,new v.SyncDescriptor(f.TelemetryService,[Te]))}else A.set(b.ITelemetryService,D.NullTelemetryService);return[new p.InstantiationService(A),ce]}registerErrorHandler(A){(0,Q.setUnexpectedErrorHandler)(C=>{const z=(0,B.toErrorMessage)(C,!0);!z||A.error(`[uncaught exception in CLI]: ${z}`)})}async doRun(A,C,z){if(this.argv["install-source"])return this.setInstallSource(A,z,this.argv["install-source"]);if(this.argv["list-extensions"])return C.listExtensions(!!this.argv["show-versions"],this.argv.category);if(this.argv["install-extension"]||this.argv["install-builtin-extension"])return C.installExtensions(this.asExtensionIdOrVSIX(this.argv["install-extension"]||[]),this.argv["install-builtin-extension"]||[],!!this.argv["do-not-sync"],!!this.argv.force);if(this.argv["uninstall-extension"])return C.uninstallExtensions(this.asExtensionIdOrVSIX(this.argv["uninstall-extension"]),!!this.argv.force);if(this.argv["locate-extension"])return C.locateExtension(this.argv["locate-extension"]);this.argv.telemetry&&console.log(await(0,k.buildTelemetryMessage)(A.appRoot,A.extensionsPath))}asExtensionIdOrVSIX(A){return A.map(C=>/\.vsix$/i.test(C)?se.URI.file((0,T.isAbsolute)(C)?C:(0,T.join)((0,U.cwd)(),C)):C)}async setInstallSource(A,C,z){await C.writeFile(se.URI.file(A.installSourcePath),W.VSBuffer.fromString(z.slice(0,30)))}}async function M(y){const A=new S(y);try{await A.run()}finally{A.dispose()}}t.main=M})}).call(this);

//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/379476f0e13988d90fab105c5c19e7abc8b1dea8/core/vs/code/node/cliProcessMain.js.map
